2025-04-15 08:31:33.902706: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:31:33.904612: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:31:33.939619: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:31:33.940024: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:31:34.538120: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 6.0397 - accuracy: 0.5312 2/12 [====>.........................] - ETA: 1s - loss: 7.6268 - accuracy: 0.6562  3/12 [======>.......................] - ETA: 1s - loss: 8.2259 - accuracy: 0.6979 4/12 [=========>....................] - ETA: 1s - loss: 8.5648 - accuracy: 0.7031 5/12 [===========>..................] - ETA: 1s - loss: 7.9140 - accuracy: 0.7188 6/12 [==============>...............] - ETA: 1s - loss: 7.5532 - accuracy: 0.7135 7/12 [================>.............] - ETA: 0s - loss: 7.1629 - accuracy: 0.7321 8/12 [===================>..........] - ETA: 0s - loss: 6.8826 - accuracy: 0.7227 9/12 [=====================>........] - ETA: 0s - loss: 6.6754 - accuracy: 0.718810/12 [========================>.....] - ETA: 0s - loss: 6.4703 - accuracy: 0.731211/12 [==========================>...] - ETA: 0s - loss: 6.2972 - accuracy: 0.747212/12 [==============================] - ETA: 0s - loss: 6.2728 - accuracy: 0.7500Epoch 1 took 3.71 seconds
12/12 [==============================] - 4s 208ms/step - loss: 6.2728 - accuracy: 0.7500 - val_loss: 4.4887 - val_accuracy: 0.8500
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.4543 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 4.4017 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 4.3849 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 4.4049 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 1s - loss: 4.4251 - accuracy: 0.8875 6/12 [==============>...............] - ETA: 1s - loss: 4.4142 - accuracy: 0.8750 7/12 [================>.............] - ETA: 0s - loss: 4.4466 - accuracy: 0.8705 8/12 [===================>..........] - ETA: 0s - loss: 4.4490 - accuracy: 0.8594 9/12 [=====================>........] - ETA: 0s - loss: 4.3943 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 4.3764 - accuracy: 0.868711/12 [==========================>...] - ETA: 0s - loss: 4.3339 - accuracy: 0.875012/12 [==============================] - ETA: 0s - loss: 4.3229 - accuracy: 0.8778Epoch 2 took 2.24 seconds
12/12 [==============================] - 2s 189ms/step - loss: 4.3229 - accuracy: 0.8778 - val_loss: 4.2325 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.9671 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 4.0530 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 4.1346 - accuracy: 0.8333 4/12 [=========>....................] - ETA: 1s - loss: 4.0363 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 1s - loss: 4.0108 - accuracy: 0.8562 6/12 [==============>...............] - ETA: 1s - loss: 3.9718 - accuracy: 0.8646 7/12 [================>.............] - ETA: 1s - loss: 4.0140 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 0s - loss: 4.0076 - accuracy: 0.8516 9/12 [=====================>........] - ETA: 0s - loss: 3.9523 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 3.9539 - accuracy: 0.868711/12 [==========================>...] - ETA: 0s - loss: 3.9156 - accuracy: 0.8722Epoch 3 took 2.28 seconds
12/12 [==============================] - 2s 191ms/step - loss: 3.9074 - accuracy: 0.8750 - val_loss: 3.8607 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.7503 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 1s - loss: 3.6318 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 3.6062 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.5636 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.5117 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.4934 - accuracy: 0.9375 7/12 [================>.............] - ETA: 0s - loss: 3.5789 - accuracy: 0.9152 8/12 [===================>..........] - ETA: 0s - loss: 3.5413 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 0s - loss: 3.5044 - accuracy: 0.927110/12 [========================>.....] - ETA: 0s - loss: 3.4898 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 3.4662 - accuracy: 0.931812/12 [==============================] - ETA: 0s - loss: 3.4630 - accuracy: 0.9306Epoch 4 took 2.27 seconds
12/12 [==============================] - 2s 188ms/step - loss: 3.4630 - accuracy: 0.9306 - val_loss: 3.5202 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 1s - loss: 3.1519 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.1704 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.1873 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 2s - loss: 3.1745 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.1398 - accuracy: 0.9375 6/12 [==============>...............] - ETA: 1s - loss: 3.1371 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 3.1257 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 3.1062 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.1218 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 3.1080 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 3.0895 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 3.0834 - accuracy: 0.9389Epoch 5 took 3.12 seconds
12/12 [==============================] - 3s 267ms/step - loss: 3.0834 - accuracy: 0.9389 - val_loss: 3.2328 - val_accuracy: 0.8250
Round Complete.
  CPU Usage - Avg: 42.13%, Peak: 46.95%, Min: 24.98%
  Memory Usage - Avg: 939.71 MB, Peak: 996.49 MB, Min: 633.87 MB
  Available Memory - Avg: 2958.04 MB, Peak: 3503.21 MB, Min: 2851.30 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
