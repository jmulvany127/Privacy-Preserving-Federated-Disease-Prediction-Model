2025-04-15 08:33:35.950057: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:33:35.951829: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:33:35.989817: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:33:35.990309: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:33:36.596163: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 5.6002 - accuracy: 0.5312 2/12 [====>.........................] - ETA: 1s - loss: 5.9700 - accuracy: 0.6094  3/12 [======>.......................] - ETA: 1s - loss: 6.3984 - accuracy: 0.5833 4/12 [=========>....................] - ETA: 1s - loss: 5.9972 - accuracy: 0.6562 5/12 [===========>..................] - ETA: 1s - loss: 5.7710 - accuracy: 0.6812 6/12 [==============>...............] - ETA: 1s - loss: 5.6293 - accuracy: 0.7083 7/12 [================>.............] - ETA: 0s - loss: 5.5151 - accuracy: 0.7321 8/12 [===================>..........] - ETA: 0s - loss: 5.4342 - accuracy: 0.7461 9/12 [=====================>........] - ETA: 0s - loss: 5.3735 - accuracy: 0.743110/12 [========================>.....] - ETA: 0s - loss: 5.3360 - accuracy: 0.743711/12 [==========================>...] - ETA: 0s - loss: 5.2891 - accuracy: 0.755712/12 [==============================] - ETA: 0s - loss: 5.2633 - accuracy: 0.7611Epoch 1 took 3.80 seconds
12/12 [==============================] - 4s 206ms/step - loss: 5.2633 - accuracy: 0.7611 - val_loss: 4.4517 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.4001 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 4.6584 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 4.7264 - accuracy: 0.8438 4/12 [=========>....................] - ETA: 1s - loss: 4.6052 - accuracy: 0.8672 5/12 [===========>..................] - ETA: 1s - loss: 4.5770 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 1s - loss: 4.5914 - accuracy: 0.8698 7/12 [================>.............] - ETA: 0s - loss: 4.5610 - accuracy: 0.8616 8/12 [===================>..........] - ETA: 0s - loss: 4.5018 - accuracy: 0.8672 9/12 [=====================>........] - ETA: 0s - loss: 4.5069 - accuracy: 0.861110/12 [========================>.....] - ETA: 0s - loss: 4.5057 - accuracy: 0.856211/12 [==========================>...] - ETA: 0s - loss: 4.4848 - accuracy: 0.852312/12 [==============================] - ETA: 0s - loss: 4.4703 - accuracy: 0.8528Epoch 2 took 2.20 seconds
12/12 [==============================] - 2s 184ms/step - loss: 4.4703 - accuracy: 0.8528 - val_loss: 4.1599 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 1s - loss: 4.4562 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 2s - loss: 4.2305 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 4.1326 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 1s - loss: 4.0289 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 1s - loss: 4.0674 - accuracy: 0.8813 6/12 [==============>...............] - ETA: 1s - loss: 4.0595 - accuracy: 0.8750 7/12 [================>.............] - ETA: 0s - loss: 3.9988 - accuracy: 0.8884 8/12 [===================>..........] - ETA: 0s - loss: 3.9660 - accuracy: 0.8906 9/12 [=====================>........] - ETA: 0s - loss: 3.9434 - accuracy: 0.892410/12 [========================>.....] - ETA: 0s - loss: 3.9354 - accuracy: 0.896911/12 [==========================>...] - ETA: 0s - loss: 3.8953 - accuracy: 0.903412/12 [==============================] - ETA: 0s - loss: 3.9157 - accuracy: 0.8972Epoch 3 took 2.22 seconds
12/12 [==============================] - 2s 188ms/step - loss: 3.9157 - accuracy: 0.8972 - val_loss: 3.9457 - val_accuracy: 0.8250
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6923 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.5987 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 1s - loss: 3.5766 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 3.6170 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.5685 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.6397 - accuracy: 0.9115 7/12 [================>.............] - ETA: 0s - loss: 3.6446 - accuracy: 0.9062 8/12 [===================>..........] - ETA: 0s - loss: 3.6608 - accuracy: 0.8984 9/12 [=====================>........] - ETA: 0s - loss: 3.6185 - accuracy: 0.906210/12 [========================>.....] - ETA: 0s - loss: 3.5805 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.5694 - accuracy: 0.914812/12 [==============================] - ETA: 0s - loss: 3.5624 - accuracy: 0.9167Epoch 4 took 2.34 seconds
12/12 [==============================] - 2s 195ms/step - loss: 3.5624 - accuracy: 0.9167 - val_loss: 3.7297 - val_accuracy: 0.8250
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.2510 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 3.2017 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 3.2394 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.2001 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 1s - loss: 3.1825 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.1982 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 3.2122 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 3.2034 - accuracy: 0.9336 9/12 [=====================>........] - ETA: 0s - loss: 3.1903 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 3.1728 - accuracy: 0.934411/12 [==========================>...] - ETA: 0s - loss: 3.1844 - accuracy: 0.929012/12 [==============================] - ETA: 0s - loss: 3.1811 - accuracy: 0.9278Epoch 5 took 3.34 seconds
12/12 [==============================] - 3s 284ms/step - loss: 3.1811 - accuracy: 0.9278 - val_loss: 3.5165 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 42.70%, Peak: 45.95%, Min: 25.23%
  Memory Usage - Avg: 931.61 MB, Peak: 985.60 MB, Min: 657.20 MB
  Available Memory - Avg: 2953.45 MB, Peak: 3493.95 MB, Min: 2842.84 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
