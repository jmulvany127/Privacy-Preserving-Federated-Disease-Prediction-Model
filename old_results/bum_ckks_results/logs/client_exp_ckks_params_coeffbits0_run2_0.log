2025-04-15 12:50:49.726359: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:50:49.728656: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:50:49.768279: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:50:49.769016: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:50:50.417641: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 6.4142 - accuracy: 0.5312 2/12 [====>.........................] - ETA: 1s - loss: 7.0504 - accuracy: 0.6406  3/12 [======>.......................] - ETA: 1s - loss: 6.5749 - accuracy: 0.6979 4/12 [=========>....................] - ETA: 1s - loss: 6.2659 - accuracy: 0.7188 5/12 [===========>..................] - ETA: 1s - loss: 6.3070 - accuracy: 0.6875 6/12 [==============>...............] - ETA: 1s - loss: 6.1329 - accuracy: 0.7031 7/12 [================>.............] - ETA: 1s - loss: 5.9823 - accuracy: 0.7143 8/12 [===================>..........] - ETA: 0s - loss: 6.0080 - accuracy: 0.7227 9/12 [=====================>........] - ETA: 0s - loss: 5.9778 - accuracy: 0.725710/12 [========================>.....] - ETA: 0s - loss: 5.8804 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.7955 - accuracy: 0.750012/12 [==============================] - ETA: 0s - loss: 5.7709 - accuracy: 0.7500Epoch 1 took 4.17 seconds
12/12 [==============================] - 4s 246ms/step - loss: 5.7709 - accuracy: 0.7500 - val_loss: 4.5289 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.5279 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 4.9523 - accuracy: 0.7812 3/12 [======>.......................] - ETA: 1s - loss: 5.0314 - accuracy: 0.7708 4/12 [=========>....................] - ETA: 1s - loss: 4.8874 - accuracy: 0.7891 5/12 [===========>..................] - ETA: 1s - loss: 4.8650 - accuracy: 0.7750 6/12 [==============>...............] - ETA: 1s - loss: 4.8334 - accuracy: 0.7656 7/12 [================>.............] - ETA: 1s - loss: 4.7229 - accuracy: 0.7902 8/12 [===================>..........] - ETA: 0s - loss: 4.7425 - accuracy: 0.7969 9/12 [=====================>........] - ETA: 0s - loss: 4.7048 - accuracy: 0.802110/12 [========================>.....] - ETA: 0s - loss: 4.6778 - accuracy: 0.809411/12 [==========================>...] - ETA: 0s - loss: 4.6028 - accuracy: 0.826712/12 [==============================] - ETA: 0s - loss: 4.6225 - accuracy: 0.8278Epoch 2 took 2.41 seconds
12/12 [==============================] - 2s 205ms/step - loss: 4.6225 - accuracy: 0.8278 - val_loss: 4.2624 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.0406 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 4.1105 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 4.1942 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 4.2814 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.2054 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 1s - loss: 4.1435 - accuracy: 0.8854 7/12 [================>.............] - ETA: 1s - loss: 4.1648 - accuracy: 0.8839 8/12 [===================>..........] - ETA: 0s - loss: 4.1214 - accuracy: 0.8906 9/12 [=====================>........] - ETA: 0s - loss: 4.0882 - accuracy: 0.892410/12 [========================>.....] - ETA: 0s - loss: 4.0553 - accuracy: 0.893811/12 [==========================>...] - ETA: 0s - loss: 4.0152 - accuracy: 0.900612/12 [==============================] - ETA: 0s - loss: 4.0054 - accuracy: 0.9028Epoch 3 took 2.46 seconds
12/12 [==============================] - 2s 206ms/step - loss: 4.0054 - accuracy: 0.9028 - val_loss: 4.1184 - val_accuracy: 0.6250
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6513 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.6294 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 3.6354 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 1s - loss: 3.6490 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.6053 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.5898 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.5724 - accuracy: 0.9286 8/12 [===================>..........] - ETA: 0s - loss: 3.5535 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.5386 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 3.5320 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.5279 - accuracy: 0.923312/12 [==============================] - ETA: 0s - loss: 3.5222 - accuracy: 0.9250Epoch 4 took 2.50 seconds
12/12 [==============================] - 2s 209ms/step - loss: 3.5222 - accuracy: 0.9250 - val_loss: 4.3777 - val_accuracy: 0.4250
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.4665 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.3300 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 3.3092 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 3.2857 - accuracy: 0.9609 5/12 [===========>..................] - ETA: 2s - loss: 3.2664 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 3.2733 - accuracy: 0.9583 7/12 [================>.............] - ETA: 1s - loss: 3.2453 - accuracy: 0.9643 8/12 [===================>..........] - ETA: 1s - loss: 3.2252 - accuracy: 0.9648 9/12 [=====================>........] - ETA: 0s - loss: 3.2272 - accuracy: 0.954910/12 [========================>.....] - ETA: 0s - loss: 3.2081 - accuracy: 0.959411/12 [==========================>...] - ETA: 0s - loss: 3.1887 - accuracy: 0.963112/12 [==============================] - ETA: 0s - loss: 3.1838 - accuracy: 0.9639Epoch 5 took 3.66 seconds
12/12 [==============================] - 4s 315ms/step - loss: 3.1838 - accuracy: 0.9639 - val_loss: 5.1708 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 41.24%, Peak: 47.20%, Min: 9.25%
  Memory Usage - Avg: 989.15 MB, Peak: 1036.76 MB, Min: 690.46 MB
  Available Memory - Avg: 2949.25 MB, Peak: 3503.82 MB, Min: 2854.15 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
