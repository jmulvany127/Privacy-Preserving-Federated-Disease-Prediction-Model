2025-04-15 13:05:54.247048: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 13:05:54.248898: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:05:54.284453: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:05:54.284844: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 13:05:54.968878: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 18s - loss: 6.7815 - accuracy: 0.4062 2/12 [====>.........................] - ETA: 1s - loss: 8.0745 - accuracy: 0.5938  3/12 [======>.......................] - ETA: 1s - loss: 7.7802 - accuracy: 0.6771 4/12 [=========>....................] - ETA: 1s - loss: 7.2333 - accuracy: 0.7266 5/12 [===========>..................] - ETA: 1s - loss: 6.8615 - accuracy: 0.7375 6/12 [==============>...............] - ETA: 1s - loss: 6.6268 - accuracy: 0.7188 7/12 [================>.............] - ETA: 1s - loss: 6.3703 - accuracy: 0.7098 8/12 [===================>..........] - ETA: 0s - loss: 6.2301 - accuracy: 0.7227 9/12 [=====================>........] - ETA: 0s - loss: 6.0629 - accuracy: 0.736110/12 [========================>.....] - ETA: 0s - loss: 5.9085 - accuracy: 0.750011/12 [==========================>...] - ETA: 0s - loss: 5.8043 - accuracy: 0.755712/12 [==============================] - ETA: 0s - loss: 5.7913 - accuracy: 0.7583Epoch 1 took 4.27 seconds
12/12 [==============================] - 4s 238ms/step - loss: 5.7913 - accuracy: 0.7583 - val_loss: 4.4384 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.0903 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 4.1904 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 4.3366 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 4.4343 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.4347 - accuracy: 0.8438 6/12 [==============>...............] - ETA: 1s - loss: 4.3820 - accuracy: 0.8594 7/12 [================>.............] - ETA: 1s - loss: 4.3678 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 0s - loss: 4.3316 - accuracy: 0.8516 9/12 [=====================>........] - ETA: 0s - loss: 4.2753 - accuracy: 0.861110/12 [========================>.....] - ETA: 0s - loss: 4.2614 - accuracy: 0.859411/12 [==========================>...] - ETA: 0s - loss: 4.2491 - accuracy: 0.860812/12 [==============================] - ETA: 0s - loss: 4.2358 - accuracy: 0.8639Epoch 2 took 2.41 seconds
12/12 [==============================] - 2s 201ms/step - loss: 4.2358 - accuracy: 0.8639 - val_loss: 4.2993 - val_accuracy: 0.6250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.7806 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 3.8249 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 3.7862 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.8164 - accuracy: 0.8906 5/12 [===========>..................] - ETA: 1s - loss: 3.8029 - accuracy: 0.8875 6/12 [==============>...............] - ETA: 1s - loss: 3.9216 - accuracy: 0.8646 7/12 [================>.............] - ETA: 1s - loss: 3.8973 - accuracy: 0.8705 8/12 [===================>..........] - ETA: 0s - loss: 3.8517 - accuracy: 0.8750 9/12 [=====================>........] - ETA: 0s - loss: 3.8082 - accuracy: 0.881910/12 [========================>.....] - ETA: 0s - loss: 3.7766 - accuracy: 0.881311/12 [==========================>...] - ETA: 0s - loss: 3.7673 - accuracy: 0.880712/12 [==============================] - ETA: 0s - loss: 3.7663 - accuracy: 0.8750Epoch 3 took 2.41 seconds
12/12 [==============================] - 2s 200ms/step - loss: 3.7663 - accuracy: 0.8750 - val_loss: 4.2835 - val_accuracy: 0.4750
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6440 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 3.4196 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 3.4185 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 1s - loss: 3.3954 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.3676 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.3259 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 3.3225 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 1s - loss: 3.3149 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 0s - loss: 3.3392 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.3349 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.3288 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.3210 - accuracy: 0.9194Epoch 4 took 3.30 seconds
12/12 [==============================] - 3s 281ms/step - loss: 3.3210 - accuracy: 0.9194 - val_loss: 4.7552 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2921 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 3s - loss: 3.1785 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.1110 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.0895 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 2s - loss: 3.0557 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.0391 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.0476 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 1s - loss: 3.0131 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.0014 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 2.9814 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 2.9805 - accuracy: 0.929012/12 [==============================] - ETA: 0s - loss: 2.9738 - accuracy: 0.9306Epoch 5 took 3.48 seconds
12/12 [==============================] - 3s 288ms/step - loss: 2.9738 - accuracy: 0.9306 - val_loss: 4.7674 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 42.81%, Peak: 47.45%, Min: 24.98%
  Memory Usage - Avg: 968.23 MB, Peak: 1014.14 MB, Min: 690.29 MB
  Available Memory - Avg: 2963.17 MB, Peak: 3488.65 MB, Min: 2871.48 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
