2025-04-15 08:25:18.759472: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:25:18.761222: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:25:18.808286: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:25:18.808987: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:25:19.417093: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 5.2515 - accuracy: 0.7188 2/12 [====>.........................] - ETA: 1s - loss: 6.9509 - accuracy: 0.7812  3/12 [======>.......................] - ETA: 1s - loss: 8.1426 - accuracy: 0.7500 4/12 [=========>....................] - ETA: 1s - loss: 7.2603 - accuracy: 0.7891 5/12 [===========>..................] - ETA: 1s - loss: 6.8622 - accuracy: 0.7563 6/12 [==============>...............] - ETA: 1s - loss: 6.4695 - accuracy: 0.7604 7/12 [================>.............] - ETA: 0s - loss: 6.2475 - accuracy: 0.7589 8/12 [===================>..........] - ETA: 0s - loss: 6.0616 - accuracy: 0.7695 9/12 [=====================>........] - ETA: 0s - loss: 5.8514 - accuracy: 0.791710/12 [========================>.....] - ETA: 0s - loss: 5.7376 - accuracy: 0.790611/12 [==========================>...] - ETA: 0s - loss: 5.6097 - accuracy: 0.792612/12 [==============================] - ETA: 0s - loss: 5.5774 - accuracy: 0.7944Epoch 1 took 3.84 seconds
12/12 [==============================] - 4s 219ms/step - loss: 5.5774 - accuracy: 0.7944 - val_loss: 4.4521 - val_accuracy: 0.7500
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.2038 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 1s - loss: 4.1773 - accuracy: 0.7969 3/12 [======>.......................] - ETA: 1s - loss: 4.3895 - accuracy: 0.7917 4/12 [=========>....................] - ETA: 1s - loss: 4.2834 - accuracy: 0.8125 5/12 [===========>..................] - ETA: 1s - loss: 4.2287 - accuracy: 0.8313 6/12 [==============>...............] - ETA: 1s - loss: 4.1737 - accuracy: 0.8438 7/12 [================>.............] - ETA: 0s - loss: 4.1519 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 0s - loss: 4.1019 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 0s - loss: 4.0892 - accuracy: 0.864610/12 [========================>.....] - ETA: 0s - loss: 4.1035 - accuracy: 0.859411/12 [==========================>...] - ETA: 0s - loss: 4.0693 - accuracy: 0.8636Epoch 2 took 2.25 seconds
12/12 [==============================] - 2s 185ms/step - loss: 4.0584 - accuracy: 0.8667 - val_loss: 4.1147 - val_accuracy: 0.6250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.7876 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 2s - loss: 3.8041 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 3.7727 - accuracy: 0.8333 4/12 [=========>....................] - ETA: 1s - loss: 3.7438 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 1s - loss: 3.6910 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 1s - loss: 3.6756 - accuracy: 0.8750 7/12 [================>.............] - ETA: 0s - loss: 3.6900 - accuracy: 0.8705 8/12 [===================>..........] - ETA: 0s - loss: 3.6821 - accuracy: 0.8672 9/12 [=====================>........] - ETA: 0s - loss: 3.6477 - accuracy: 0.875010/12 [========================>.....] - ETA: 0s - loss: 3.6129 - accuracy: 0.884411/12 [==========================>...] - ETA: 0s - loss: 3.6211 - accuracy: 0.880712/12 [==============================] - ETA: 0s - loss: 3.6191 - accuracy: 0.8806Epoch 3 took 2.25 seconds
12/12 [==============================] - 2s 187ms/step - loss: 3.6191 - accuracy: 0.8806 - val_loss: 4.1974 - val_accuracy: 0.5000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.3141 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 1s - loss: 3.3011 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 3.2495 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 1s - loss: 3.2450 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.2176 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.2125 - accuracy: 0.9271 7/12 [================>.............] - ETA: 0s - loss: 3.2071 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 0s - loss: 3.1791 - accuracy: 0.9336 9/12 [=====================>........] - ETA: 0s - loss: 3.1850 - accuracy: 0.927110/12 [========================>.....] - ETA: 0s - loss: 3.1648 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.1590 - accuracy: 0.929012/12 [==============================] - ETA: 0s - loss: 3.1554 - accuracy: 0.9278Epoch 4 took 2.55 seconds
12/12 [==============================] - 3s 215ms/step - loss: 3.1554 - accuracy: 0.9278 - val_loss: 3.9323 - val_accuracy: 0.3250
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 2.9059 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 2.9146 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 2.8893 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 2.8927 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 2s - loss: 2.8712 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 2.8503 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 2.8560 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 2.8487 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 2.8308 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 2.8127 - accuracy: 0.943811/12 [==========================>...] - ETA: 0s - loss: 2.8194 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 2.8156 - accuracy: 0.9389Epoch 5 took 3.37 seconds
12/12 [==============================] - 3s 281ms/step - loss: 2.8156 - accuracy: 0.9389 - val_loss: 3.3327 - val_accuracy: 0.5000
Round Complete.
  CPU Usage - Avg: 40.93%, Peak: 46.73%, Min: 15.00%
  Memory Usage - Avg: 944.30 MB, Peak: 993.69 MB, Min: 638.09 MB
  Available Memory - Avg: 2964.05 MB, Peak: 3533.11 MB, Min: 2861.55 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
