2025-04-14 21:47:59.445360: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-14 21:47:59.447692: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:47:59.508587: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:47:59.508984: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-14 21:48:00.348389: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 39s - loss: 5.9150 - accuracy: 0.4688 2/12 [====>.........................] - ETA: 2s - loss: 5.9860 - accuracy: 0.6094  3/12 [======>.......................] - ETA: 2s - loss: 6.2728 - accuracy: 0.6354 4/12 [=========>....................] - ETA: 2s - loss: 5.8734 - accuracy: 0.6875 5/12 [===========>..................] - ETA: 2s - loss: 5.5795 - accuracy: 0.7375 6/12 [==============>...............] - ETA: 2s - loss: 5.5987 - accuracy: 0.7292 7/12 [================>.............] - ETA: 1s - loss: 5.6617 - accuracy: 0.7455 8/12 [===================>..........] - ETA: 1s - loss: 5.6056 - accuracy: 0.7617 9/12 [=====================>........] - ETA: 1s - loss: 5.5555 - accuracy: 0.770810/12 [========================>.....] - ETA: 0s - loss: 5.5934 - accuracy: 0.762511/12 [==========================>...] - ETA: 0s - loss: 5.5072 - accuracy: 0.769912/12 [==============================] - ETA: 0s - loss: 5.5415 - accuracy: 0.7667Epoch 1 took 7.98 seconds
12/12 [==============================] - 8s 397ms/step - loss: 5.5415 - accuracy: 0.7667 - val_loss: 4.5321 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.9043 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 2s - loss: 4.4461 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 2s - loss: 4.4989 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 2s - loss: 5.0881 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.9701 - accuracy: 0.8687 6/12 [==============>...............] - ETA: 1s - loss: 5.0017 - accuracy: 0.8490 7/12 [================>.............] - ETA: 1s - loss: 4.9183 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 1s - loss: 4.9349 - accuracy: 0.8398 9/12 [=====================>........] - ETA: 0s - loss: 4.8788 - accuracy: 0.833310/12 [========================>.....] - ETA: 0s - loss: 4.8553 - accuracy: 0.831311/12 [==========================>...] - ETA: 0s - loss: 4.7680 - accuracy: 0.840912/12 [==============================] - ETA: 0s - loss: 4.7479 - accuracy: 0.8417Epoch 2 took 3.22 seconds
12/12 [==============================] - 3s 271ms/step - loss: 4.7479 - accuracy: 0.8417 - val_loss: 4.1316 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1033 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 4.0853 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 16s - loss: 4.0830 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 10s - loss: 4.0985 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 7s - loss: 4.1469 - accuracy: 0.9000  6/12 [==============>...............] - ETA: 5s - loss: 4.1060 - accuracy: 0.9010 7/12 [================>.............] - ETA: 3s - loss: 4.0799 - accuracy: 0.9062 8/12 [===================>..........] - ETA: 2s - loss: 4.0307 - accuracy: 0.9062 9/12 [=====================>........] - ETA: 2s - loss: 3.9965 - accuracy: 0.902810/12 [========================>.....] - ETA: 1s - loss: 3.9736 - accuracy: 0.896911/12 [==========================>...] - ETA: 0s - loss: 3.9380 - accuracy: 0.903412/12 [==============================] - ETA: 0s - loss: 3.9538 - accuracy: 0.8972Epoch 3 took 6.40 seconds
12/12 [==============================] - 6s 560ms/step - loss: 3.9538 - accuracy: 0.8972 - val_loss: 3.8963 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1753 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 2s - loss: 4.0157 - accuracy: 0.7969 3/12 [======>.......................] - ETA: 2s - loss: 3.8675 - accuracy: 0.8333 4/12 [=========>....................] - ETA: 2s - loss: 3.8001 - accuracy: 0.8359 5/12 [===========>..................] - ETA: 2s - loss: 3.7930 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 1s - loss: 3.7404 - accuracy: 0.8646 7/12 [================>.............] - ETA: 1s - loss: 3.6854 - accuracy: 0.8750 8/12 [===================>..........] - ETA: 1s - loss: 3.6718 - accuracy: 0.8828 9/12 [=====================>........] - ETA: 0s - loss: 3.7907 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 3.7589 - accuracy: 0.871911/12 [==========================>...] - ETA: 0s - loss: 3.7345 - accuracy: 0.869312/12 [==============================] - ETA: 0s - loss: 3.7222 - accuracy: 0.8722Epoch 4 took 4.61 seconds
12/12 [==============================] - 5s 395ms/step - loss: 3.7222 - accuracy: 0.8722 - val_loss: 3.7065 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 7s - loss: 3.5651 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 5s - loss: 3.5968 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 4s - loss: 3.5080 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 4s - loss: 3.5062 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 3s - loss: 3.4624 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 3s - loss: 3.4234 - accuracy: 0.8854 7/12 [================>.............] - ETA: 2s - loss: 3.3987 - accuracy: 0.8884 8/12 [===================>..........] - ETA: 2s - loss: 3.3730 - accuracy: 0.8945 9/12 [=====================>........] - ETA: 1s - loss: 3.3480 - accuracy: 0.899310/12 [========================>.....] - ETA: 1s - loss: 3.3219 - accuracy: 0.906211/12 [==========================>...] - ETA: 0s - loss: 3.3037 - accuracy: 0.911912/12 [==============================] - ETA: 0s - loss: 3.2964 - accuracy: 0.9139Epoch 5 took 6.25 seconds
12/12 [==============================] - 6s 507ms/step - loss: 3.2964 - accuracy: 0.9139 - val_loss: 3.4418 - val_accuracy: 0.6500
Round Complete.
  CPU Usage - Avg: 45.72%, Peak: 52.73%, Min: 27.18%
  Memory Usage - Avg: 948.75 MB, Peak: 1023.38 MB, Min: 659.41 MB
  Available Memory - Avg: 2787.14 MB, Peak: 3323.02 MB, Min: 2664.66 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
