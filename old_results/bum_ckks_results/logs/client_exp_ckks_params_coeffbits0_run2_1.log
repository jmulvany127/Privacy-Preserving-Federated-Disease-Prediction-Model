2025-04-15 12:50:49.740342: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:50:49.742171: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:50:49.782830: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:50:49.783217: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:50:50.443821: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 6.0077 - accuracy: 0.5000 2/12 [====>.........................] - ETA: 1s - loss: 5.7937 - accuracy: 0.7031  3/12 [======>.......................] - ETA: 1s - loss: 6.3403 - accuracy: 0.7500 4/12 [=========>....................] - ETA: 1s - loss: 6.2444 - accuracy: 0.7734 5/12 [===========>..................] - ETA: 1s - loss: 6.0624 - accuracy: 0.7563 6/12 [==============>...............] - ETA: 1s - loss: 6.0864 - accuracy: 0.7396 7/12 [================>.............] - ETA: 1s - loss: 6.0090 - accuracy: 0.7188 8/12 [===================>..........] - ETA: 0s - loss: 5.8674 - accuracy: 0.7305 9/12 [=====================>........] - ETA: 0s - loss: 5.8256 - accuracy: 0.746510/12 [========================>.....] - ETA: 0s - loss: 5.9855 - accuracy: 0.743711/12 [==========================>...] - ETA: 0s - loss: 6.0204 - accuracy: 0.744312/12 [==============================] - ETA: 0s - loss: 5.9981 - accuracy: 0.7444Epoch 1 took 4.25 seconds
12/12 [==============================] - 4s 256ms/step - loss: 5.9981 - accuracy: 0.7444 - val_loss: 4.5438 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.3848 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 1s - loss: 4.5632 - accuracy: 0.7656 3/12 [======>.......................] - ETA: 1s - loss: 4.6337 - accuracy: 0.7396 4/12 [=========>....................] - ETA: 1s - loss: 4.7737 - accuracy: 0.7188 5/12 [===========>..................] - ETA: 1s - loss: 4.6792 - accuracy: 0.7500 6/12 [==============>...............] - ETA: 1s - loss: 4.5847 - accuracy: 0.7812 7/12 [================>.............] - ETA: 1s - loss: 4.6287 - accuracy: 0.7902 8/12 [===================>..........] - ETA: 0s - loss: 4.6194 - accuracy: 0.8086 9/12 [=====================>........] - ETA: 0s - loss: 4.7323 - accuracy: 0.812510/12 [========================>.....] - ETA: 0s - loss: 4.6775 - accuracy: 0.815611/12 [==========================>...] - ETA: 0s - loss: 4.6154 - accuracy: 0.8267Epoch 2 took 2.47 seconds
12/12 [==============================] - 2s 205ms/step - loss: 4.5963 - accuracy: 0.8306 - val_loss: 4.2001 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.0930 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 4.0428 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 4.1515 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 4.0588 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 1s - loss: 3.9904 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 4.0222 - accuracy: 0.8906 7/12 [================>.............] - ETA: 0s - loss: 3.9711 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 0s - loss: 3.9632 - accuracy: 0.8906 9/12 [=====================>........] - ETA: 0s - loss: 3.9265 - accuracy: 0.892410/12 [========================>.....] - ETA: 0s - loss: 3.9106 - accuracy: 0.890611/12 [==========================>...] - ETA: 0s - loss: 3.9011 - accuracy: 0.880712/12 [==============================] - ETA: 0s - loss: 3.9137 - accuracy: 0.8750Epoch 3 took 2.42 seconds
12/12 [==============================] - 2s 200ms/step - loss: 3.9137 - accuracy: 0.8750 - val_loss: 3.9049 - val_accuracy: 0.7500
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.5482 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.4585 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 1s - loss: 3.5083 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 1s - loss: 3.4749 - accuracy: 0.9375 5/12 [===========>..................] - ETA: 1s - loss: 3.5224 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.5291 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.5872 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 0s - loss: 3.6285 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.6158 - accuracy: 0.913210/12 [========================>.....] - ETA: 0s - loss: 3.6308 - accuracy: 0.909411/12 [==========================>...] - ETA: 0s - loss: 3.5868 - accuracy: 0.914812/12 [==============================] - ETA: 0s - loss: 3.5757 - accuracy: 0.9167Epoch 4 took 2.49 seconds
12/12 [==============================] - 2s 209ms/step - loss: 3.5757 - accuracy: 0.9167 - val_loss: 3.5949 - val_accuracy: 0.7500
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.2292 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.2381 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.2430 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 2s - loss: 3.2431 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 2s - loss: 3.2609 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.2201 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 3.2066 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 1s - loss: 3.1740 - accuracy: 0.9336 9/12 [=====================>........] - ETA: 0s - loss: 3.1671 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 3.1626 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 3.1410 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 3.1351 - accuracy: 0.9361Epoch 5 took 3.60 seconds
12/12 [==============================] - 4s 310ms/step - loss: 3.1351 - accuracy: 0.9361 - val_loss: 3.3363 - val_accuracy: 0.7750
Round Complete.
  CPU Usage - Avg: 41.33%, Peak: 48.45%, Min: 12.00%
  Memory Usage - Avg: 965.33 MB, Peak: 1009.73 MB, Min: 684.88 MB
  Available Memory - Avg: 2949.18 MB, Peak: 3504.83 MB, Min: 2854.15 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
