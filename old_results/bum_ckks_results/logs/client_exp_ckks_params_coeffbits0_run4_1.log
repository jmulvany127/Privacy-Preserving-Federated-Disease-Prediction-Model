2025-04-15 12:55:02.114546: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:55:02.117262: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:55:02.174738: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:55:02.175121: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:55:02.817661: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 5.1466 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 2s - loss: 6.6139 - accuracy: 0.6094  3/12 [======>.......................] - ETA: 2s - loss: 6.1443 - accuracy: 0.6667 4/12 [=========>....................] - ETA: 1s - loss: 6.0718 - accuracy: 0.6719 5/12 [===========>..................] - ETA: 1s - loss: 5.9127 - accuracy: 0.6875 6/12 [==============>...............] - ETA: 1s - loss: 5.8422 - accuracy: 0.6927 7/12 [================>.............] - ETA: 1s - loss: 5.6225 - accuracy: 0.7232 8/12 [===================>..........] - ETA: 0s - loss: 5.5129 - accuracy: 0.7422 9/12 [=====================>........] - ETA: 0s - loss: 5.5179 - accuracy: 0.750010/12 [========================>.....] - ETA: 0s - loss: 5.5830 - accuracy: 0.759411/12 [==========================>...] - ETA: 0s - loss: 5.5195 - accuracy: 0.775612/12 [==============================] - ETA: 0s - loss: 5.4919 - accuracy: 0.7778Epoch 1 took 4.02 seconds
12/12 [==============================] - 4s 236ms/step - loss: 5.4919 - accuracy: 0.7778 - val_loss: 4.4798 - val_accuracy: 0.8500
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.5091 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 4.8235 - accuracy: 0.7969 3/12 [======>.......................] - ETA: 1s - loss: 4.7281 - accuracy: 0.8229 4/12 [=========>....................] - ETA: 1s - loss: 4.7536 - accuracy: 0.8125 5/12 [===========>..................] - ETA: 1s - loss: 4.6217 - accuracy: 0.8375 6/12 [==============>...............] - ETA: 1s - loss: 4.6482 - accuracy: 0.8385 7/12 [================>.............] - ETA: 0s - loss: 4.5843 - accuracy: 0.8438 8/12 [===================>..........] - ETA: 0s - loss: 4.5110 - accuracy: 0.8555 9/12 [=====================>........] - ETA: 0s - loss: 4.4852 - accuracy: 0.850710/12 [========================>.....] - ETA: 0s - loss: 4.4917 - accuracy: 0.853111/12 [==========================>...] - ETA: 0s - loss: 4.5317 - accuracy: 0.843812/12 [==============================] - ETA: 0s - loss: 4.5296 - accuracy: 0.8417Epoch 2 took 2.36 seconds
12/12 [==============================] - 2s 199ms/step - loss: 4.5296 - accuracy: 0.8417 - val_loss: 4.3186 - val_accuracy: 0.6750
Epoch 3/5
 1/12 [=>............................] - ETA: 1s - loss: 4.1519 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 4.1367 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 4.0748 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 1s - loss: 4.2239 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 1s - loss: 4.2426 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 1s - loss: 4.1514 - accuracy: 0.8646 7/12 [================>.............] - ETA: 1s - loss: 4.1303 - accuracy: 0.8750 8/12 [===================>..........] - ETA: 0s - loss: 4.0858 - accuracy: 0.8789 9/12 [=====================>........] - ETA: 0s - loss: 4.0804 - accuracy: 0.871510/12 [========================>.....] - ETA: 0s - loss: 4.0344 - accuracy: 0.875011/12 [==========================>...] - ETA: 0s - loss: 4.0450 - accuracy: 0.869312/12 [==============================] - ETA: 0s - loss: 4.0324 - accuracy: 0.8722Epoch 3 took 2.41 seconds
12/12 [==============================] - 2s 202ms/step - loss: 4.0324 - accuracy: 0.8722 - val_loss: 4.0092 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 1s - loss: 3.6417 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 3.6951 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 3.6261 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 3.5978 - accuracy: 0.9375 5/12 [===========>..................] - ETA: 1s - loss: 3.7353 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 3.6978 - accuracy: 0.9167 7/12 [================>.............] - ETA: 0s - loss: 3.7193 - accuracy: 0.8973 8/12 [===================>..........] - ETA: 0s - loss: 3.6994 - accuracy: 0.8984 9/12 [=====================>........] - ETA: 0s - loss: 3.6595 - accuracy: 0.909710/12 [========================>.....] - ETA: 0s - loss: 3.6213 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.5972 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.5885 - accuracy: 0.9194Epoch 4 took 2.35 seconds
12/12 [==============================] - 2s 199ms/step - loss: 3.5885 - accuracy: 0.9194 - val_loss: 4.0748 - val_accuracy: 0.6250
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.5616 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 3.4860 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 2s - loss: 3.3781 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.3267 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 1s - loss: 3.2921 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.2907 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 3.2986 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 3.2672 - accuracy: 0.9492 9/12 [=====================>........] - ETA: 0s - loss: 3.2713 - accuracy: 0.944410/12 [========================>.....] - ETA: 0s - loss: 3.2457 - accuracy: 0.950011/12 [==========================>...] - ETA: 0s - loss: 3.2484 - accuracy: 0.948912/12 [==============================] - ETA: 0s - loss: 3.2445 - accuracy: 0.9500Epoch 5 took 3.27 seconds
12/12 [==============================] - 3s 279ms/step - loss: 3.2445 - accuracy: 0.9500 - val_loss: 4.2228 - val_accuracy: 0.5500
Round Complete.
  CPU Usage - Avg: 41.97%, Peak: 47.95%, Min: 18.95%
  Memory Usage - Avg: 958.20 MB, Peak: 1003.49 MB, Min: 688.52 MB
  Available Memory - Avg: 2972.30 MB, Peak: 3526.25 MB, Min: 2860.14 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
