2025-04-15 13:05:54.276235: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 13:05:54.277926: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:05:54.314279: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:05:54.314671: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 13:05:55.001348: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 6.7317 - accuracy: 0.4062 2/12 [====>.........................] - ETA: 2s - loss: 7.4898 - accuracy: 0.6094  3/12 [======>.......................] - ETA: 1s - loss: 9.3412 - accuracy: 0.6250 4/12 [=========>....................] - ETA: 1s - loss: 9.3368 - accuracy: 0.6641 5/12 [===========>..................] - ETA: 1s - loss: 8.5775 - accuracy: 0.7000 6/12 [==============>...............] - ETA: 1s - loss: 7.9219 - accuracy: 0.7188 7/12 [================>.............] - ETA: 1s - loss: 7.5186 - accuracy: 0.7188 8/12 [===================>..........] - ETA: 0s - loss: 7.1497 - accuracy: 0.7266 9/12 [=====================>........] - ETA: 0s - loss: 6.9350 - accuracy: 0.715310/12 [========================>.....] - ETA: 0s - loss: 6.6970 - accuracy: 0.725011/12 [==========================>...] - ETA: 0s - loss: 6.5071 - accuracy: 0.733012/12 [==============================] - ETA: 0s - loss: 6.4618 - accuracy: 0.7361Epoch 1 took 4.16 seconds
12/12 [==============================] - 4s 241ms/step - loss: 6.4618 - accuracy: 0.7361 - val_loss: 4.5040 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.3852 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 4.3800 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 1s - loss: 4.4619 - accuracy: 0.8229 4/12 [=========>....................] - ETA: 1s - loss: 4.5029 - accuracy: 0.8047 5/12 [===========>..................] - ETA: 1s - loss: 4.5587 - accuracy: 0.8000 6/12 [==============>...............] - ETA: 1s - loss: 4.5514 - accuracy: 0.8073 7/12 [================>.............] - ETA: 0s - loss: 4.4588 - accuracy: 0.8304 8/12 [===================>..........] - ETA: 0s - loss: 4.4075 - accuracy: 0.8477 9/12 [=====================>........] - ETA: 0s - loss: 4.3652 - accuracy: 0.854210/12 [========================>.....] - ETA: 0s - loss: 4.3593 - accuracy: 0.834411/12 [==========================>...] - ETA: 0s - loss: 4.3237 - accuracy: 0.835212/12 [==============================] - ETA: 0s - loss: 4.3107 - accuracy: 0.8389Epoch 2 took 2.33 seconds
12/12 [==============================] - 2s 196ms/step - loss: 4.3107 - accuracy: 0.8389 - val_loss: 4.1743 - val_accuracy: 0.7250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1131 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 4.0818 - accuracy: 0.8438 3/12 [======>.......................] - ETA: 1s - loss: 3.9425 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 1s - loss: 3.8807 - accuracy: 0.8828 5/12 [===========>..................] - ETA: 1s - loss: 3.9591 - accuracy: 0.8625 6/12 [==============>...............] - ETA: 1s - loss: 3.8946 - accuracy: 0.8750 7/12 [================>.............] - ETA: 1s - loss: 3.8633 - accuracy: 0.8795 8/12 [===================>..........] - ETA: 0s - loss: 3.8813 - accuracy: 0.8750 9/12 [=====================>........] - ETA: 0s - loss: 3.8975 - accuracy: 0.864610/12 [========================>.....] - ETA: 0s - loss: 3.8720 - accuracy: 0.862511/12 [==========================>...] - ETA: 0s - loss: 3.8376 - accuracy: 0.872212/12 [==============================] - ETA: 0s - loss: 3.8285 - accuracy: 0.8722Epoch 3 took 2.40 seconds
12/12 [==============================] - 2s 200ms/step - loss: 3.8285 - accuracy: 0.8722 - val_loss: 4.0820 - val_accuracy: 0.5500
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.3738 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 3.3472 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 3.3468 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 3.3372 - accuracy: 0.9375 5/12 [===========>..................] - ETA: 1s - loss: 3.3689 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.3352 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 3.3320 - accuracy: 0.9286 8/12 [===================>..........] - ETA: 1s - loss: 3.3232 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.3031 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 3.2854 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.2836 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.2776 - accuracy: 0.9278Epoch 4 took 3.32 seconds
12/12 [==============================] - 3s 284ms/step - loss: 3.2776 - accuracy: 0.9278 - val_loss: 3.9949 - val_accuracy: 0.5000
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 2.9091 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 3s - loss: 2.9435 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 2.9225 - accuracy: 0.9792 4/12 [=========>....................] - ETA: 2s - loss: 2.9376 - accuracy: 0.9688 5/12 [===========>..................] - ETA: 2s - loss: 2.9802 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 2.9765 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 2.9606 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 1s - loss: 2.9485 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 2.9317 - accuracy: 0.947910/12 [========================>.....] - ETA: 0s - loss: 2.9234 - accuracy: 0.943811/12 [==========================>...] - ETA: 0s - loss: 2.9157 - accuracy: 0.943212/12 [==============================] - ETA: 0s - loss: 2.9199 - accuracy: 0.9361Epoch 5 took 3.46 seconds
12/12 [==============================] - 3s 293ms/step - loss: 2.9199 - accuracy: 0.9361 - val_loss: 4.0742 - val_accuracy: 0.4500
Round Complete.
  CPU Usage - Avg: 30.84%, Peak: 47.70%, Min: 0.00%
  Memory Usage - Avg: 971.44 MB, Peak: 1005.68 MB, Min: 683.62 MB
  Available Memory - Avg: 3104.50 MB, Peak: 3604.40 MB, Min: 2868.76 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
