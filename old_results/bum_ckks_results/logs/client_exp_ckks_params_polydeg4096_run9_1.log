2025-04-15 08:35:45.045148: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:35:45.046825: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:35:45.082428: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:35:45.082866: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:35:45.731260: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 5.7043 - accuracy: 0.4688 2/12 [====>.........................] - ETA: 2s - loss: 5.8206 - accuracy: 0.5625  3/12 [======>.......................] - ETA: 1s - loss: 5.8361 - accuracy: 0.6667 4/12 [=========>....................] - ETA: 1s - loss: 5.8335 - accuracy: 0.7031 5/12 [===========>..................] - ETA: 1s - loss: 6.0903 - accuracy: 0.6812 6/12 [==============>...............] - ETA: 1s - loss: 5.9183 - accuracy: 0.7135 7/12 [================>.............] - ETA: 0s - loss: 5.8337 - accuracy: 0.7277 8/12 [===================>..........] - ETA: 0s - loss: 5.7579 - accuracy: 0.7344 9/12 [=====================>........] - ETA: 0s - loss: 5.6772 - accuracy: 0.729210/12 [========================>.....] - ETA: 0s - loss: 5.5982 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.4754 - accuracy: 0.752812/12 [==============================] - ETA: 0s - loss: 5.4477 - accuracy: 0.7556Epoch 1 took 3.83 seconds
12/12 [==============================] - 4s 218ms/step - loss: 5.4477 - accuracy: 0.7556 - val_loss: 4.6057 - val_accuracy: 0.9000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1542 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 1s - loss: 4.4371 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 4.7870 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 4.7508 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 1s - loss: 4.9161 - accuracy: 0.8687 6/12 [==============>...............] - ETA: 1s - loss: 4.8260 - accuracy: 0.8750 7/12 [================>.............] - ETA: 1s - loss: 4.7193 - accuracy: 0.8750 8/12 [===================>..........] - ETA: 0s - loss: 4.6525 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 0s - loss: 4.6654 - accuracy: 0.847210/12 [========================>.....] - ETA: 0s - loss: 4.6296 - accuracy: 0.856211/12 [==========================>...] - ETA: 0s - loss: 4.5820 - accuracy: 0.855112/12 [==============================] - ETA: 0s - loss: 4.6154 - accuracy: 0.8556Epoch 2 took 2.33 seconds
12/12 [==============================] - 2s 193ms/step - loss: 4.6154 - accuracy: 0.8556 - val_loss: 4.1845 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.0942 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 3.9163 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 1s - loss: 3.9926 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 4.0210 - accuracy: 0.8906 5/12 [===========>..................] - ETA: 1s - loss: 4.1666 - accuracy: 0.8562 6/12 [==============>...............] - ETA: 1s - loss: 4.0999 - accuracy: 0.8698 7/12 [================>.............] - ETA: 0s - loss: 4.0543 - accuracy: 0.8750 8/12 [===================>..........] - ETA: 0s - loss: 3.9893 - accuracy: 0.8906 9/12 [=====================>........] - ETA: 0s - loss: 4.0155 - accuracy: 0.885410/12 [========================>.....] - ETA: 0s - loss: 3.9801 - accuracy: 0.893811/12 [==========================>...] - ETA: 0s - loss: 3.9385 - accuracy: 0.900612/12 [==============================] - ETA: 0s - loss: 3.9287 - accuracy: 0.9028Epoch 3 took 2.25 seconds
12/12 [==============================] - 2s 186ms/step - loss: 3.9287 - accuracy: 0.9028 - val_loss: 3.9063 - val_accuracy: 0.7250
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.4652 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 1s - loss: 3.7828 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 3.7167 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.6179 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 1s - loss: 3.5763 - accuracy: 0.9375 6/12 [==============>...............] - ETA: 1s - loss: 3.5308 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 3.4998 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 0s - loss: 3.5128 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.4814 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 3.4608 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 3.4354 - accuracy: 0.943212/12 [==============================] - ETA: 0s - loss: 3.4293 - accuracy: 0.9444Epoch 4 took 2.84 seconds
12/12 [==============================] - 3s 241ms/step - loss: 3.4293 - accuracy: 0.9444 - val_loss: 3.7108 - val_accuracy: 0.5750
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.1598 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.1242 - accuracy: 0.9844 3/12 [======>.......................] - ETA: 2s - loss: 3.1258 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 2s - loss: 3.1016 - accuracy: 0.9766 5/12 [===========>..................] - ETA: 2s - loss: 3.1095 - accuracy: 0.9750 6/12 [==============>...............] - ETA: 1s - loss: 3.1016 - accuracy: 0.9688 7/12 [================>.............] - ETA: 1s - loss: 3.1137 - accuracy: 0.9643 8/12 [===================>..........] - ETA: 1s - loss: 3.1010 - accuracy: 0.9648 9/12 [=====================>........] - ETA: 0s - loss: 3.0844 - accuracy: 0.968810/12 [========================>.....] - ETA: 0s - loss: 3.0840 - accuracy: 0.962511/12 [==========================>...] - ETA: 0s - loss: 3.0888 - accuracy: 0.960212/12 [==============================] - ETA: 0s - loss: 3.0871 - accuracy: 0.9611Epoch 5 took 3.15 seconds
12/12 [==============================] - 3s 260ms/step - loss: 3.0871 - accuracy: 0.9611 - val_loss: 4.4430 - val_accuracy: 0.2750
Round Complete.
  CPU Usage - Avg: 41.87%, Peak: 47.20%, Min: 24.98%
  Memory Usage - Avg: 941.83 MB, Peak: 991.74 MB, Min: 663.46 MB
  Available Memory - Avg: 2955.11 MB, Peak: 3471.18 MB, Min: 2858.84 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
