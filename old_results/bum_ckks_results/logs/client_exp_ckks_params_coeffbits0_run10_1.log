2025-04-15 13:08:04.533479: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 13:08:04.536266: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:08:04.577653: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:08:04.578047: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 13:08:05.205594: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 7.2257 - accuracy: 0.3750 2/12 [====>.........................] - ETA: 1s - loss: 9.9184 - accuracy: 0.5000  3/12 [======>.......................] - ETA: 1s - loss: 9.2475 - accuracy: 0.5729 4/12 [=========>....................] - ETA: 1s - loss: 8.1710 - accuracy: 0.6328 5/12 [===========>..................] - ETA: 1s - loss: 7.5322 - accuracy: 0.6625 6/12 [==============>...............] - ETA: 1s - loss: 7.1000 - accuracy: 0.6719 7/12 [================>.............] - ETA: 1s - loss: 6.7370 - accuracy: 0.7009 8/12 [===================>..........] - ETA: 0s - loss: 6.4663 - accuracy: 0.7227 9/12 [=====================>........] - ETA: 0s - loss: 6.2387 - accuracy: 0.743110/12 [========================>.....] - ETA: 0s - loss: 6.0999 - accuracy: 0.750011/12 [==========================>...] - ETA: 0s - loss: 5.9318 - accuracy: 0.767012/12 [==============================] - ETA: 0s - loss: 5.8912 - accuracy: 0.7722Epoch 1 took 3.87 seconds
12/12 [==============================] - 4s 219ms/step - loss: 5.8912 - accuracy: 0.7722 - val_loss: 4.5297 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.2590 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 4.4206 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 4.4450 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 1s - loss: 4.5348 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.4895 - accuracy: 0.8625 6/12 [==============>...............] - ETA: 1s - loss: 4.4402 - accuracy: 0.8594 7/12 [================>.............] - ETA: 0s - loss: 4.4071 - accuracy: 0.8616 8/12 [===================>..........] - ETA: 0s - loss: 4.3771 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 0s - loss: 4.3544 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 4.3586 - accuracy: 0.862511/12 [==========================>...] - ETA: 0s - loss: 4.3238 - accuracy: 0.866512/12 [==============================] - ETA: 0s - loss: 4.3141 - accuracy: 0.8667Epoch 2 took 2.29 seconds
12/12 [==============================] - 2s 190ms/step - loss: 4.3141 - accuracy: 0.8667 - val_loss: 4.1679 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.4238 - accuracy: 0.7188 2/12 [====>.........................] - ETA: 1s - loss: 4.4459 - accuracy: 0.7500 3/12 [======>.......................] - ETA: 1s - loss: 4.2218 - accuracy: 0.8229 4/12 [=========>....................] - ETA: 1s - loss: 4.1075 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 1s - loss: 4.0441 - accuracy: 0.8562 6/12 [==============>...............] - ETA: 1s - loss: 4.0386 - accuracy: 0.8646 7/12 [================>.............] - ETA: 0s - loss: 3.9831 - accuracy: 0.8795 8/12 [===================>..........] - ETA: 0s - loss: 3.9875 - accuracy: 0.8750 9/12 [=====================>........] - ETA: 0s - loss: 3.9484 - accuracy: 0.881910/12 [========================>.....] - ETA: 0s - loss: 3.9290 - accuracy: 0.887511/12 [==========================>...] - ETA: 0s - loss: 3.9133 - accuracy: 0.883512/12 [==============================] - ETA: 0s - loss: 3.9065 - accuracy: 0.8833Epoch 3 took 2.32 seconds
12/12 [==============================] - 2s 194ms/step - loss: 3.9065 - accuracy: 0.8833 - val_loss: 3.9729 - val_accuracy: 0.6250
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6896 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.5659 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 3.5474 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 3.5394 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.5100 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.4894 - accuracy: 0.9167 7/12 [================>.............] - ETA: 0s - loss: 3.4626 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 0s - loss: 3.4671 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.4330 - accuracy: 0.923610/12 [========================>.....] - ETA: 0s - loss: 3.4133 - accuracy: 0.925011/12 [==========================>...] - ETA: 0s - loss: 3.4001 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.3925 - accuracy: 0.9278Epoch 4 took 2.37 seconds
12/12 [==============================] - 2s 197ms/step - loss: 3.3925 - accuracy: 0.9278 - val_loss: 3.8234 - val_accuracy: 0.5750
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.2641 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.3050 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 2s - loss: 3.2372 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 2s - loss: 3.2005 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 1s - loss: 3.1503 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 3.1551 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 3.1243 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 3.1085 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 3.0894 - accuracy: 0.944410/12 [========================>.....] - ETA: 0s - loss: 3.1051 - accuracy: 0.940611/12 [==========================>...] - ETA: 0s - loss: 3.0838 - accuracy: 0.943212/12 [==============================] - ETA: 0s - loss: 3.0788 - accuracy: 0.9444Epoch 5 took 3.21 seconds
12/12 [==============================] - 3s 271ms/step - loss: 3.0788 - accuracy: 0.9444 - val_loss: 3.3773 - val_accuracy: 0.6750
Round Complete.
  CPU Usage - Avg: 40.84%, Peak: 49.20%, Min: 5.75%
  Memory Usage - Avg: 968.82 MB, Peak: 1017.42 MB, Min: 690.05 MB
  Available Memory - Avg: 2951.52 MB, Peak: 3504.12 MB, Min: 2849.48 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
