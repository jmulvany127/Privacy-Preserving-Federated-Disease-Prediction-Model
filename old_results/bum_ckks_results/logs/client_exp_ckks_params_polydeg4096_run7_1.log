2025-04-15 08:31:33.921533: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:31:33.923340: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:31:33.958060: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:31:33.958469: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:31:34.552507: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 5.5432 - accuracy: 0.5312 2/12 [====>.........................] - ETA: 1s - loss: 8.3881 - accuracy: 0.6562  3/12 [======>.......................] - ETA: 1s - loss: 7.7238 - accuracy: 0.7292 4/12 [=========>....................] - ETA: 1s - loss: 8.0092 - accuracy: 0.7266 5/12 [===========>..................] - ETA: 1s - loss: 7.7605 - accuracy: 0.7188 6/12 [==============>...............] - ETA: 1s - loss: 7.3771 - accuracy: 0.7240 7/12 [================>.............] - ETA: 0s - loss: 7.0079 - accuracy: 0.7277 8/12 [===================>..........] - ETA: 0s - loss: 6.7533 - accuracy: 0.7148 9/12 [=====================>........] - ETA: 0s - loss: 6.5349 - accuracy: 0.708310/12 [========================>.....] - ETA: 0s - loss: 6.3414 - accuracy: 0.706311/12 [==========================>...] - ETA: 0s - loss: 6.1811 - accuracy: 0.710212/12 [==============================] - ETA: 0s - loss: 6.1538 - accuracy: 0.7139Epoch 1 took 3.73 seconds
12/12 [==============================] - 4s 204ms/step - loss: 6.1538 - accuracy: 0.7139 - val_loss: 4.4879 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.3678 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 1s - loss: 4.5589 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 1s - loss: 4.4398 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 1s - loss: 4.4051 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 1s - loss: 4.4118 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 1s - loss: 4.4447 - accuracy: 0.8438 7/12 [================>.............] - ETA: 0s - loss: 4.4925 - accuracy: 0.8259 8/12 [===================>..........] - ETA: 0s - loss: 4.4112 - accuracy: 0.8398 9/12 [=====================>........] - ETA: 0s - loss: 4.4109 - accuracy: 0.836810/12 [========================>.....] - ETA: 0s - loss: 4.3611 - accuracy: 0.843811/12 [==========================>...] - ETA: 0s - loss: 4.3159 - accuracy: 0.8409Epoch 2 took 2.23 seconds
12/12 [==============================] - 2s 185ms/step - loss: 4.3065 - accuracy: 0.8417 - val_loss: 4.2739 - val_accuracy: 0.5750
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.8816 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 1s - loss: 3.8991 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 3.9101 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 1s - loss: 3.8739 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 1s - loss: 3.8519 - accuracy: 0.8938 6/12 [==============>...............] - ETA: 1s - loss: 3.8593 - accuracy: 0.8750 7/12 [================>.............] - ETA: 0s - loss: 3.8213 - accuracy: 0.8795 8/12 [===================>..........] - ETA: 0s - loss: 3.7888 - accuracy: 0.8906 9/12 [=====================>........] - ETA: 0s - loss: 3.7532 - accuracy: 0.895810/12 [========================>.....] - ETA: 0s - loss: 3.7244 - accuracy: 0.896911/12 [==========================>...] - ETA: 0s - loss: 3.7037 - accuracy: 0.892012/12 [==============================] - ETA: 0s - loss: 3.6947 - accuracy: 0.8944Epoch 3 took 2.24 seconds
12/12 [==============================] - 2s 187ms/step - loss: 3.6947 - accuracy: 0.8944 - val_loss: 3.7283 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.3247 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 1s - loss: 3.3740 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 1s - loss: 3.3681 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 1s - loss: 3.3694 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 1s - loss: 3.3532 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.3202 - accuracy: 0.9375 7/12 [================>.............] - ETA: 0s - loss: 3.2993 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 0s - loss: 3.2722 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 0s - loss: 3.2544 - accuracy: 0.944410/12 [========================>.....] - ETA: 0s - loss: 3.2668 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 3.2525 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 3.2540 - accuracy: 0.9361Epoch 4 took 2.19 seconds
12/12 [==============================] - 2s 181ms/step - loss: 3.2540 - accuracy: 0.9361 - val_loss: 3.3782 - val_accuracy: 0.8250
Epoch 5/5
 1/12 [=>............................] - ETA: 1s - loss: 3.0116 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.0878 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 2s - loss: 3.1194 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 3.1071 - accuracy: 0.8828 5/12 [===========>..................] - ETA: 1s - loss: 3.0901 - accuracy: 0.8875 6/12 [==============>...............] - ETA: 1s - loss: 3.0622 - accuracy: 0.9010 7/12 [================>.............] - ETA: 1s - loss: 3.0461 - accuracy: 0.9062 8/12 [===================>..........] - ETA: 1s - loss: 3.0255 - accuracy: 0.9062 9/12 [=====================>........] - ETA: 0s - loss: 3.0142 - accuracy: 0.902810/12 [========================>.....] - ETA: 0s - loss: 3.0108 - accuracy: 0.903111/12 [==========================>...] - ETA: 0s - loss: 2.9884 - accuracy: 0.906212/12 [==============================] - ETA: 0s - loss: 2.9926 - accuracy: 0.9056Epoch 5 took 3.09 seconds
12/12 [==============================] - 3s 266ms/step - loss: 2.9926 - accuracy: 0.9056 - val_loss: 3.2115 - val_accuracy: 0.6750
Round Complete.
  CPU Usage - Avg: 41.94%, Peak: 48.70%, Min: 24.98%
  Memory Usage - Avg: 939.79 MB, Peak: 988.79 MB, Min: 666.71 MB
  Available Memory - Avg: 2955.97 MB, Peak: 3478.47 MB, Min: 2851.30 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
