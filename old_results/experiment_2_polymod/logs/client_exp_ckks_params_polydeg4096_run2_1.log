2025-04-14 21:44:59.003418: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-14 21:44:59.005156: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:44:59.049597: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:44:59.050404: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-14 21:44:59.969213: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 44s - loss: 5.4966 - accuracy: 0.6250 2/12 [====>.........................] - ETA: 7s - loss: 6.3217 - accuracy: 0.7344  3/12 [======>.......................] - ETA: 6s - loss: 7.4265 - accuracy: 0.7292 4/12 [=========>....................] - ETA: 4s - loss: 7.2170 - accuracy: 0.7344 5/12 [===========>..................] - ETA: 4s - loss: 6.6931 - accuracy: 0.7563 6/12 [==============>...............] - ETA: 3s - loss: 6.5356 - accuracy: 0.7500 7/12 [================>.............] - ETA: 3s - loss: 6.4508 - accuracy: 0.7277 8/12 [===================>..........] - ETA: 2s - loss: 6.2428 - accuracy: 0.7383 9/12 [=====================>........] - ETA: 1s - loss: 6.0855 - accuracy: 0.736110/12 [========================>.....] - ETA: 1s - loss: 5.9650 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.8938 - accuracy: 0.738612/12 [==============================] - ETA: 0s - loss: 5.8507 - accuracy: 0.7444Epoch 1 took 11.18 seconds
12/12 [==============================] - 11s 651ms/step - loss: 5.8507 - accuracy: 0.7444 - val_loss: 4.4856 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 3s - loss: 4.5118 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 3s - loss: 4.4762 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 2s - loss: 4.3439 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 2s - loss: 4.3028 - accuracy: 0.8828 5/12 [===========>..................] - ETA: 2s - loss: 4.4261 - accuracy: 0.8687 6/12 [==============>...............] - ETA: 2s - loss: 4.3238 - accuracy: 0.8854 7/12 [================>.............] - ETA: 1s - loss: 4.3280 - accuracy: 0.8839 8/12 [===================>..........] - ETA: 1s - loss: 4.4031 - accuracy: 0.8711 9/12 [=====================>........] - ETA: 1s - loss: 4.3792 - accuracy: 0.871510/12 [========================>.....] - ETA: 0s - loss: 4.3777 - accuracy: 0.868711/12 [==========================>...] - ETA: 0s - loss: 4.3988 - accuracy: 0.860812/12 [==============================] - ETA: 0s - loss: 4.3879 - accuracy: 0.8611Epoch 2 took 4.09 seconds
12/12 [==============================] - 4s 347ms/step - loss: 4.3879 - accuracy: 0.8611 - val_loss: 4.0223 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 3.8855 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 3s - loss: 4.0617 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 2s - loss: 4.1493 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 2s - loss: 4.0611 - accuracy: 0.8750 5/12 [===========>..................] - ETA: 2s - loss: 4.0142 - accuracy: 0.8813 6/12 [==============>...............] - ETA: 1s - loss: 4.0059 - accuracy: 0.8802 7/12 [================>.............] - ETA: 1s - loss: 3.9365 - accuracy: 0.8884 8/12 [===================>..........] - ETA: 3s - loss: 3.9114 - accuracy: 0.8828 9/12 [=====================>........] - ETA: 2s - loss: 3.8635 - accuracy: 0.885410/12 [========================>.....] - ETA: 1s - loss: 3.8356 - accuracy: 0.881311/12 [==========================>...] - ETA: 0s - loss: 3.8252 - accuracy: 0.875012/12 [==============================] - ETA: 0s - loss: 3.8338 - accuracy: 0.8750Epoch 3 took 6.62 seconds
12/12 [==============================] - 7s 572ms/step - loss: 3.8338 - accuracy: 0.8750 - val_loss: 3.7119 - val_accuracy: 0.8250
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.7546 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 3.4886 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.4408 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.4662 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.4073 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.4086 - accuracy: 0.9062 7/12 [================>.............] - ETA: 1s - loss: 3.3960 - accuracy: 0.9062 8/12 [===================>..........] - ETA: 1s - loss: 3.3706 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.3979 - accuracy: 0.906210/12 [========================>.....] - ETA: 0s - loss: 3.3974 - accuracy: 0.906211/12 [==========================>...] - ETA: 0s - loss: 3.3920 - accuracy: 0.903412/12 [==============================] - ETA: 0s - loss: 3.3834 - accuracy: 0.9056Epoch 4 took 3.64 seconds
12/12 [==============================] - 4s 306ms/step - loss: 3.3834 - accuracy: 0.9056 - val_loss: 3.4461 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.4492 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 3s - loss: 3.2227 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 2s - loss: 3.1328 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.0745 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 2s - loss: 3.0427 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.0308 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 3.0284 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 1s - loss: 3.0201 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 0s - loss: 3.0087 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 3.0356 - accuracy: 0.925011/12 [==========================>...] - ETA: 0s - loss: 3.0219 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.0160 - accuracy: 0.9278Epoch 5 took 3.62 seconds
12/12 [==============================] - 4s 303ms/step - loss: 3.0160 - accuracy: 0.9278 - val_loss: 3.4735 - val_accuracy: 0.5000
Round Complete.
  CPU Usage - Avg: 42.95%, Peak: 51.95%, Min: 26.23%
  Memory Usage - Avg: 935.44 MB, Peak: 992.33 MB, Min: 654.65 MB
  Available Memory - Avg: 2594.81 MB, Peak: 3160.95 MB, Min: 2479.27 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
