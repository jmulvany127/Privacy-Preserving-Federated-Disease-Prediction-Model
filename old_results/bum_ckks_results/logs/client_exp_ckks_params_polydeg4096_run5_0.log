2025-04-15 08:27:21.775810: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:27:21.777549: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:27:21.816277: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:27:21.816659: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:27:22.459629: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 17s - loss: 5.4439 - accuracy: 0.5625 2/12 [====>.........................] - ETA: 2s - loss: 6.2243 - accuracy: 0.7188  3/12 [======>.......................] - ETA: 1s - loss: 6.7382 - accuracy: 0.7500 4/12 [=========>....................] - ETA: 1s - loss: 6.6373 - accuracy: 0.7578 5/12 [===========>..................] - ETA: 1s - loss: 6.3126 - accuracy: 0.7375 6/12 [==============>...............] - ETA: 1s - loss: 6.2250 - accuracy: 0.7083 7/12 [================>.............] - ETA: 0s - loss: 6.0130 - accuracy: 0.7321 8/12 [===================>..........] - ETA: 0s - loss: 5.8667 - accuracy: 0.7422 9/12 [=====================>........] - ETA: 0s - loss: 5.8714 - accuracy: 0.746510/12 [========================>.....] - ETA: 0s - loss: 5.8460 - accuracy: 0.750011/12 [==========================>...] - ETA: 0s - loss: 5.7158 - accuracy: 0.755712/12 [==============================] - ETA: 0s - loss: 5.7229 - accuracy: 0.7528Epoch 1 took 3.84 seconds
12/12 [==============================] - 4s 206ms/step - loss: 5.7229 - accuracy: 0.7528 - val_loss: 4.4966 - val_accuracy: 0.8750
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.6665 - accuracy: 0.7500 2/12 [====>.........................] - ETA: 1s - loss: 4.7166 - accuracy: 0.7188 3/12 [======>.......................] - ETA: 1s - loss: 4.5034 - accuracy: 0.7812 4/12 [=========>....................] - ETA: 1s - loss: 4.4904 - accuracy: 0.7891 5/12 [===========>..................] - ETA: 1s - loss: 4.4315 - accuracy: 0.8062 6/12 [==============>...............] - ETA: 1s - loss: 4.4192 - accuracy: 0.8021 7/12 [================>.............] - ETA: 0s - loss: 4.3638 - accuracy: 0.8214 8/12 [===================>..........] - ETA: 0s - loss: 4.3632 - accuracy: 0.8242 9/12 [=====================>........] - ETA: 0s - loss: 4.3805 - accuracy: 0.826410/12 [========================>.....] - ETA: 0s - loss: 4.3762 - accuracy: 0.828111/12 [==========================>...] - ETA: 0s - loss: 4.4718 - accuracy: 0.8267Epoch 2 took 2.29 seconds
12/12 [==============================] - 2s 189ms/step - loss: 4.4544 - accuracy: 0.8306 - val_loss: 4.0461 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 1s - loss: 3.9786 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 1s - loss: 4.1869 - accuracy: 0.7812 3/12 [======>.......................] - ETA: 1s - loss: 4.1215 - accuracy: 0.7917 4/12 [=========>....................] - ETA: 1s - loss: 4.2656 - accuracy: 0.7109 5/12 [===========>..................] - ETA: 1s - loss: 4.1961 - accuracy: 0.7188 6/12 [==============>...............] - ETA: 1s - loss: 4.1143 - accuracy: 0.7344 7/12 [================>.............] - ETA: 0s - loss: 4.0538 - accuracy: 0.7545 8/12 [===================>..........] - ETA: 0s - loss: 4.0245 - accuracy: 0.7734 9/12 [=====================>........] - ETA: 0s - loss: 3.9761 - accuracy: 0.795110/12 [========================>.....] - ETA: 0s - loss: 3.9583 - accuracy: 0.806211/12 [==========================>...] - ETA: 0s - loss: 3.9757 - accuracy: 0.815312/12 [==============================] - ETA: 0s - loss: 3.9610 - accuracy: 0.8194Epoch 3 took 2.39 seconds
12/12 [==============================] - 2s 201ms/step - loss: 3.9610 - accuracy: 0.8194 - val_loss: 3.7717 - val_accuracy: 0.8250
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1926 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 3.8265 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 3.7965 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 3.7466 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 1s - loss: 3.6729 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 1s - loss: 3.6717 - accuracy: 0.9167 7/12 [================>.............] - ETA: 1s - loss: 3.6056 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 0s - loss: 3.5803 - accuracy: 0.9180 9/12 [=====================>........] - ETA: 0s - loss: 3.5522 - accuracy: 0.920110/12 [========================>.....] - ETA: 0s - loss: 3.5311 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.5153 - accuracy: 0.909112/12 [==============================] - ETA: 0s - loss: 3.5045 - accuracy: 0.9111Epoch 4 took 2.79 seconds
12/12 [==============================] - 3s 236ms/step - loss: 3.5045 - accuracy: 0.9111 - val_loss: 3.4376 - val_accuracy: 0.8250
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2824 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.2417 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.1812 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.1252 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 2s - loss: 3.1229 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 3.1189 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 3.0888 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 3.0981 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.0911 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.0749 - accuracy: 0.940611/12 [==========================>...] - ETA: 0s - loss: 3.1094 - accuracy: 0.931812/12 [==============================] - ETA: 0s - loss: 3.1038 - accuracy: 0.9306Epoch 5 took 3.41 seconds
12/12 [==============================] - 3s 281ms/step - loss: 3.1038 - accuracy: 0.9306 - val_loss: 3.1762 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 42.25%, Peak: 47.95%, Min: 24.70%
  Memory Usage - Avg: 941.60 MB, Peak: 990.89 MB, Min: 636.91 MB
  Available Memory - Avg: 2949.24 MB, Peak: 3507.75 MB, Min: 2854.13 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
