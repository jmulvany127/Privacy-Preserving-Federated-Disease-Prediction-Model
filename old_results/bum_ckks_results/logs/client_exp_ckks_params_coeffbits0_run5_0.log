2025-04-15 12:57:05.566530: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:57:05.568127: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:57:05.607828: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:57:05.608292: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:57:06.288577: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 17s - loss: 6.0562 - accuracy: 0.4375 2/12 [====>.........................] - ETA: 1s - loss: 7.9153 - accuracy: 0.5781  3/12 [======>.......................] - ETA: 1s - loss: 9.7438 - accuracy: 0.6146 4/12 [=========>....................] - ETA: 1s - loss: 8.9350 - accuracy: 0.6719 5/12 [===========>..................] - ETA: 1s - loss: 8.3175 - accuracy: 0.6687 6/12 [==============>...............] - ETA: 1s - loss: 7.6941 - accuracy: 0.6927 7/12 [================>.............] - ETA: 1s - loss: 7.3090 - accuracy: 0.7009 8/12 [===================>..........] - ETA: 0s - loss: 6.9776 - accuracy: 0.7148 9/12 [=====================>........] - ETA: 0s - loss: 6.7312 - accuracy: 0.704910/12 [========================>.....] - ETA: 0s - loss: 6.5361 - accuracy: 0.706311/12 [==========================>...] - ETA: 0s - loss: 6.3446 - accuracy: 0.721612/12 [==============================] - ETA: 0s - loss: 6.3063 - accuracy: 0.7222Epoch 1 took 4.93 seconds
12/12 [==============================] - 5s 304ms/step - loss: 6.3063 - accuracy: 0.7222 - val_loss: 4.6872 - val_accuracy: 0.5750
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.3236 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 4.3159 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 2s - loss: 4.4079 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 2s - loss: 4.3357 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 2s - loss: 4.3774 - accuracy: 0.8938 6/12 [==============>...............] - ETA: 1s - loss: 4.3722 - accuracy: 0.8854 7/12 [================>.............] - ETA: 1s - loss: 4.3517 - accuracy: 0.8884 8/12 [===================>..........] - ETA: 1s - loss: 4.3379 - accuracy: 0.8789 9/12 [=====================>........] - ETA: 0s - loss: 4.3528 - accuracy: 0.857610/12 [========================>.....] - ETA: 0s - loss: 4.3404 - accuracy: 0.853111/12 [==========================>...] - ETA: 0s - loss: 4.3140 - accuracy: 0.852312/12 [==============================] - ETA: 0s - loss: 4.3054 - accuracy: 0.8556Epoch 2 took 3.23 seconds
12/12 [==============================] - 3s 269ms/step - loss: 4.3054 - accuracy: 0.8556 - val_loss: 4.9967 - val_accuracy: 0.2250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.8873 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 3.8082 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 3.8963 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 1s - loss: 3.9089 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.9179 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 1s - loss: 3.9840 - accuracy: 0.8854 7/12 [================>.............] - ETA: 1s - loss: 3.9256 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 0s - loss: 3.8962 - accuracy: 0.9102 9/12 [=====================>........] - ETA: 0s - loss: 3.8711 - accuracy: 0.909710/12 [========================>.....] - ETA: 0s - loss: 3.8455 - accuracy: 0.909411/12 [==========================>...] - ETA: 0s - loss: 3.8342 - accuracy: 0.911912/12 [==============================] - ETA: 0s - loss: 3.8267 - accuracy: 0.9139Epoch 3 took 2.42 seconds
12/12 [==============================] - 2s 198ms/step - loss: 3.8267 - accuracy: 0.9139 - val_loss: 5.5225 - val_accuracy: 0.2000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.5253 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.5558 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.5034 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 1s - loss: 3.4933 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 1s - loss: 3.4628 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.4420 - accuracy: 0.9531 7/12 [================>.............] - ETA: 1s - loss: 3.4767 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 1s - loss: 3.4816 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 0s - loss: 3.4613 - accuracy: 0.944410/12 [========================>.....] - ETA: 0s - loss: 3.4512 - accuracy: 0.940611/12 [==========================>...] - ETA: 0s - loss: 3.4401 - accuracy: 0.940312/12 [==============================] - ETA: 0s - loss: 3.4331 - accuracy: 0.9417Epoch 4 took 3.14 seconds
12/12 [==============================] - 3s 267ms/step - loss: 3.4331 - accuracy: 0.9417 - val_loss: 6.1226 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2314 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.2253 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 3.2284 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 2s - loss: 3.2183 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 2s - loss: 3.2043 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.1740 - accuracy: 0.9583 7/12 [================>.............] - ETA: 1s - loss: 3.1555 - accuracy: 0.9598 8/12 [===================>..........] - ETA: 1s - loss: 3.1406 - accuracy: 0.9570 9/12 [=====================>........] - ETA: 0s - loss: 3.1317 - accuracy: 0.951410/12 [========================>.....] - ETA: 0s - loss: 3.1220 - accuracy: 0.950011/12 [==========================>...] - ETA: 0s - loss: 3.1019 - accuracy: 0.951712/12 [==============================] - ETA: 0s - loss: 3.0975 - accuracy: 0.9528Epoch 5 took 3.35 seconds
12/12 [==============================] - 3s 279ms/step - loss: 3.0975 - accuracy: 0.9528 - val_loss: 6.7265 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 36.35%, Peak: 47.95%, Min: 5.50%
  Memory Usage - Avg: 965.34 MB, Peak: 1007.30 MB, Min: 687.22 MB
  Available Memory - Avg: 2959.35 MB, Peak: 3498.29 MB, Min: 2876.56 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
