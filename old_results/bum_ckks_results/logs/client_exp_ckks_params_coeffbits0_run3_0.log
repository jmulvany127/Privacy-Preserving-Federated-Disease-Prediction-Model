2025-04-15 12:52:54.104970: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:52:54.106577: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:52:54.147564: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:52:54.148225: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:52:54.854027: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 17s - loss: 6.2507 - accuracy: 0.6562 2/12 [====>.........................] - ETA: 2s - loss: 9.3858 - accuracy: 0.4219  3/12 [======>.......................] - ETA: 2s - loss: 7.9707 - accuracy: 0.5312 4/12 [=========>....................] - ETA: 1s - loss: 7.3213 - accuracy: 0.6094 5/12 [===========>..................] - ETA: 1s - loss: 7.2275 - accuracy: 0.6438 6/12 [==============>...............] - ETA: 1s - loss: 6.8763 - accuracy: 0.6771 7/12 [================>.............] - ETA: 1s - loss: 6.8071 - accuracy: 0.6964 8/12 [===================>..........] - ETA: 0s - loss: 6.7365 - accuracy: 0.7031 9/12 [=====================>........] - ETA: 0s - loss: 6.6450 - accuracy: 0.701410/12 [========================>.....] - ETA: 0s - loss: 6.5064 - accuracy: 0.703111/12 [==========================>...] - ETA: 0s - loss: 6.3619 - accuracy: 0.704512/12 [==============================] - ETA: 0s - loss: 6.3240 - accuracy: 0.7083Epoch 1 took 4.36 seconds
12/12 [==============================] - 4s 250ms/step - loss: 6.3240 - accuracy: 0.7083 - val_loss: 4.5865 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.9752 - accuracy: 0.7500 2/12 [====>.........................] - ETA: 2s - loss: 4.8539 - accuracy: 0.7812 3/12 [======>.......................] - ETA: 1s - loss: 4.9801 - accuracy: 0.7708 4/12 [=========>....................] - ETA: 1s - loss: 4.8929 - accuracy: 0.7891 5/12 [===========>..................] - ETA: 1s - loss: 4.8080 - accuracy: 0.8062 6/12 [==============>...............] - ETA: 1s - loss: 4.7940 - accuracy: 0.8021 7/12 [================>.............] - ETA: 1s - loss: 4.7391 - accuracy: 0.8125 8/12 [===================>..........] - ETA: 0s - loss: 4.6495 - accuracy: 0.8242 9/12 [=====================>........] - ETA: 0s - loss: 4.6343 - accuracy: 0.816010/12 [========================>.....] - ETA: 0s - loss: 4.5742 - accuracy: 0.821911/12 [==========================>...] - ETA: 0s - loss: 4.5112 - accuracy: 0.829512/12 [==============================] - ETA: 0s - loss: 4.4942 - accuracy: 0.8333Epoch 2 took 2.60 seconds
12/12 [==============================] - 3s 220ms/step - loss: 4.4942 - accuracy: 0.8333 - val_loss: 4.1371 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.0213 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 3s - loss: 3.9778 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 2s - loss: 4.0266 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 2s - loss: 4.0287 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 2s - loss: 3.9881 - accuracy: 0.8687 6/12 [==============>...............] - ETA: 1s - loss: 3.9736 - accuracy: 0.8802 7/12 [================>.............] - ETA: 1s - loss: 3.9277 - accuracy: 0.8884 8/12 [===================>..........] - ETA: 1s - loss: 3.9320 - accuracy: 0.8867 9/12 [=====================>........] - ETA: 0s - loss: 3.9402 - accuracy: 0.878510/12 [========================>.....] - ETA: 0s - loss: 3.9283 - accuracy: 0.887511/12 [==========================>...] - ETA: 0s - loss: 3.9386 - accuracy: 0.886412/12 [==============================] - ETA: 0s - loss: 3.9335 - accuracy: 0.8861Epoch 3 took 3.76 seconds
12/12 [==============================] - 4s 319ms/step - loss: 3.9335 - accuracy: 0.8861 - val_loss: 3.9911 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.4399 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.5119 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 3.5668 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 2s - loss: 3.5556 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 2s - loss: 3.5203 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.5746 - accuracy: 0.8958 7/12 [================>.............] - ETA: 1s - loss: 3.5569 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 1s - loss: 3.5144 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 1s - loss: 3.5052 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.5020 - accuracy: 0.912511/12 [==========================>...] - ETA: 0s - loss: 3.4770 - accuracy: 0.914812/12 [==============================] - ETA: 0s - loss: 3.4701 - accuracy: 0.9167Epoch 4 took 3.85 seconds
12/12 [==============================] - 4s 321ms/step - loss: 3.4701 - accuracy: 0.9167 - val_loss: 3.7661 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.1272 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.1948 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.1790 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.2077 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 3.1786 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.1762 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.1565 - accuracy: 0.9330 8/12 [===================>..........] - ETA: 1s - loss: 3.1381 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 3.1604 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 3.1625 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 3.1530 - accuracy: 0.931812/12 [==============================] - ETA: 0s - loss: 3.1475 - accuracy: 0.9333Epoch 5 took 3.57 seconds
12/12 [==============================] - 4s 300ms/step - loss: 3.1475 - accuracy: 0.9333 - val_loss: 3.4894 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 41.86%, Peak: 48.73%, Min: 6.25%
  Memory Usage - Avg: 966.51 MB, Peak: 1003.91 MB, Min: 684.81 MB
  Available Memory - Avg: 2955.65 MB, Peak: 3523.92 MB, Min: 2870.58 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
