2025-04-15 08:23:12.153941: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:23:12.156139: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:23:12.193153: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:23:12.193566: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:23:12.824983: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 5.9852 - accuracy: 0.5000 2/12 [====>.........................] - ETA: 1s - loss: 7.0122 - accuracy: 0.6250  3/12 [======>.......................] - ETA: 1s - loss: 7.6641 - accuracy: 0.6667 4/12 [=========>....................] - ETA: 1s - loss: 7.3295 - accuracy: 0.6562 5/12 [===========>..................] - ETA: 1s - loss: 6.8056 - accuracy: 0.7000 6/12 [==============>...............] - ETA: 1s - loss: 6.4847 - accuracy: 0.7344 7/12 [================>.............] - ETA: 0s - loss: 6.3022 - accuracy: 0.7411 8/12 [===================>..........] - ETA: 0s - loss: 6.1828 - accuracy: 0.7266 9/12 [=====================>........] - ETA: 0s - loss: 6.0193 - accuracy: 0.736110/12 [========================>.....] - ETA: 0s - loss: 5.9330 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.8060 - accuracy: 0.747212/12 [==============================] - ETA: 0s - loss: 5.7795 - accuracy: 0.7500Epoch 1 took 3.88 seconds
12/12 [==============================] - 4s 222ms/step - loss: 5.7795 - accuracy: 0.7500 - val_loss: 4.6768 - val_accuracy: 0.4500
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.5347 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 4.3777 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 4.4459 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 1s - loss: 4.3863 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.2956 - accuracy: 0.8875 6/12 [==============>...............] - ETA: 1s - loss: 4.3638 - accuracy: 0.8854 7/12 [================>.............] - ETA: 1s - loss: 4.3576 - accuracy: 0.8839 8/12 [===================>..........] - ETA: 0s - loss: 4.3605 - accuracy: 0.8789 9/12 [=====================>........] - ETA: 0s - loss: 4.3544 - accuracy: 0.881910/12 [========================>.....] - ETA: 0s - loss: 4.3191 - accuracy: 0.890611/12 [==========================>...] - ETA: 0s - loss: 4.3193 - accuracy: 0.877812/12 [==============================] - ETA: 0s - loss: 4.3352 - accuracy: 0.8750Epoch 2 took 2.63 seconds
12/12 [==============================] - 3s 217ms/step - loss: 4.3352 - accuracy: 0.8750 - val_loss: 4.2093 - val_accuracy: 0.8500
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 3.7869 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.7816 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 1s - loss: 3.7801 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.8446 - accuracy: 0.8906 5/12 [===========>..................] - ETA: 1s - loss: 3.8376 - accuracy: 0.8813 6/12 [==============>...............] - ETA: 1s - loss: 3.8399 - accuracy: 0.8750 7/12 [================>.............] - ETA: 1s - loss: 3.8344 - accuracy: 0.8795 8/12 [===================>..........] - ETA: 0s - loss: 3.8348 - accuracy: 0.8867 9/12 [=====================>........] - ETA: 0s - loss: 3.8799 - accuracy: 0.881910/12 [========================>.....] - ETA: 0s - loss: 3.8419 - accuracy: 0.887511/12 [==========================>...] - ETA: 0s - loss: 3.8207 - accuracy: 0.892012/12 [==============================] - ETA: 0s - loss: 3.8116 - accuracy: 0.8944Epoch 3 took 2.66 seconds
12/12 [==============================] - 3s 212ms/step - loss: 3.8116 - accuracy: 0.8944 - val_loss: 3.7517 - val_accuracy: 0.8250
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.9500 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 3.9185 - accuracy: 0.8438 3/12 [======>.......................] - ETA: 2s - loss: 3.7572 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 2s - loss: 3.7147 - accuracy: 0.8828 5/12 [===========>..................] - ETA: 2s - loss: 3.6817 - accuracy: 0.8813 6/12 [==============>...............] - ETA: 1s - loss: 3.6269 - accuracy: 0.8906 7/12 [================>.............] - ETA: 1s - loss: 3.5981 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 1s - loss: 3.5843 - accuracy: 0.9023 9/12 [=====================>........] - ETA: 0s - loss: 3.5418 - accuracy: 0.909710/12 [========================>.....] - ETA: 0s - loss: 3.5482 - accuracy: 0.909411/12 [==========================>...] - ETA: 0s - loss: 3.5218 - accuracy: 0.911912/12 [==============================] - ETA: 0s - loss: 3.5162 - accuracy: 0.9111Epoch 4 took 3.85 seconds
12/12 [==============================] - 4s 322ms/step - loss: 3.5162 - accuracy: 0.9111 - val_loss: 3.7641 - val_accuracy: 0.6500
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.1503 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 4s - loss: 3.2136 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 3s - loss: 3.1971 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 2s - loss: 3.1824 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 3.1787 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 2s - loss: 3.1698 - accuracy: 0.9167 7/12 [================>.............] - ETA: 1s - loss: 3.1807 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 1s - loss: 3.1465 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 1s - loss: 3.1264 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 3.1127 - accuracy: 0.934411/12 [==========================>...] - ETA: 0s - loss: 3.1088 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 3.1024 - accuracy: 0.9361Epoch 5 took 4.23 seconds
12/12 [==============================] - 4s 356ms/step - loss: 3.1024 - accuracy: 0.9361 - val_loss: 4.1895 - val_accuracy: 0.6250
Round Complete.
  CPU Usage - Avg: 41.66%, Peak: 47.45%, Min: 19.98%
  Memory Usage - Avg: 953.27 MB, Peak: 995.17 MB, Min: 659.40 MB
  Available Memory - Avg: 2956.70 MB, Peak: 3501.05 MB, Min: 2872.38 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
