2025-04-15 12:57:05.564467: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:57:05.566768: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:57:05.610758: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:57:05.611273: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:57:06.291785: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 5.5049 - accuracy: 0.4375 2/12 [====>.........................] - ETA: 1s - loss: 6.0210 - accuracy: 0.6562  3/12 [======>.......................] - ETA: 1s - loss: 7.9949 - accuracy: 0.6979 4/12 [=========>....................] - ETA: 1s - loss: 7.4871 - accuracy: 0.7422 5/12 [===========>..................] - ETA: 1s - loss: 7.0472 - accuracy: 0.7812 6/12 [==============>...............] - ETA: 1s - loss: 6.8787 - accuracy: 0.7917 7/12 [================>.............] - ETA: 1s - loss: 6.7394 - accuracy: 0.7812 8/12 [===================>..........] - ETA: 0s - loss: 6.5527 - accuracy: 0.7656 9/12 [=====================>........] - ETA: 0s - loss: 6.3253 - accuracy: 0.763910/12 [========================>.....] - ETA: 0s - loss: 6.2749 - accuracy: 0.743711/12 [==========================>...] - ETA: 0s - loss: 6.1315 - accuracy: 0.741512/12 [==============================] - ETA: 0s - loss: 6.0857 - accuracy: 0.7472Epoch 1 took 4.82 seconds
12/12 [==============================] - 5s 303ms/step - loss: 6.0857 - accuracy: 0.7472 - val_loss: 4.5909 - val_accuracy: 0.7000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.6124 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 2s - loss: 4.3768 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 2s - loss: 4.3522 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 2s - loss: 4.2705 - accuracy: 0.8906 5/12 [===========>..................] - ETA: 2s - loss: 4.2950 - accuracy: 0.8687 6/12 [==============>...............] - ETA: 1s - loss: 4.3466 - accuracy: 0.8594 7/12 [================>.............] - ETA: 1s - loss: 4.4916 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 1s - loss: 4.4522 - accuracy: 0.8516 9/12 [=====================>........] - ETA: 0s - loss: 4.3919 - accuracy: 0.857610/12 [========================>.....] - ETA: 0s - loss: 4.3706 - accuracy: 0.859411/12 [==========================>...] - ETA: 0s - loss: 4.3382 - accuracy: 0.860812/12 [==============================] - ETA: 0s - loss: 4.3238 - accuracy: 0.8639Epoch 2 took 3.16 seconds
12/12 [==============================] - 3s 265ms/step - loss: 4.3238 - accuracy: 0.8639 - val_loss: 4.9677 - val_accuracy: 0.2250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1633 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.9891 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 3.9649 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 1s - loss: 3.9474 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 3.9226 - accuracy: 0.8562 6/12 [==============>...............] - ETA: 1s - loss: 3.9313 - accuracy: 0.8542 7/12 [================>.............] - ETA: 1s - loss: 3.8749 - accuracy: 0.8750 8/12 [===================>..........] - ETA: 0s - loss: 3.8478 - accuracy: 0.8828 9/12 [=====================>........] - ETA: 0s - loss: 3.8072 - accuracy: 0.888910/12 [========================>.....] - ETA: 0s - loss: 3.7874 - accuracy: 0.890611/12 [==========================>...] - ETA: 0s - loss: 3.7765 - accuracy: 0.883512/12 [==============================] - ETA: 0s - loss: 3.7772 - accuracy: 0.8806Epoch 3 took 2.46 seconds
12/12 [==============================] - 2s 207ms/step - loss: 3.7772 - accuracy: 0.8806 - val_loss: 4.9764 - val_accuracy: 0.5250
Epoch 4/5
 1/12 [=>............................] - ETA: 1s - loss: 3.3998 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.4386 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 1s - loss: 3.4421 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 1s - loss: 3.4271 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.4222 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 1s - loss: 3.3827 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.3975 - accuracy: 0.9152 8/12 [===================>..........] - ETA: 1s - loss: 3.3869 - accuracy: 0.9102 9/12 [=====================>........] - ETA: 0s - loss: 3.3662 - accuracy: 0.920110/12 [========================>.....] - ETA: 0s - loss: 3.3408 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 3.3419 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.3395 - accuracy: 0.9250Epoch 4 took 3.05 seconds
12/12 [==============================] - 3s 261ms/step - loss: 3.3395 - accuracy: 0.9250 - val_loss: 9.7005 - val_accuracy: 0.2250
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.1019 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.1312 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.2459 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 2s - loss: 3.2248 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 2s - loss: 3.1690 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 3.1449 - accuracy: 0.9062 7/12 [================>.............] - ETA: 1s - loss: 3.1164 - accuracy: 0.9152 8/12 [===================>..........] - ETA: 1s - loss: 3.1054 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.1031 - accuracy: 0.906210/12 [========================>.....] - ETA: 0s - loss: 3.0784 - accuracy: 0.906211/12 [==========================>...] - ETA: 0s - loss: 3.0642 - accuracy: 0.911912/12 [==============================] - ETA: 0s - loss: 3.0570 - accuracy: 0.9139Epoch 5 took 3.41 seconds
12/12 [==============================] - 3s 287ms/step - loss: 3.0570 - accuracy: 0.9139 - val_loss: 14.5512 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 29.63%, Peak: 46.95%, Min: 0.00%
  Memory Usage - Avg: 973.56 MB, Peak: 1007.10 MB, Min: 686.27 MB
  Available Memory - Avg: 3044.23 MB, Peak: 3601.65 MB, Min: 2873.79 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
