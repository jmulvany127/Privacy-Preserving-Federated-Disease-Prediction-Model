2025-04-15 13:01:19.234921: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 13:01:19.236671: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:01:19.272353: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:01:19.272753: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 13:01:19.858408: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 6.6253 - accuracy: 0.3750 2/12 [====>.........................] - ETA: 2s - loss: 5.9369 - accuracy: 0.6719  3/12 [======>.......................] - ETA: 1s - loss: 6.2906 - accuracy: 0.7188 4/12 [=========>....................] - ETA: 1s - loss: 6.6553 - accuracy: 0.7344 5/12 [===========>..................] - ETA: 1s - loss: 6.6198 - accuracy: 0.7188 6/12 [==============>...............] - ETA: 1s - loss: 6.2989 - accuracy: 0.7448 7/12 [================>.............] - ETA: 1s - loss: 6.3196 - accuracy: 0.7232 8/12 [===================>..........] - ETA: 0s - loss: 6.2197 - accuracy: 0.7188 9/12 [=====================>........] - ETA: 0s - loss: 6.0433 - accuracy: 0.722210/12 [========================>.....] - ETA: 0s - loss: 5.8850 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.8509 - accuracy: 0.741512/12 [==============================] - ETA: 0s - loss: 5.8188 - accuracy: 0.7444Epoch 1 took 3.80 seconds
12/12 [==============================] - 4s 219ms/step - loss: 5.8188 - accuracy: 0.7444 - val_loss: 4.4400 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 5.9773 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 1s - loss: 5.0690 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 4.8422 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 1s - loss: 4.6421 - accuracy: 0.8828 5/12 [===========>..................] - ETA: 1s - loss: 4.7430 - accuracy: 0.8625 6/12 [==============>...............] - ETA: 1s - loss: 4.6249 - accuracy: 0.8750 7/12 [================>.............] - ETA: 0s - loss: 4.5732 - accuracy: 0.8571 8/12 [===================>..........] - ETA: 0s - loss: 4.5041 - accuracy: 0.8672 9/12 [=====================>........] - ETA: 0s - loss: 4.4712 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 4.4355 - accuracy: 0.875011/12 [==========================>...] - ETA: 0s - loss: 4.4146 - accuracy: 0.872212/12 [==============================] - ETA: 0s - loss: 4.4143 - accuracy: 0.8722Epoch 2 took 2.29 seconds
12/12 [==============================] - 2s 188ms/step - loss: 4.4143 - accuracy: 0.8722 - val_loss: 4.2443 - val_accuracy: 0.6750
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1818 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 1s - loss: 4.5045 - accuracy: 0.7812 3/12 [======>.......................] - ETA: 1s - loss: 4.5493 - accuracy: 0.8021 4/12 [=========>....................] - ETA: 1s - loss: 4.4530 - accuracy: 0.8281 5/12 [===========>..................] - ETA: 1s - loss: 4.3359 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 1s - loss: 4.3951 - accuracy: 0.8490 7/12 [================>.............] - ETA: 0s - loss: 4.3819 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 0s - loss: 4.4190 - accuracy: 0.8398 9/12 [=====================>........] - ETA: 0s - loss: 4.3983 - accuracy: 0.829910/12 [========================>.....] - ETA: 0s - loss: 4.3154 - accuracy: 0.840611/12 [==========================>...] - ETA: 0s - loss: 4.3243 - accuracy: 0.829512/12 [==============================] - ETA: 0s - loss: 4.3076 - accuracy: 0.8333Epoch 3 took 2.30 seconds
12/12 [==============================] - 2s 190ms/step - loss: 4.3076 - accuracy: 0.8333 - val_loss: 5.0515 - val_accuracy: 0.2000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 4.2725 - accuracy: 0.7188 2/12 [====>.........................] - ETA: 2s - loss: 3.9870 - accuracy: 0.7812 3/12 [======>.......................] - ETA: 1s - loss: 3.9513 - accuracy: 0.7917 4/12 [=========>....................] - ETA: 1s - loss: 3.8298 - accuracy: 0.8359 5/12 [===========>..................] - ETA: 1s - loss: 3.7914 - accuracy: 0.8562 6/12 [==============>...............] - ETA: 1s - loss: 3.7362 - accuracy: 0.8646 7/12 [================>.............] - ETA: 1s - loss: 3.7343 - accuracy: 0.8571 8/12 [===================>..........] - ETA: 0s - loss: 3.7294 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 0s - loss: 3.7543 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 3.7201 - accuracy: 0.871911/12 [==========================>...] - ETA: 0s - loss: 3.6909 - accuracy: 0.875012/12 [==============================] - ETA: 0s - loss: 3.6800 - accuracy: 0.8778Epoch 4 took 2.58 seconds
12/12 [==============================] - 3s 215ms/step - loss: 3.6800 - accuracy: 0.8778 - val_loss: 6.0816 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.4429 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.3917 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 2s - loss: 3.3799 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 2s - loss: 3.3524 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 3.3504 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 3.3116 - accuracy: 0.9167 7/12 [================>.............] - ETA: 1s - loss: 3.2877 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 1s - loss: 3.2611 - accuracy: 0.9258 9/12 [=====================>........] - ETA: 0s - loss: 3.2563 - accuracy: 0.913210/12 [========================>.....] - ETA: 0s - loss: 3.2316 - accuracy: 0.918711/12 [==========================>...] - ETA: 0s - loss: 3.2264 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.2194 - accuracy: 0.9194Epoch 5 took 3.58 seconds
12/12 [==============================] - 4s 298ms/step - loss: 3.2194 - accuracy: 0.9194 - val_loss: 7.9301 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 42.40%, Peak: 48.45%, Min: 25.23%
  Memory Usage - Avg: 956.90 MB, Peak: 1003.96 MB, Min: 685.03 MB
  Available Memory - Avg: 2969.20 MB, Peak: 3481.28 MB, Min: 2880.39 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
