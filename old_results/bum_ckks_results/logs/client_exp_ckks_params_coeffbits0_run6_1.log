2025-04-15 12:59:14.953705: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:59:14.955510: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:59:15.002881: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:59:15.003310: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:59:15.637200: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 6.2527 - accuracy: 0.5312 2/12 [====>.........................] - ETA: 1s - loss: 6.5807 - accuracy: 0.6719  3/12 [======>.......................] - ETA: 1s - loss: 6.7549 - accuracy: 0.6979 4/12 [=========>....................] - ETA: 2s - loss: 6.4148 - accuracy: 0.6875 5/12 [===========>..................] - ETA: 1s - loss: 6.4759 - accuracy: 0.6812 6/12 [==============>...............] - ETA: 1s - loss: 6.1477 - accuracy: 0.7083 7/12 [================>.............] - ETA: 1s - loss: 5.9277 - accuracy: 0.7366 8/12 [===================>..........] - ETA: 0s - loss: 5.8029 - accuracy: 0.7539 9/12 [=====================>........] - ETA: 0s - loss: 5.7226 - accuracy: 0.767410/12 [========================>.....] - ETA: 0s - loss: 5.6232 - accuracy: 0.778111/12 [==========================>...] - ETA: 0s - loss: 5.6001 - accuracy: 0.778412/12 [==============================] - ETA: 0s - loss: 5.5887 - accuracy: 0.7806Epoch 1 took 4.16 seconds
12/12 [==============================] - 4s 251ms/step - loss: 5.5887 - accuracy: 0.7806 - val_loss: 4.4491 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.3471 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 4.3671 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 4.4556 - accuracy: 0.8438 4/12 [=========>....................] - ETA: 1s - loss: 4.3611 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.3818 - accuracy: 0.8562 6/12 [==============>...............] - ETA: 1s - loss: 4.4096 - accuracy: 0.8594 7/12 [================>.............] - ETA: 1s - loss: 4.3823 - accuracy: 0.8438 8/12 [===================>..........] - ETA: 0s - loss: 4.3365 - accuracy: 0.8516 9/12 [=====================>........] - ETA: 0s - loss: 4.2751 - accuracy: 0.864610/12 [========================>.....] - ETA: 0s - loss: 4.2666 - accuracy: 0.871911/12 [==========================>...] - ETA: 0s - loss: 4.2801 - accuracy: 0.869312/12 [==============================] - ETA: 0s - loss: 4.2689 - accuracy: 0.8694Epoch 2 took 2.56 seconds
12/12 [==============================] - 3s 211ms/step - loss: 4.2689 - accuracy: 0.8694 - val_loss: 4.1366 - val_accuracy: 0.7750
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.5129 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 2s - loss: 4.4739 - accuracy: 0.7969 3/12 [======>.......................] - ETA: 1s - loss: 4.2817 - accuracy: 0.8229 4/12 [=========>....................] - ETA: 1s - loss: 4.1047 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.0024 - accuracy: 0.8813 6/12 [==============>...............] - ETA: 1s - loss: 3.9408 - accuracy: 0.8802 7/12 [================>.............] - ETA: 1s - loss: 3.9202 - accuracy: 0.8661 8/12 [===================>..........] - ETA: 0s - loss: 3.8808 - accuracy: 0.8750 9/12 [=====================>........] - ETA: 0s - loss: 3.8453 - accuracy: 0.881910/12 [========================>.....] - ETA: 0s - loss: 3.8051 - accuracy: 0.887511/12 [==========================>...] - ETA: 0s - loss: 3.7780 - accuracy: 0.886412/12 [==============================] - ETA: 0s - loss: 3.7671 - accuracy: 0.8889Epoch 3 took 2.55 seconds
12/12 [==============================] - 3s 213ms/step - loss: 3.7671 - accuracy: 0.8889 - val_loss: 3.9524 - val_accuracy: 0.5750
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.7103 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 1s - loss: 3.5620 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 3.4447 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.4250 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 1s - loss: 3.4301 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 3.3763 - accuracy: 0.9219 7/12 [================>.............] - ETA: 1s - loss: 3.3463 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 0s - loss: 3.3499 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.3739 - accuracy: 0.909710/12 [========================>.....] - ETA: 0s - loss: 3.3544 - accuracy: 0.909411/12 [==========================>...] - ETA: 0s - loss: 3.3397 - accuracy: 0.909112/12 [==============================] - ETA: 0s - loss: 3.3316 - accuracy: 0.9111Epoch 4 took 2.58 seconds
12/12 [==============================] - 3s 215ms/step - loss: 3.3316 - accuracy: 0.9111 - val_loss: 3.6298 - val_accuracy: 0.5750
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 2.9722 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 2.9922 - accuracy: 0.9844 3/12 [======>.......................] - ETA: 2s - loss: 2.9671 - accuracy: 0.9792 4/12 [=========>....................] - ETA: 2s - loss: 3.0571 - accuracy: 0.9688 5/12 [===========>..................] - ETA: 2s - loss: 3.0776 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.0660 - accuracy: 0.9531 7/12 [================>.............] - ETA: 1s - loss: 3.0838 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 1s - loss: 3.0959 - accuracy: 0.9336 9/12 [=====================>........] - ETA: 0s - loss: 3.1318 - accuracy: 0.920110/12 [========================>.....] - ETA: 0s - loss: 3.1089 - accuracy: 0.921911/12 [==========================>...] - ETA: 0s - loss: 3.0891 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.0859 - accuracy: 0.9194Epoch 5 took 3.48 seconds
12/12 [==============================] - 3s 290ms/step - loss: 3.0859 - accuracy: 0.9194 - val_loss: 3.5153 - val_accuracy: 0.5750
Round Complete.
  CPU Usage - Avg: 41.86%, Peak: 47.95%, Min: 19.73%
  Memory Usage - Avg: 958.90 MB, Peak: 1007.19 MB, Min: 683.02 MB
  Available Memory - Avg: 2967.99 MB, Peak: 3512.61 MB, Min: 2873.64 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
