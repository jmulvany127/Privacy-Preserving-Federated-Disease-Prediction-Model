2025-04-14 21:44:58.982892: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-14 21:44:58.984743: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:44:59.027556: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:44:59.028490: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-14 21:44:59.911093: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 44s - loss: 6.1385 - accuracy: 0.3438 2/12 [====>.........................] - ETA: 5s - loss: 7.4288 - accuracy: 0.5469  3/12 [======>.......................] - ETA: 4s - loss: 6.9753 - accuracy: 0.6562 4/12 [=========>....................] - ETA: 4s - loss: 6.5591 - accuracy: 0.6875 5/12 [===========>..................] - ETA: 3s - loss: 6.2999 - accuracy: 0.6812 6/12 [==============>...............] - ETA: 3s - loss: 6.0521 - accuracy: 0.7083 7/12 [================>.............] - ETA: 2s - loss: 5.9136 - accuracy: 0.7143 8/12 [===================>..........] - ETA: 2s - loss: 5.8129 - accuracy: 0.7148 9/12 [=====================>........] - ETA: 1s - loss: 5.6913 - accuracy: 0.729210/12 [========================>.....] - ETA: 1s - loss: 5.5866 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.5339 - accuracy: 0.747212/12 [==============================] - ETA: 0s - loss: 5.5314 - accuracy: 0.7500Epoch 1 took 11.05 seconds
12/12 [==============================] - 11s 640ms/step - loss: 5.5314 - accuracy: 0.7500 - val_loss: 5.0070 - val_accuracy: 0.2000
Epoch 2/5
 1/12 [=>............................] - ETA: 3s - loss: 4.2569 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 4.2266 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 4.2682 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 2s - loss: 4.2897 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 2s - loss: 4.3559 - accuracy: 0.8625 6/12 [==============>...............] - ETA: 2s - loss: 4.3738 - accuracy: 0.8594 7/12 [================>.............] - ETA: 1s - loss: 4.3219 - accuracy: 0.8661 8/12 [===================>..........] - ETA: 1s - loss: 4.2642 - accuracy: 0.8789 9/12 [=====================>........] - ETA: 1s - loss: 4.2371 - accuracy: 0.878510/12 [========================>.....] - ETA: 0s - loss: 4.2313 - accuracy: 0.878111/12 [==========================>...] - ETA: 0s - loss: 4.2719 - accuracy: 0.872212/12 [==============================] - ETA: 0s - loss: 4.3013 - accuracy: 0.8694Epoch 2 took 4.14 seconds
12/12 [==============================] - 4s 351ms/step - loss: 4.3013 - accuracy: 0.8694 - val_loss: 4.7246 - val_accuracy: 0.2000
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 3.6721 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 3s - loss: 3.7282 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.8192 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 2s - loss: 3.8129 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 2s - loss: 3.7775 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 3.7817 - accuracy: 0.9062 7/12 [================>.............] - ETA: 1s - loss: 3.7461 - accuracy: 0.9152 8/12 [===================>..........] - ETA: 3s - loss: 3.7222 - accuracy: 0.9180 9/12 [=====================>........] - ETA: 2s - loss: 3.7075 - accuracy: 0.920110/12 [========================>.....] - ETA: 1s - loss: 3.7412 - accuracy: 0.906211/12 [==========================>...] - ETA: 0s - loss: 3.7123 - accuracy: 0.911912/12 [==============================] - ETA: 0s - loss: 3.7054 - accuracy: 0.9139Epoch 3 took 6.62 seconds
12/12 [==============================] - 7s 576ms/step - loss: 3.7054 - accuracy: 0.9139 - val_loss: 5.0423 - val_accuracy: 0.4250
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.4581 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.3556 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 3.3418 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 2s - loss: 3.3503 - accuracy: 0.9609 5/12 [===========>..................] - ETA: 1s - loss: 3.3214 - accuracy: 0.9563 6/12 [==============>...............] - ETA: 1s - loss: 3.3334 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 3.3084 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 1s - loss: 3.2873 - accuracy: 0.9570 9/12 [=====================>........] - ETA: 0s - loss: 3.3280 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.3235 - accuracy: 0.934411/12 [==========================>...] - ETA: 0s - loss: 3.2979 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 3.2929 - accuracy: 0.9389Epoch 4 took 3.67 seconds
12/12 [==============================] - 4s 308ms/step - loss: 3.2929 - accuracy: 0.9389 - val_loss: 6.8023 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.1618 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.0930 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.1445 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 2s - loss: 3.0880 - accuracy: 0.9375 5/12 [===========>..................] - ETA: 1s - loss: 3.0543 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 3.0347 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 3.0346 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 3.0054 - accuracy: 0.9492 9/12 [=====================>........] - ETA: 0s - loss: 3.0021 - accuracy: 0.951410/12 [========================>.....] - ETA: 0s - loss: 2.9867 - accuracy: 0.950011/12 [==========================>...] - ETA: 0s - loss: 2.9880 - accuracy: 0.948912/12 [==============================] - ETA: 0s - loss: 2.9851 - accuracy: 0.9472Epoch 5 took 3.57 seconds
12/12 [==============================] - 4s 302ms/step - loss: 2.9851 - accuracy: 0.9472 - val_loss: 8.9955 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 28.19%, Peak: 52.70%, Min: 0.00%
  Memory Usage - Avg: 965.58 MB, Peak: 1000.21 MB, Min: 663.66 MB
  Available Memory - Avg: 2735.93 MB, Peak: 3201.40 MB, Min: 2452.10 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
