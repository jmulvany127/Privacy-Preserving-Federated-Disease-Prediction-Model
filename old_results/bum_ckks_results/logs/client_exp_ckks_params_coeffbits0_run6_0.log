2025-04-15 12:59:14.961628: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:59:14.963443: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:59:15.015879: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:59:15.016278: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:59:15.650961: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 5.6265 - accuracy: 0.5312 2/12 [====>.........................] - ETA: 2s - loss: 8.3096 - accuracy: 0.6250  3/12 [======>.......................] - ETA: 1s - loss: 7.4776 - accuracy: 0.7188 4/12 [=========>....................] - ETA: 2s - loss: 7.1125 - accuracy: 0.7422 5/12 [===========>..................] - ETA: 1s - loss: 6.8218 - accuracy: 0.7188 6/12 [==============>...............] - ETA: 1s - loss: 6.6635 - accuracy: 0.6979 7/12 [================>.............] - ETA: 1s - loss: 6.4036 - accuracy: 0.7143 8/12 [===================>..........] - ETA: 0s - loss: 6.3209 - accuracy: 0.6953 9/12 [=====================>........] - ETA: 0s - loss: 6.0936 - accuracy: 0.718810/12 [========================>.....] - ETA: 0s - loss: 5.9278 - accuracy: 0.734411/12 [==========================>...] - ETA: 0s - loss: 5.8570 - accuracy: 0.738612/12 [==============================] - ETA: 0s - loss: 5.8543 - accuracy: 0.7361Epoch 1 took 4.18 seconds
12/12 [==============================] - 4s 250ms/step - loss: 5.8543 - accuracy: 0.7361 - val_loss: 4.5179 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.8792 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 4.6890 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 4.6317 - accuracy: 0.8333 4/12 [=========>....................] - ETA: 1s - loss: 4.5669 - accuracy: 0.8203 5/12 [===========>..................] - ETA: 1s - loss: 4.6212 - accuracy: 0.8125 6/12 [==============>...............] - ETA: 1s - loss: 4.5102 - accuracy: 0.8333 7/12 [================>.............] - ETA: 1s - loss: 4.5419 - accuracy: 0.8259 8/12 [===================>..........] - ETA: 0s - loss: 4.5277 - accuracy: 0.8242 9/12 [=====================>........] - ETA: 0s - loss: 4.4729 - accuracy: 0.826410/12 [========================>.....] - ETA: 0s - loss: 4.4426 - accuracy: 0.831311/12 [==========================>...] - ETA: 0s - loss: 4.4011 - accuracy: 0.832412/12 [==============================] - ETA: 0s - loss: 4.3841 - accuracy: 0.8361Epoch 2 took 2.50 seconds
12/12 [==============================] - 2s 208ms/step - loss: 4.3841 - accuracy: 0.8361 - val_loss: 4.0356 - val_accuracy: 0.8500
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.4679 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 1s - loss: 4.1360 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 4.0319 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 3.9852 - accuracy: 0.8906 5/12 [===========>..................] - ETA: 1s - loss: 3.9933 - accuracy: 0.8813 6/12 [==============>...............] - ETA: 1s - loss: 3.9137 - accuracy: 0.8958 7/12 [================>.............] - ETA: 1s - loss: 3.9596 - accuracy: 0.8884 8/12 [===================>..........] - ETA: 0s - loss: 3.9351 - accuracy: 0.8945 9/12 [=====================>........] - ETA: 0s - loss: 3.8814 - accuracy: 0.902810/12 [========================>.....] - ETA: 0s - loss: 3.8452 - accuracy: 0.903111/12 [==========================>...] - ETA: 0s - loss: 3.8241 - accuracy: 0.897712/12 [==============================] - ETA: 0s - loss: 3.8169 - accuracy: 0.8972Epoch 3 took 2.46 seconds
12/12 [==============================] - 2s 204ms/step - loss: 3.8169 - accuracy: 0.8972 - val_loss: 3.9509 - val_accuracy: 0.6750
Epoch 4/5
 1/12 [=>............................] - ETA: 1s - loss: 3.4652 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 3.4362 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 3.5135 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 1s - loss: 3.4755 - accuracy: 0.8828 5/12 [===========>..................] - ETA: 1s - loss: 3.5463 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 1s - loss: 3.5548 - accuracy: 0.8594 7/12 [================>.............] - ETA: 0s - loss: 3.5236 - accuracy: 0.8661 8/12 [===================>..........] - ETA: 0s - loss: 3.5434 - accuracy: 0.8711 9/12 [=====================>........] - ETA: 0s - loss: 3.5201 - accuracy: 0.875010/12 [========================>.....] - ETA: 0s - loss: 3.5004 - accuracy: 0.871911/12 [==========================>...] - ETA: 0s - loss: 3.4900 - accuracy: 0.875012/12 [==============================] - ETA: 0s - loss: 3.4874 - accuracy: 0.8750Epoch 4 took 2.50 seconds
12/12 [==============================] - 2s 212ms/step - loss: 3.4874 - accuracy: 0.8750 - val_loss: 4.1796 - val_accuracy: 0.6250
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.4143 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.3049 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.3348 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 2s - loss: 3.3349 - accuracy: 0.8750 5/12 [===========>..................] - ETA: 2s - loss: 3.3427 - accuracy: 0.8625 6/12 [==============>...............] - ETA: 1s - loss: 3.2840 - accuracy: 0.8750 7/12 [================>.............] - ETA: 1s - loss: 3.2750 - accuracy: 0.8750 8/12 [===================>..........] - ETA: 1s - loss: 3.2733 - accuracy: 0.8750 9/12 [=====================>........] - ETA: 0s - loss: 3.2580 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 3.2439 - accuracy: 0.875011/12 [==========================>...] - ETA: 0s - loss: 3.2262 - accuracy: 0.877812/12 [==============================] - ETA: 0s - loss: 3.2153 - accuracy: 0.8806Epoch 5 took 3.56 seconds
12/12 [==============================] - 4s 301ms/step - loss: 3.2153 - accuracy: 0.8806 - val_loss: 4.9092 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 41.57%, Peak: 47.70%, Min: 9.75%
  Memory Usage - Avg: 961.38 MB, Peak: 1007.34 MB, Min: 687.95 MB
  Available Memory - Avg: 2966.18 MB, Peak: 3484.25 MB, Min: 2873.64 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
