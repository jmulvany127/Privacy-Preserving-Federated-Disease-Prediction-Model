2025-04-15 13:08:04.551955: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 13:08:04.553707: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:08:04.589873: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:08:04.590234: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 13:08:05.212280: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 6.3297 - accuracy: 0.4688 2/12 [====>.........................] - ETA: 1s - loss: 8.6939 - accuracy: 0.6094  3/12 [======>.......................] - ETA: 1s - loss: 8.4608 - accuracy: 0.6562 4/12 [=========>....................] - ETA: 1s - loss: 7.6661 - accuracy: 0.7109 5/12 [===========>..................] - ETA: 1s - loss: 7.1955 - accuracy: 0.7188 6/12 [==============>...............] - ETA: 1s - loss: 6.9583 - accuracy: 0.7031 7/12 [================>.............] - ETA: 0s - loss: 6.7518 - accuracy: 0.6741 8/12 [===================>..........] - ETA: 0s - loss: 6.5709 - accuracy: 0.6562 9/12 [=====================>........] - ETA: 0s - loss: 6.3806 - accuracy: 0.670110/12 [========================>.....] - ETA: 0s - loss: 6.2446 - accuracy: 0.671911/12 [==========================>...] - ETA: 0s - loss: 6.0921 - accuracy: 0.690312/12 [==============================] - ETA: 0s - loss: 6.0926 - accuracy: 0.6861Epoch 1 took 3.87 seconds
12/12 [==============================] - 4s 215ms/step - loss: 6.0926 - accuracy: 0.6861 - val_loss: 4.5032 - val_accuracy: 0.8500
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.2932 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 4.3642 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 4.4248 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 1s - loss: 4.4595 - accuracy: 0.8359 5/12 [===========>..................] - ETA: 1s - loss: 4.4515 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 1s - loss: 4.5113 - accuracy: 0.8333 7/12 [================>.............] - ETA: 0s - loss: 4.4667 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 0s - loss: 4.4805 - accuracy: 0.8438 9/12 [=====================>........] - ETA: 0s - loss: 4.4292 - accuracy: 0.850710/12 [========================>.....] - ETA: 0s - loss: 4.4324 - accuracy: 0.850011/12 [==========================>...] - ETA: 0s - loss: 4.4480 - accuracy: 0.849412/12 [==============================] - ETA: 0s - loss: 4.4411 - accuracy: 0.8500Epoch 2 took 2.25 seconds
12/12 [==============================] - 2s 186ms/step - loss: 4.4411 - accuracy: 0.8500 - val_loss: 4.1445 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1070 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 1s - loss: 3.9990 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 4.0052 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 1s - loss: 3.9964 - accuracy: 0.8672 5/12 [===========>..................] - ETA: 1s - loss: 3.9561 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 1s - loss: 3.9503 - accuracy: 0.8698 7/12 [================>.............] - ETA: 0s - loss: 3.9018 - accuracy: 0.8884 8/12 [===================>..........] - ETA: 0s - loss: 3.9556 - accuracy: 0.8789 9/12 [=====================>........] - ETA: 0s - loss: 3.9337 - accuracy: 0.885410/12 [========================>.....] - ETA: 0s - loss: 3.9061 - accuracy: 0.887511/12 [==========================>...] - ETA: 0s - loss: 3.9210 - accuracy: 0.880712/12 [==============================] - ETA: 0s - loss: 3.9126 - accuracy: 0.8833Epoch 3 took 2.26 seconds
12/12 [==============================] - 2s 188ms/step - loss: 3.9126 - accuracy: 0.8833 - val_loss: 3.7534 - val_accuracy: 0.8500
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6958 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.6938 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 2s - loss: 3.6169 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.5820 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.5786 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 1s - loss: 3.5761 - accuracy: 0.9115 7/12 [================>.............] - ETA: 1s - loss: 3.5460 - accuracy: 0.9152 8/12 [===================>..........] - ETA: 0s - loss: 3.5339 - accuracy: 0.9180 9/12 [=====================>........] - ETA: 0s - loss: 3.5158 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.4939 - accuracy: 0.921911/12 [==========================>...] - ETA: 0s - loss: 3.4910 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.4864 - accuracy: 0.9194Epoch 4 took 2.40 seconds
12/12 [==============================] - 2s 201ms/step - loss: 3.4864 - accuracy: 0.9194 - val_loss: 3.4660 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.2287 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.2087 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 3.1661 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 3.1823 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 3.1786 - accuracy: 0.9375 6/12 [==============>...............] - ETA: 1s - loss: 3.1477 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 3.1596 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 3.1389 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 0s - loss: 3.1309 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.1346 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 3.1266 - accuracy: 0.929012/12 [==============================] - ETA: 0s - loss: 3.1217 - accuracy: 0.9306Epoch 5 took 3.22 seconds
12/12 [==============================] - 3s 273ms/step - loss: 3.1217 - accuracy: 0.9306 - val_loss: 3.1998 - val_accuracy: 0.8250
Round Complete.
  CPU Usage - Avg: 40.76%, Peak: 47.95%, Min: 3.75%
  Memory Usage - Avg: 961.56 MB, Peak: 1011.76 MB, Min: 685.99 MB
  Available Memory - Avg: 2949.34 MB, Peak: 3480.12 MB, Min: 2849.48 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
