2025-04-15 08:25:18.734281: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:25:18.736337: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:25:18.776387: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:25:18.776791: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:25:19.377728: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 5.3164 - accuracy: 0.5938 2/12 [====>.........................] - ETA: 1s - loss: 6.2090 - accuracy: 0.6875  3/12 [======>.......................] - ETA: 1s - loss: 6.0582 - accuracy: 0.7083 4/12 [=========>....................] - ETA: 1s - loss: 5.9809 - accuracy: 0.7031 5/12 [===========>..................] - ETA: 1s - loss: 5.7838 - accuracy: 0.7188 6/12 [==============>...............] - ETA: 1s - loss: 5.6367 - accuracy: 0.7292 7/12 [================>.............] - ETA: 1s - loss: 5.6270 - accuracy: 0.7277 8/12 [===================>..........] - ETA: 0s - loss: 5.5157 - accuracy: 0.7305 9/12 [=====================>........] - ETA: 0s - loss: 5.4612 - accuracy: 0.739610/12 [========================>.....] - ETA: 0s - loss: 5.4538 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.3773 - accuracy: 0.741512/12 [==============================] - ETA: 0s - loss: 5.3604 - accuracy: 0.7444Epoch 1 took 3.81 seconds
12/12 [==============================] - 4s 222ms/step - loss: 5.3604 - accuracy: 0.7444 - val_loss: 4.3958 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.8960 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 1s - loss: 4.4819 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 4.8955 - accuracy: 0.8229 4/12 [=========>....................] - ETA: 1s - loss: 4.6774 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 1s - loss: 4.6476 - accuracy: 0.8438 6/12 [==============>...............] - ETA: 1s - loss: 4.6240 - accuracy: 0.8490 7/12 [================>.............] - ETA: 0s - loss: 4.5520 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 0s - loss: 4.5422 - accuracy: 0.8438 9/12 [=====================>........] - ETA: 0s - loss: 4.4873 - accuracy: 0.850710/12 [========================>.....] - ETA: 0s - loss: 4.4595 - accuracy: 0.846911/12 [==========================>...] - ETA: 0s - loss: 4.4095 - accuracy: 0.852312/12 [==============================] - ETA: 0s - loss: 4.4121 - accuracy: 0.8500Epoch 2 took 2.23 seconds
12/12 [==============================] - 2s 184ms/step - loss: 4.4121 - accuracy: 0.8500 - val_loss: 4.0935 - val_accuracy: 0.7750
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.8226 - accuracy: 0.6562 2/12 [====>.........................] - ETA: 1s - loss: 4.7587 - accuracy: 0.6875 3/12 [======>.......................] - ETA: 1s - loss: 4.4323 - accuracy: 0.7500 4/12 [=========>....................] - ETA: 1s - loss: 4.2210 - accuracy: 0.8047 5/12 [===========>..................] - ETA: 1s - loss: 4.3074 - accuracy: 0.8188 6/12 [==============>...............] - ETA: 1s - loss: 4.1872 - accuracy: 0.8438 7/12 [================>.............] - ETA: 0s - loss: 4.2087 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 0s - loss: 4.1939 - accuracy: 0.8477 9/12 [=====================>........] - ETA: 0s - loss: 4.2213 - accuracy: 0.843810/12 [========================>.....] - ETA: 0s - loss: 4.1423 - accuracy: 0.856211/12 [==========================>...] - ETA: 0s - loss: 4.1844 - accuracy: 0.855112/12 [==============================] - ETA: 0s - loss: 4.1653 - accuracy: 0.8583Epoch 3 took 2.32 seconds
12/12 [==============================] - 2s 192ms/step - loss: 4.1653 - accuracy: 0.8583 - val_loss: 4.1045 - val_accuracy: 0.6250
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.3864 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 3.3456 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 1s - loss: 3.3611 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 1s - loss: 3.3616 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 1s - loss: 3.4631 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.4457 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.4239 - accuracy: 0.9330 8/12 [===================>..........] - ETA: 0s - loss: 3.4108 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 3.4309 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 3.4080 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.3929 - accuracy: 0.931812/12 [==============================] - ETA: 0s - loss: 3.4209 - accuracy: 0.9278Epoch 4 took 2.55 seconds
12/12 [==============================] - 3s 214ms/step - loss: 3.4209 - accuracy: 0.9278 - val_loss: 4.8073 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.5118 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.3273 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.3090 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 2s - loss: 3.2969 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 2s - loss: 3.2501 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 1s - loss: 3.2235 - accuracy: 0.9115 7/12 [================>.............] - ETA: 1s - loss: 3.2153 - accuracy: 0.9107 8/12 [===================>..........] - ETA: 1s - loss: 3.2166 - accuracy: 0.9102 9/12 [=====================>........] - ETA: 0s - loss: 3.2007 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.1915 - accuracy: 0.921911/12 [==========================>...] - ETA: 0s - loss: 3.1667 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.1607 - accuracy: 0.9278Epoch 5 took 3.35 seconds
12/12 [==============================] - 3s 280ms/step - loss: 3.1607 - accuracy: 0.9278 - val_loss: 5.5799 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 40.94%, Peak: 47.70%, Min: 12.47%
  Memory Usage - Avg: 944.27 MB, Peak: 994.13 MB, Min: 662.08 MB
  Available Memory - Avg: 2960.78 MB, Peak: 3485.11 MB, Min: 2861.55 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
