2025-04-14 21:42:06.803712: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-14 21:42:06.809488: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:42:06.927481: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:42:06.929278: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-14 21:42:08.504799: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 36s - loss: 5.0407 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 3s - loss: 5.6281 - accuracy: 0.7344  3/12 [======>.......................] - ETA: 3s - loss: 5.5994 - accuracy: 0.7708 4/12 [=========>....................] - ETA: 2s - loss: 5.5730 - accuracy: 0.8125 5/12 [===========>..................] - ETA: 2s - loss: 5.5980 - accuracy: 0.8250 6/12 [==============>...............] - ETA: 2s - loss: 6.2553 - accuracy: 0.8125 7/12 [================>.............] - ETA: 1s - loss: 6.2201 - accuracy: 0.8170 8/12 [===================>..........] - ETA: 1s - loss: 5.9929 - accuracy: 0.8203 9/12 [=====================>........] - ETA: 1s - loss: 5.9189 - accuracy: 0.795110/12 [========================>.....] - ETA: 0s - loss: 5.9651 - accuracy: 0.781211/12 [==========================>...] - ETA: 0s - loss: 5.9831 - accuracy: 0.764212/12 [==============================] - ETA: 0s - loss: 5.9726 - accuracy: 0.7611Epoch 1 took 7.70 seconds
12/12 [==============================] - 8s 401ms/step - loss: 5.9726 - accuracy: 0.7611 - val_loss: 4.3790 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 5.3530 - accuracy: 0.7500 2/12 [====>.........................] - ETA: 2s - loss: 5.1894 - accuracy: 0.7969 3/12 [======>.......................] - ETA: 2s - loss: 5.4109 - accuracy: 0.7812 4/12 [=========>....................] - ETA: 1s - loss: 5.4786 - accuracy: 0.8047 5/12 [===========>..................] - ETA: 1s - loss: 5.3389 - accuracy: 0.8188 6/12 [==============>...............] - ETA: 1s - loss: 5.1745 - accuracy: 0.8229 7/12 [================>.............] - ETA: 1s - loss: 5.0891 - accuracy: 0.8259 8/12 [===================>..........] - ETA: 1s - loss: 5.0035 - accuracy: 0.8164 9/12 [=====================>........] - ETA: 0s - loss: 4.9866 - accuracy: 0.809010/12 [========================>.....] - ETA: 0s - loss: 4.9565 - accuracy: 0.812511/12 [==========================>...] - ETA: 0s - loss: 4.9243 - accuracy: 0.815312/12 [==============================] - ETA: 0s - loss: 4.9036 - accuracy: 0.8139Epoch 2 took 3.47 seconds
12/12 [==============================] - 3s 295ms/step - loss: 4.9036 - accuracy: 0.8139 - val_loss: 4.1775 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 4.5016 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 3s - loss: 4.3052 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 3s - loss: 4.2955 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 2s - loss: 4.1955 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 2s - loss: 4.1733 - accuracy: 0.8938 6/12 [==============>...............] - ETA: 5s - loss: 4.1569 - accuracy: 0.8802 7/12 [================>.............] - ETA: 4s - loss: 4.0993 - accuracy: 0.8795 8/12 [===================>..........] - ETA: 3s - loss: 4.0491 - accuracy: 0.8828 9/12 [=====================>........] - ETA: 2s - loss: 4.0874 - accuracy: 0.871510/12 [========================>.....] - ETA: 1s - loss: 4.0340 - accuracy: 0.881311/12 [==========================>...] - ETA: 0s - loss: 4.0000 - accuracy: 0.883512/12 [==============================] - ETA: 0s - loss: 3.9872 - accuracy: 0.8861Epoch 3 took 7.46 seconds
12/12 [==============================] - 7s 645ms/step - loss: 3.9872 - accuracy: 0.8861 - val_loss: 4.2262 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.8519 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 3.7471 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.6601 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.6233 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.6312 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.6494 - accuracy: 0.9167 7/12 [================>.............] - ETA: 1s - loss: 3.6003 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 1s - loss: 3.5739 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 0s - loss: 3.5463 - accuracy: 0.927110/12 [========================>.....] - ETA: 0s - loss: 3.5233 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.5496 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.5482 - accuracy: 0.9194Epoch 4 took 3.25 seconds
12/12 [==============================] - 3s 267ms/step - loss: 3.5482 - accuracy: 0.9194 - val_loss: 4.0071 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.1946 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.1821 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 3.2326 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 1s - loss: 3.2037 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 3.2373 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.2244 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 3.2031 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 1s - loss: 3.2106 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 0s - loss: 3.1922 - accuracy: 0.947910/12 [========================>.....] - ETA: 0s - loss: 3.1783 - accuracy: 0.950011/12 [==========================>...] - ETA: 0s - loss: 3.1780 - accuracy: 0.948912/12 [==============================] - ETA: 0s - loss: 3.1765 - accuracy: 0.9444Epoch 5 took 3.23 seconds
12/12 [==============================] - 3s 267ms/step - loss: 3.1765 - accuracy: 0.9444 - val_loss: 3.8745 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 23.76%, Peak: 51.62%, Min: 0.00%
  Memory Usage - Avg: 965.10 MB, Peak: 995.44 MB, Min: 656.14 MB
  Available Memory - Avg: 2882.97 MB, Peak: 3259.71 MB, Min: 2552.10 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
