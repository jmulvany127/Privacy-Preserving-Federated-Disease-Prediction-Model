2025-04-15 12:48:41.630563: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:48:41.632407: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:48:41.672653: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:48:41.673047: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:48:42.372550: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 20s - loss: 5.9178 - accuracy: 0.3125 2/12 [====>.........................] - ETA: 2s - loss: 5.7124 - accuracy: 0.5938  3/12 [======>.......................] - ETA: 2s - loss: 6.8123 - accuracy: 0.6562 4/12 [=========>....................] - ETA: 1s - loss: 6.3891 - accuracy: 0.7344 5/12 [===========>..................] - ETA: 1s - loss: 6.4237 - accuracy: 0.7437 6/12 [==============>...............] - ETA: 1s - loss: 6.2613 - accuracy: 0.7448 7/12 [================>.............] - ETA: 1s - loss: 6.1344 - accuracy: 0.7321 8/12 [===================>..........] - ETA: 0s - loss: 6.0579 - accuracy: 0.7266 9/12 [=====================>........] - ETA: 0s - loss: 5.9734 - accuracy: 0.715310/12 [========================>.....] - ETA: 0s - loss: 5.9109 - accuracy: 0.718811/12 [==========================>...] - ETA: 0s - loss: 5.7942 - accuracy: 0.727312/12 [==============================] - ETA: 0s - loss: 5.8359 - accuracy: 0.7250Epoch 1 took 4.52 seconds
12/12 [==============================] - 5s 240ms/step - loss: 5.8359 - accuracy: 0.7250 - val_loss: 4.4828 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.3987 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 4.3321 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 4.3346 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 4.2829 - accuracy: 0.8672 5/12 [===========>..................] - ETA: 1s - loss: 4.2514 - accuracy: 0.8562 6/12 [==============>...............] - ETA: 1s - loss: 4.2443 - accuracy: 0.8542 7/12 [================>.............] - ETA: 1s - loss: 4.2428 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 0s - loss: 4.2916 - accuracy: 0.8398 9/12 [=====================>........] - ETA: 0s - loss: 4.3183 - accuracy: 0.829910/12 [========================>.....] - ETA: 0s - loss: 4.2679 - accuracy: 0.840611/12 [==========================>...] - ETA: 0s - loss: 4.2761 - accuracy: 0.843812/12 [==============================] - ETA: 0s - loss: 4.2691 - accuracy: 0.8444Epoch 2 took 2.59 seconds
12/12 [==============================] - 3s 216ms/step - loss: 4.2691 - accuracy: 0.8444 - val_loss: 4.3270 - val_accuracy: 0.6250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.8784 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 4.0060 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 2s - loss: 3.9821 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 2s - loss: 3.9707 - accuracy: 0.8672 5/12 [===========>..................] - ETA: 1s - loss: 4.0163 - accuracy: 0.8438 6/12 [==============>...............] - ETA: 1s - loss: 3.9792 - accuracy: 0.8490 7/12 [================>.............] - ETA: 1s - loss: 3.9702 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 1s - loss: 3.9327 - accuracy: 0.8594 9/12 [=====================>........] - ETA: 0s - loss: 3.9068 - accuracy: 0.864610/12 [========================>.....] - ETA: 0s - loss: 3.8849 - accuracy: 0.871911/12 [==========================>...] - ETA: 0s - loss: 3.8544 - accuracy: 0.875012/12 [==============================] - ETA: 0s - loss: 3.8468 - accuracy: 0.8750Epoch 3 took 3.61 seconds
12/12 [==============================] - 4s 308ms/step - loss: 3.8468 - accuracy: 0.8750 - val_loss: 4.7182 - val_accuracy: 0.5250
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.6228 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 3s - loss: 3.6186 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 3s - loss: 3.5415 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.4835 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 2s - loss: 3.4736 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 2s - loss: 3.4736 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 3.4618 - accuracy: 0.9330 8/12 [===================>..........] - ETA: 1s - loss: 3.4859 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 1s - loss: 3.4753 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.4594 - accuracy: 0.921911/12 [==========================>...] - ETA: 0s - loss: 3.4449 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.4374 - accuracy: 0.9194Epoch 4 took 4.02 seconds
12/12 [==============================] - 4s 334ms/step - loss: 3.4374 - accuracy: 0.9194 - val_loss: 6.1206 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2689 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 3s - loss: 3.2405 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 3s - loss: 3.3484 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 2s - loss: 3.3340 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 2s - loss: 3.2760 - accuracy: 0.8813 6/12 [==============>...............] - ETA: 1s - loss: 3.2434 - accuracy: 0.8958 7/12 [================>.............] - ETA: 1s - loss: 3.2073 - accuracy: 0.9062 8/12 [===================>..........] - ETA: 1s - loss: 3.1742 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.1437 - accuracy: 0.923610/12 [========================>.....] - ETA: 0s - loss: 3.1475 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.1262 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.1238 - accuracy: 0.9194Epoch 5 took 3.58 seconds
12/12 [==============================] - 4s 297ms/step - loss: 3.1238 - accuracy: 0.9194 - val_loss: 10.8515 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 41.93%, Peak: 48.20%, Min: 14.75%
  Memory Usage - Avg: 962.13 MB, Peak: 998.25 MB, Min: 682.06 MB
  Available Memory - Avg: 2930.56 MB, Peak: 3497.72 MB, Min: 2849.43 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
