2025-04-15 13:01:19.211104: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 13:01:19.218495: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:01:19.253969: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:01:19.254355: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 13:01:19.837391: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 14s - loss: 6.6085 - accuracy: 0.2812 2/12 [====>.........................] - ETA: 1s - loss: 7.9320 - accuracy: 0.5156  3/12 [======>.......................] - ETA: 1s - loss: 8.6863 - accuracy: 0.5938 4/12 [=========>....................] - ETA: 1s - loss: 8.5161 - accuracy: 0.6250 5/12 [===========>..................] - ETA: 1s - loss: 7.9925 - accuracy: 0.6438 6/12 [==============>...............] - ETA: 1s - loss: 7.4163 - accuracy: 0.6875 7/12 [================>.............] - ETA: 1s - loss: 7.0289 - accuracy: 0.7143 8/12 [===================>..........] - ETA: 0s - loss: 6.8138 - accuracy: 0.7227 9/12 [=====================>........] - ETA: 0s - loss: 6.6436 - accuracy: 0.725710/12 [========================>.....] - ETA: 0s - loss: 6.4843 - accuracy: 0.734411/12 [==========================>...] - ETA: 0s - loss: 6.3740 - accuracy: 0.730112/12 [==============================] - ETA: 0s - loss: 6.3378 - accuracy: 0.7278Epoch 1 took 3.77 seconds
12/12 [==============================] - 4s 222ms/step - loss: 6.3378 - accuracy: 0.7278 - val_loss: 4.5873 - val_accuracy: 0.7500
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.5706 - accuracy: 0.7500 2/12 [====>.........................] - ETA: 1s - loss: 4.6368 - accuracy: 0.7500 3/12 [======>.......................] - ETA: 1s - loss: 4.6509 - accuracy: 0.7604 4/12 [=========>....................] - ETA: 1s - loss: 4.5486 - accuracy: 0.8047 5/12 [===========>..................] - ETA: 1s - loss: 4.5496 - accuracy: 0.8000 6/12 [==============>...............] - ETA: 1s - loss: 4.5506 - accuracy: 0.7865 7/12 [================>.............] - ETA: 0s - loss: 4.4779 - accuracy: 0.8080 8/12 [===================>..........] - ETA: 0s - loss: 4.4703 - accuracy: 0.8125 9/12 [=====================>........] - ETA: 0s - loss: 4.4425 - accuracy: 0.822910/12 [========================>.....] - ETA: 0s - loss: 4.4115 - accuracy: 0.825011/12 [==========================>...] - ETA: 0s - loss: 4.3798 - accuracy: 0.832412/12 [==============================] - ETA: 0s - loss: 4.3696 - accuracy: 0.8361Epoch 2 took 2.33 seconds
12/12 [==============================] - 2s 195ms/step - loss: 4.3696 - accuracy: 0.8361 - val_loss: 4.6473 - val_accuracy: 0.6000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.0260 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 1s - loss: 3.9947 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 3.9694 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 3.9404 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 1s - loss: 3.9420 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 3.9464 - accuracy: 0.9010 7/12 [================>.............] - ETA: 0s - loss: 3.9333 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 0s - loss: 3.9042 - accuracy: 0.9102 9/12 [=====================>........] - ETA: 0s - loss: 3.8859 - accuracy: 0.906210/12 [========================>.....] - ETA: 0s - loss: 3.9001 - accuracy: 0.900011/12 [==========================>...] - ETA: 0s - loss: 3.8950 - accuracy: 0.892012/12 [==============================] - ETA: 0s - loss: 3.8976 - accuracy: 0.8889Epoch 3 took 2.23 seconds
12/12 [==============================] - 2s 184ms/step - loss: 3.8976 - accuracy: 0.8889 - val_loss: 5.2682 - val_accuracy: 0.3250
Epoch 4/5
 1/12 [=>............................] - ETA: 1s - loss: 3.6218 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 1s - loss: 3.6209 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 1s - loss: 3.6047 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 1s - loss: 3.5940 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 3.5827 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.5849 - accuracy: 0.9479 7/12 [================>.............] - ETA: 0s - loss: 3.5767 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 0s - loss: 3.5680 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.5529 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 3.5495 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.5529 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.5513 - accuracy: 0.9222Epoch 4 took 2.42 seconds
12/12 [==============================] - 2s 204ms/step - loss: 3.5513 - accuracy: 0.9222 - val_loss: 6.3476 - val_accuracy: 0.1750
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.5754 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 3.4543 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 2s - loss: 3.3662 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.3777 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 3.3404 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.3360 - accuracy: 0.9010 7/12 [================>.............] - ETA: 1s - loss: 3.3057 - accuracy: 0.9107 8/12 [===================>..........] - ETA: 1s - loss: 3.2881 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.2696 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.2602 - accuracy: 0.918711/12 [==========================>...] - ETA: 0s - loss: 3.2499 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.2452 - accuracy: 0.9194Epoch 5 took 3.63 seconds
12/12 [==============================] - 4s 306ms/step - loss: 3.2452 - accuracy: 0.9194 - val_loss: 8.7153 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 42.17%, Peak: 47.67%, Min: 18.23%
  Memory Usage - Avg: 966.79 MB, Peak: 1013.14 MB, Min: 690.41 MB
  Available Memory - Avg: 2969.76 MB, Peak: 3489.64 MB, Min: 2880.39 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
