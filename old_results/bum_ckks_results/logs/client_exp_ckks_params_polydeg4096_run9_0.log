2025-04-15 08:35:45.040113: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:35:45.041834: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:35:45.075738: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:35:45.076153: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:35:45.722003: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 5.2784 - accuracy: 0.6562 2/12 [====>.........................] - ETA: 1s - loss: 6.1909 - accuracy: 0.7500  3/12 [======>.......................] - ETA: 1s - loss: 7.3735 - accuracy: 0.7604 4/12 [=========>....................] - ETA: 1s - loss: 6.8719 - accuracy: 0.8047 5/12 [===========>..................] - ETA: 1s - loss: 7.2540 - accuracy: 0.7625 6/12 [==============>...............] - ETA: 1s - loss: 6.8416 - accuracy: 0.7656 7/12 [================>.............] - ETA: 0s - loss: 6.5278 - accuracy: 0.7723 8/12 [===================>..........] - ETA: 0s - loss: 6.3693 - accuracy: 0.7539 9/12 [=====================>........] - ETA: 0s - loss: 6.1749 - accuracy: 0.753510/12 [========================>.....] - ETA: 0s - loss: 6.0163 - accuracy: 0.753111/12 [==========================>...] - ETA: 0s - loss: 5.9097 - accuracy: 0.744312/12 [==============================] - ETA: 0s - loss: 5.9103 - accuracy: 0.7389Epoch 1 took 3.81 seconds
12/12 [==============================] - 4s 217ms/step - loss: 5.9103 - accuracy: 0.7389 - val_loss: 4.4727 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.5160 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 1s - loss: 4.3318 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 4.2974 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 4.3123 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 1s - loss: 4.2758 - accuracy: 0.8438 6/12 [==============>...............] - ETA: 1s - loss: 4.2154 - accuracy: 0.8594 7/12 [================>.............] - ETA: 0s - loss: 4.2054 - accuracy: 0.8661 8/12 [===================>..........] - ETA: 0s - loss: 4.2235 - accuracy: 0.8555 9/12 [=====================>........] - ETA: 0s - loss: 4.1797 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 4.1666 - accuracy: 0.871911/12 [==========================>...] - ETA: 0s - loss: 4.1468 - accuracy: 0.872212/12 [==============================] - ETA: 0s - loss: 4.1357 - accuracy: 0.8750Epoch 2 took 2.20 seconds
12/12 [==============================] - 2s 183ms/step - loss: 4.1357 - accuracy: 0.8750 - val_loss: 4.1383 - val_accuracy: 0.7500
Epoch 3/5
 1/12 [=>............................] - ETA: 1s - loss: 3.7981 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.8677 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 3.8241 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 3.7871 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 1s - loss: 3.8260 - accuracy: 0.8938 6/12 [==============>...............] - ETA: 1s - loss: 3.8301 - accuracy: 0.8958 7/12 [================>.............] - ETA: 0s - loss: 3.7806 - accuracy: 0.9062 8/12 [===================>..........] - ETA: 0s - loss: 3.7493 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.7200 - accuracy: 0.923610/12 [========================>.....] - ETA: 0s - loss: 3.6949 - accuracy: 0.925011/12 [==========================>...] - ETA: 0s - loss: 3.6861 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.6792 - accuracy: 0.9194Epoch 3 took 2.22 seconds
12/12 [==============================] - 2s 187ms/step - loss: 3.6792 - accuracy: 0.9194 - val_loss: 3.8285 - val_accuracy: 0.6500
Epoch 4/5
 1/12 [=>............................] - ETA: 1s - loss: 3.8777 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 1s - loss: 3.5957 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 3.4791 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 3.4423 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 1s - loss: 3.3964 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 1s - loss: 3.3988 - accuracy: 0.9062 7/12 [================>.............] - ETA: 0s - loss: 3.3896 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 0s - loss: 3.3541 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.3346 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.3168 - accuracy: 0.918711/12 [==========================>...] - ETA: 0s - loss: 3.2932 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.2874 - accuracy: 0.9222Epoch 4 took 2.54 seconds
12/12 [==============================] - 3s 216ms/step - loss: 3.2874 - accuracy: 0.9222 - val_loss: 4.2355 - val_accuracy: 0.5500
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.0877 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 2.9727 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 2.9490 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 2.9704 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 2.9953 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 2.9684 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 2.9523 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 1s - loss: 2.9267 - accuracy: 0.9531 9/12 [=====================>........] - ETA: 0s - loss: 2.9038 - accuracy: 0.958310/12 [========================>.....] - ETA: 0s - loss: 2.9102 - accuracy: 0.953111/12 [==========================>...] - ETA: 0s - loss: 2.9025 - accuracy: 0.946012/12 [==============================] - ETA: 0s - loss: 2.9136 - accuracy: 0.9389Epoch 5 took 3.47 seconds
12/12 [==============================] - 3s 291ms/step - loss: 2.9136 - accuracy: 0.9389 - val_loss: 4.3599 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 41.30%, Peak: 48.70%, Min: 4.75%
  Memory Usage - Avg: 937.93 MB, Peak: 985.41 MB, Min: 657.71 MB
  Available Memory - Avg: 2956.80 MB, Peak: 3495.18 MB, Min: 2858.84 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
