2025-04-15 08:21:09.128320: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:21:09.130102: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:21:09.166746: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:21:09.167155: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:21:09.785916: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 17s - loss: 6.0750 - accuracy: 0.3750 2/12 [====>.........................] - ETA: 1s - loss: 7.4932 - accuracy: 0.5625  3/12 [======>.......................] - ETA: 1s - loss: 7.0399 - accuracy: 0.6562 4/12 [=========>....................] - ETA: 1s - loss: 6.8391 - accuracy: 0.6562 5/12 [===========>..................] - ETA: 1s - loss: 6.4499 - accuracy: 0.6562 6/12 [==============>...............] - ETA: 1s - loss: 6.1574 - accuracy: 0.6562 7/12 [================>.............] - ETA: 0s - loss: 5.9722 - accuracy: 0.6518 8/12 [===================>..........] - ETA: 0s - loss: 5.8117 - accuracy: 0.6758 9/12 [=====================>........] - ETA: 0s - loss: 5.7144 - accuracy: 0.691010/12 [========================>.....] - ETA: 0s - loss: 5.6099 - accuracy: 0.703111/12 [==========================>...] - ETA: 0s - loss: 5.5124 - accuracy: 0.7074Epoch 1 took 3.88 seconds
12/12 [==============================] - 4s 210ms/step - loss: 5.4778 - accuracy: 0.7139 - val_loss: 4.4605 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.2822 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 4.4342 - accuracy: 0.7656 3/12 [======>.......................] - ETA: 1s - loss: 4.2926 - accuracy: 0.8125 4/12 [=========>....................] - ETA: 1s - loss: 4.2602 - accuracy: 0.8203 5/12 [===========>..................] - ETA: 1s - loss: 4.2199 - accuracy: 0.8250 6/12 [==============>...............] - ETA: 1s - loss: 4.1506 - accuracy: 0.8490 7/12 [================>.............] - ETA: 1s - loss: 4.1303 - accuracy: 0.8571 8/12 [===================>..........] - ETA: 0s - loss: 4.1212 - accuracy: 0.8555 9/12 [=====================>........] - ETA: 0s - loss: 4.0900 - accuracy: 0.861110/12 [========================>.....] - ETA: 0s - loss: 4.1166 - accuracy: 0.862511/12 [==========================>...] - ETA: 0s - loss: 4.0691 - accuracy: 0.875012/12 [==============================] - ETA: 0s - loss: 4.0595 - accuracy: 0.8778Epoch 2 took 2.32 seconds
12/12 [==============================] - 2s 193ms/step - loss: 4.0595 - accuracy: 0.8778 - val_loss: 3.9882 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6824 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 3.7141 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 3.7779 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 1s - loss: 3.7326 - accuracy: 0.8672 5/12 [===========>..................] - ETA: 1s - loss: 3.6630 - accuracy: 0.8938 6/12 [==============>...............] - ETA: 1s - loss: 3.6170 - accuracy: 0.9062 7/12 [================>.............] - ETA: 0s - loss: 3.5758 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 0s - loss: 3.5605 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 0s - loss: 3.5827 - accuracy: 0.920110/12 [========================>.....] - ETA: 0s - loss: 3.5637 - accuracy: 0.925011/12 [==========================>...] - ETA: 0s - loss: 3.5324 - accuracy: 0.931812/12 [==============================] - ETA: 0s - loss: 3.5406 - accuracy: 0.9250Epoch 3 took 2.31 seconds
12/12 [==============================] - 2s 191ms/step - loss: 3.5406 - accuracy: 0.9250 - val_loss: 3.8044 - val_accuracy: 0.6500
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.2759 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 3.2866 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 3.2606 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 3.3478 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.3715 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.3404 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.3215 - accuracy: 0.9330 8/12 [===================>..........] - ETA: 0s - loss: 3.3007 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.2844 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 3.2682 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.2952 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.2887 - accuracy: 0.9194Epoch 4 took 2.41 seconds
12/12 [==============================] - 2s 202ms/step - loss: 3.2887 - accuracy: 0.9194 - val_loss: 4.6408 - val_accuracy: 0.4250
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.1839 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 3.0916 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 2s - loss: 3.0322 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 2s - loss: 3.0393 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 3.0360 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 2.9974 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 2.9718 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 1s - loss: 2.9614 - accuracy: 0.9258 9/12 [=====================>........] - ETA: 0s - loss: 2.9370 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 2.9501 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 2.9281 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 2.9220 - accuracy: 0.9361Epoch 5 took 3.24 seconds
12/12 [==============================] - 3s 271ms/step - loss: 2.9220 - accuracy: 0.9361 - val_loss: 9.7063 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 40.96%, Peak: 47.70%, Min: 11.47%
  Memory Usage - Avg: 938.04 MB, Peak: 986.88 MB, Min: 636.94 MB
  Available Memory - Avg: 2981.74 MB, Peak: 3525.35 MB, Min: 2884.83 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
