2025-04-15 08:27:21.745616: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:27:21.747794: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:27:21.786293: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:27:21.786689: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:27:22.425278: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 17s - loss: 5.5406 - accuracy: 0.5625 2/12 [====>.........................] - ETA: 2s - loss: 6.2300 - accuracy: 0.6719  3/12 [======>.......................] - ETA: 1s - loss: 6.7063 - accuracy: 0.7292 4/12 [=========>....................] - ETA: 1s - loss: 6.5963 - accuracy: 0.6875 5/12 [===========>..................] - ETA: 1s - loss: 6.3597 - accuracy: 0.6938 6/12 [==============>...............] - ETA: 1s - loss: 6.1046 - accuracy: 0.7083 7/12 [================>.............] - ETA: 0s - loss: 6.0473 - accuracy: 0.6875 8/12 [===================>..........] - ETA: 0s - loss: 5.9671 - accuracy: 0.6875 9/12 [=====================>........] - ETA: 0s - loss: 5.8006 - accuracy: 0.715310/12 [========================>.....] - ETA: 0s - loss: 5.7173 - accuracy: 0.734411/12 [==========================>...] - ETA: 0s - loss: 5.6768 - accuracy: 0.744312/12 [==============================] - ETA: 0s - loss: 5.6439 - accuracy: 0.7472Epoch 1 took 3.89 seconds
12/12 [==============================] - 4s 210ms/step - loss: 5.6439 - accuracy: 0.7472 - val_loss: 4.5742 - val_accuracy: 0.7500
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 6.2329 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 1s - loss: 5.7115 - accuracy: 0.8438 3/12 [======>.......................] - ETA: 1s - loss: 5.3368 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 1s - loss: 5.1272 - accuracy: 0.8750 5/12 [===========>..................] - ETA: 1s - loss: 4.9763 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 1s - loss: 4.8113 - accuracy: 0.8854 7/12 [================>.............] - ETA: 0s - loss: 4.7399 - accuracy: 0.8839 8/12 [===================>..........] - ETA: 0s - loss: 4.7056 - accuracy: 0.8672 9/12 [=====================>........] - ETA: 0s - loss: 4.6248 - accuracy: 0.878510/12 [========================>.....] - ETA: 0s - loss: 4.5567 - accuracy: 0.884411/12 [==========================>...] - ETA: 0s - loss: 4.5118 - accuracy: 0.883512/12 [==============================] - ETA: 0s - loss: 4.4973 - accuracy: 0.8833Epoch 2 took 2.26 seconds
12/12 [==============================] - 2s 190ms/step - loss: 4.4973 - accuracy: 0.8833 - val_loss: 4.6060 - val_accuracy: 0.5250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1739 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 3.9330 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 1s - loss: 3.9599 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 1s - loss: 3.8754 - accuracy: 0.9609 5/12 [===========>..................] - ETA: 1s - loss: 3.8318 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 3.7999 - accuracy: 0.9635 7/12 [================>.............] - ETA: 1s - loss: 3.9510 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 0s - loss: 3.9099 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.9084 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.8839 - accuracy: 0.940611/12 [==========================>...] - ETA: 0s - loss: 3.8667 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 3.8572 - accuracy: 0.9361Epoch 3 took 2.37 seconds
12/12 [==============================] - 2s 199ms/step - loss: 3.8572 - accuracy: 0.9361 - val_loss: 4.7785 - val_accuracy: 0.5250
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6384 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 1s - loss: 3.5638 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 1s - loss: 3.5744 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 3.5141 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 3.4727 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 3.4841 - accuracy: 0.9531 7/12 [================>.............] - ETA: 1s - loss: 3.4594 - accuracy: 0.9554 8/12 [===================>..........] - ETA: 0s - loss: 3.4389 - accuracy: 0.9531 9/12 [=====================>........] - ETA: 0s - loss: 3.4609 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 3.4550 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 3.4443 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 3.4400 - accuracy: 0.9361Epoch 4 took 2.81 seconds
12/12 [==============================] - 3s 236ms/step - loss: 3.4400 - accuracy: 0.9361 - val_loss: 4.6722 - val_accuracy: 0.4250
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.1392 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.3249 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.2751 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.2855 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 2s - loss: 3.2452 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.2265 - accuracy: 0.9219 7/12 [================>.............] - ETA: 1s - loss: 3.1956 - accuracy: 0.9286 8/12 [===================>..........] - ETA: 1s - loss: 3.1680 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 3.1534 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.1484 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 3.1418 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 3.1352 - accuracy: 0.9389Epoch 5 took 3.41 seconds
12/12 [==============================] - 3s 284ms/step - loss: 3.1352 - accuracy: 0.9389 - val_loss: 5.1858 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 42.97%, Peak: 48.70%, Min: 24.95%
  Memory Usage - Avg: 942.82 MB, Peak: 989.55 MB, Min: 664.83 MB
  Available Memory - Avg: 2946.86 MB, Peak: 3471.75 MB, Min: 2854.13 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
