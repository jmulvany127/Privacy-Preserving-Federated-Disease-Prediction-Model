2025-04-13 22:20:16.414787: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-13 22:20:16.417052: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-13 22:20:16.476018: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-13 22:20:16.477210: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-13 22:20:17.935263: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 29s - loss: 5.2483 - accuracy: 0.7188 2/12 [====>.........................] - ETA: 2s - loss: 4.8890 - accuracy: 0.8281  3/12 [======>.......................] - ETA: 2s - loss: 5.1852 - accuracy: 0.8438 4/12 [=========>....................] - ETA: 2s - loss: 5.4738 - accuracy: 0.8203 5/12 [===========>..................] - ETA: 1s - loss: 5.5264 - accuracy: 0.8000 6/12 [==============>...............] - ETA: 1s - loss: 5.9655 - accuracy: 0.7135 7/12 [================>.............] - ETA: 1s - loss: 5.8283 - accuracy: 0.7277 8/12 [===================>..........] - ETA: 1s - loss: 5.6203 - accuracy: 0.7539 9/12 [=====================>........] - ETA: 0s - loss: 6.1024 - accuracy: 0.736110/12 [========================>.....] - ETA: 0s - loss: 6.0662 - accuracy: 0.740611/12 [==========================>...] - ETA: 0s - loss: 6.0990 - accuracy: 0.738612/12 [==============================] - ETA: 0s - loss: 6.0980 - accuracy: 0.7417Epoch 1 took 6.83 seconds
12/12 [==============================] - 7s 376ms/step - loss: 6.0980 - accuracy: 0.7417 - val_loss: 4.3896 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 5.7773 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 2s - loss: 5.4070 - accuracy: 0.7500 3/12 [======>.......................] - ETA: 2s - loss: 5.1853 - accuracy: 0.7500 4/12 [=========>....................] - ETA: 2s - loss: 5.0519 - accuracy: 0.7500 5/12 [===========>..................] - ETA: 2s - loss: 4.8316 - accuracy: 0.7812 6/12 [==============>...............] - ETA: 1s - loss: 4.7550 - accuracy: 0.7969 7/12 [================>.............] - ETA: 1s - loss: 4.7888 - accuracy: 0.7857 8/12 [===================>..........] - ETA: 1s - loss: 4.7927 - accuracy: 0.7812 9/12 [=====================>........] - ETA: 0s - loss: 4.7614 - accuracy: 0.788210/12 [========================>.....] - ETA: 0s - loss: 4.6826 - accuracy: 0.793711/12 [==========================>...] - ETA: 0s - loss: 4.6011 - accuracy: 0.806812/12 [==============================] - ETA: 0s - loss: 4.6059 - accuracy: 0.8056Epoch 2 took 3.44 seconds
12/12 [==============================] - 3s 289ms/step - loss: 4.6059 - accuracy: 0.8056 - val_loss: 3.9978 - val_accuracy: 0.8750
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 3.6599 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.6603 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.9003 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 2s - loss: 3.9367 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 1s - loss: 3.9420 - accuracy: 0.8438 6/12 [==============>...............] - ETA: 1s - loss: 3.9710 - accuracy: 0.8438 7/12 [================>.............] - ETA: 1s - loss: 3.9189 - accuracy: 0.8571 8/12 [===================>..........] - ETA: 1s - loss: 3.9268 - accuracy: 0.8477 9/12 [=====================>........] - ETA: 0s - loss: 3.9252 - accuracy: 0.840310/12 [========================>.....] - ETA: 0s - loss: 3.9472 - accuracy: 0.825011/12 [==========================>...] - ETA: 0s - loss: 3.9157 - accuracy: 0.835212/12 [==============================] - ETA: 0s - loss: 3.9020 - accuracy: 0.8389Epoch 3 took 3.37 seconds
12/12 [==============================] - 3s 279ms/step - loss: 3.9020 - accuracy: 0.8389 - val_loss: 3.6929 - val_accuracy: 0.8250
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.3461 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.4166 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 3.3951 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 3.4454 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 2s - loss: 3.4491 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 2s - loss: 3.4354 - accuracy: 0.9167 7/12 [================>.............] - ETA: 1s - loss: 3.4039 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 1s - loss: 3.4333 - accuracy: 0.9102 9/12 [=====================>........] - ETA: 1s - loss: 3.4433 - accuracy: 0.895810/12 [========================>.....] - ETA: 0s - loss: 3.4396 - accuracy: 0.893811/12 [==========================>...] - ETA: 0s - loss: 3.4284 - accuracy: 0.892012/12 [==============================] - ETA: 0s - loss: 3.4231 - accuracy: 0.8917Epoch 4 took 4.07 seconds
12/12 [==============================] - 4s 346ms/step - loss: 3.4231 - accuracy: 0.8917 - val_loss: 3.4860 - val_accuracy: 0.8250
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2982 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.2217 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 2s - loss: 3.1495 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 3.1552 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 2s - loss: 3.1378 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.1255 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.1052 - accuracy: 0.9330 8/12 [===================>..........] - ETA: 1s - loss: 3.0795 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.1041 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 3.1024 - accuracy: 0.925011/12 [==========================>...] - ETA: 0s - loss: 3.0902 - accuracy: 0.929012/12 [==============================] - ETA: 0s - loss: 3.0866 - accuracy: 0.9306Epoch 5 took 3.67 seconds
12/12 [==============================] - 4s 307ms/step - loss: 3.0866 - accuracy: 0.9306 - val_loss: 3.1910 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 39.34%, Peak: 49.95%, Min: 0.25%
  Memory Usage - Avg: 1026.46 MB, Peak: 1077.65 MB, Min: 740.21 MB
  Available Memory - Avg: 2644.12 MB, Peak: 3184.93 MB, Min: 2544.45 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
Epoch 1/5
 1/12 [=>............................] - ETA: 2s - loss: 2.8728 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 2.8533 - accuracy: 1.0000 3/12 [======>.......................] - ETA: 1s - loss: 2.8546 - accuracy: 0.9792 4/12 [=========>....................] - ETA: 1s - loss: 2.8508 - accuracy: 0.9766 5/12 [===========>..................] - ETA: 1s - loss: 2.8402 - accuracy: 0.9688 6/12 [==============>...............] - ETA: 1s - loss: 2.8275 - accuracy: 0.9635 7/12 [================>.............] - ETA: 1s - loss: 2.8331 - accuracy: 0.9554 8/12 [===================>..........] - ETA: 1s - loss: 2.8168 - accuracy: 0.9570 9/12 [=====================>........] - ETA: 0s - loss: 2.8079 - accuracy: 0.958310/12 [========================>.....] - ETA: 0s - loss: 2.8010 - accuracy: 0.959411/12 [==========================>...] - ETA: 0s - loss: 2.8055 - accuracy: 0.951712/12 [==============================] - ETA: 0s - loss: 2.8007 - accuracy: 0.9528Epoch 1 took 3.18 seconds
12/12 [==============================] - 3s 268ms/step - loss: 2.8007 - accuracy: 0.9528 - val_loss: 3.1188 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 3s - loss: 2.6734 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 2.6238 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 2.6274 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 2s - loss: 2.5998 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 2s - loss: 2.5894 - accuracy: 0.9563 6/12 [==============>...............] - ETA: 1s - loss: 2.5794 - accuracy: 0.9531 7/12 [================>.............] - ETA: 1s - loss: 2.5713 - accuracy: 0.9554 8/12 [===================>..........] - ETA: 1s - loss: 2.5797 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 1s - loss: 2.5742 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 2.5534 - accuracy: 0.946911/12 [==========================>...] - ETA: 0s - loss: 2.5390 - accuracy: 0.951712/12 [==============================] - ETA: 0s - loss: 2.5402 - accuracy: 0.9500Epoch 2 took 4.15 seconds
12/12 [==============================] - 4s 349ms/step - loss: 2.5402 - accuracy: 0.9500 - val_loss: 2.8739 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 2.3518 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 2.3591 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 2.3778 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 2.3535 - accuracy: 0.9688 5/12 [===========>..................] - ETA: 1s - loss: 2.3446 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 2.3412 - accuracy: 0.9635 7/12 [================>.............] - ETA: 1s - loss: 2.3530 - accuracy: 0.9554 8/12 [===================>..........] - ETA: 1s - loss: 2.3716 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 0s - loss: 2.3527 - accuracy: 0.951410/12 [========================>.....] - ETA: 0s - loss: 2.3391 - accuracy: 0.956311/12 [==========================>...] - ETA: 0s - loss: 2.3249 - accuracy: 0.960212/12 [==============================] - ETA: 0s - loss: 2.3217 - accuracy: 0.9611Epoch 3 took 3.34 seconds
12/12 [==============================] - 3s 275ms/step - loss: 2.3217 - accuracy: 0.9611 - val_loss: 2.6833 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 2.1997 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 2.1990 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 2.1778 - accuracy: 0.9792 4/12 [=========>....................] - ETA: 2s - loss: 2.1591 - accuracy: 0.9844 5/12 [===========>..................] - ETA: 1s - loss: 2.1728 - accuracy: 0.9750 6/12 [==============>...............] - ETA: 1s - loss: 2.1771 - accuracy: 0.9688 7/12 [================>.............] - ETA: 1s - loss: 2.1719 - accuracy: 0.9688 8/12 [===================>..........] - ETA: 1s - loss: 2.1713 - accuracy: 0.9648 9/12 [=====================>........] - ETA: 0s - loss: 2.1618 - accuracy: 0.965310/12 [========================>.....] - ETA: 0s - loss: 2.1489 - accuracy: 0.968811/12 [==========================>...] - ETA: 0s - loss: 2.1789 - accuracy: 0.957412/12 [==============================] - ETA: 0s - loss: 2.1763 - accuracy: 0.9583Epoch 4 took 3.35 seconds
12/12 [==============================] - 3s 279ms/step - loss: 2.1763 - accuracy: 0.9583 - val_loss: 2.8563 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 2.1142 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 3s - loss: 2.0681 - accuracy: 0.9844 3/12 [======>.......................] - ETA: 2s - loss: 2.0521 - accuracy: 0.9792 4/12 [=========>....................] - ETA: 2s - loss: 2.0785 - accuracy: 0.9609 5/12 [===========>..................] - ETA: 2s - loss: 2.0758 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 2.0729 - accuracy: 0.9635 7/12 [================>.............] - ETA: 1s - loss: 2.0575 - accuracy: 0.9688 8/12 [===================>..........] - ETA: 1s - loss: 2.0453 - accuracy: 0.9727 9/12 [=====================>........] - ETA: 0s - loss: 2.0332 - accuracy: 0.975710/12 [========================>.....] - ETA: 0s - loss: 2.0262 - accuracy: 0.971911/12 [==========================>...] - ETA: 0s - loss: 2.0178 - accuracy: 0.971612/12 [==============================] - ETA: 0s - loss: 2.0150 - accuracy: 0.9722Epoch 5 took 3.55 seconds
12/12 [==============================] - 4s 297ms/step - loss: 2.0150 - accuracy: 0.9722 - val_loss: 2.2542 - val_accuracy: 0.8750
Round Complete.
  CPU Usage - Avg: 42.32%, Peak: 47.20%, Min: 26.95%
  Memory Usage - Avg: 1330.80 MB, Peak: 1333.02 MB, Min: 1300.46 MB
  Available Memory - Avg: 1541.64 MB, Peak: 1609.93 MB, Min: 1533.00 MB

=== DP Noise Injection (Round 2) ===
Epsilon: 3.0, Noise Type: gaussian
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
Epoch 1/5
 1/12 [=>............................] - ETA: 2s - loss: 1.9567 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 1.9381 - accuracy: 0.9844 3/12 [======>.......................] - ETA: 2s - loss: 1.9785 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 2s - loss: 1.9658 - accuracy: 0.9766 5/12 [===========>..................] - ETA: 1s - loss: 1.9495 - accuracy: 0.9812 6/12 [==============>...............] - ETA: 1s - loss: 1.9442 - accuracy: 0.9740 7/12 [================>.............] - ETA: 1s - loss: 1.9486 - accuracy: 0.9688 8/12 [===================>..........] - ETA: 1s - loss: 1.9429 - accuracy: 0.9688 9/12 [=====================>........] - ETA: 0s - loss: 1.9338 - accuracy: 0.972210/12 [========================>.....] - ETA: 0s - loss: 1.9254 - accuracy: 0.975011/12 [==========================>...] - ETA: 0s - loss: 1.9213 - accuracy: 0.974412/12 [==============================] - ETA: 0s - loss: 1.9285 - accuracy: 0.9722Epoch 1 took 3.54 seconds
12/12 [==============================] - 4s 301ms/step - loss: 1.9285 - accuracy: 0.9722 - val_loss: 2.4038 - val_accuracy: 0.6500
Epoch 2/5
 1/12 [=>............................] - ETA: 3s - loss: 1.8204 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 3s - loss: 1.8404 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 3s - loss: 1.8190 - accuracy: 0.9792 4/12 [=========>....................] - ETA: 2s - loss: 1.8442 - accuracy: 0.9688 5/12 [===========>..................] - ETA: 2s - loss: 1.8926 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 2s - loss: 1.8995 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 1.8878 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 1s - loss: 1.8839 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 1s - loss: 1.8711 - accuracy: 0.947910/12 [========================>.....] - ETA: 0s - loss: 1.8641 - accuracy: 0.946911/12 [==========================>...] - ETA: 0s - loss: 1.8557 - accuracy: 0.948912/12 [==============================] - ETA: 0s - loss: 1.8518 - accuracy: 0.9500Epoch 2 took 4.22 seconds
12/12 [==============================] - 4s 356ms/step - loss: 1.8518 - accuracy: 0.9500 - val_loss: 4.1365 - val_accuracy: 0.4750
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 1.7312 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 1.7298 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 1.7090 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 2s - loss: 1.6947 - accuracy: 0.9766 5/12 [===========>..................] - ETA: 2s - loss: 1.6915 - accuracy: 0.9750 6/12 [==============>...............] - ETA: 1s - loss: 1.6830 - accuracy: 0.9792 7/12 [================>.............] - ETA: 1s - loss: 1.6900 - accuracy: 0.9732 8/12 [===================>..........] - ETA: 1s - loss: 1.6896 - accuracy: 0.9727 9/12 [=====================>........] - ETA: 0s - loss: 1.6863 - accuracy: 0.968810/12 [========================>.....] - ETA: 0s - loss: 1.6775 - accuracy: 0.971911/12 [==========================>...] - ETA: 0s - loss: 1.6807 - accuracy: 0.971612/12 [==============================] - ETA: 0s - loss: 1.6782 - accuracy: 0.9722Epoch 3 took 3.50 seconds
12/12 [==============================] - 4s 286ms/step - loss: 1.6782 - accuracy: 0.9722 - val_loss: 4.2438 - val_accuracy: 0.2000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 1.5884 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 1.5808 - accuracy: 1.0000 3/12 [======>.......................] - ETA: 2s - loss: 1.6214 - accuracy: 0.9792 4/12 [=========>....................] - ETA: 2s - loss: 1.6413 - accuracy: 0.9766 5/12 [===========>..................] - ETA: 1s - loss: 1.6242 - accuracy: 0.9812 6/12 [==============>...............] - ETA: 1s - loss: 1.6209 - accuracy: 0.9792 7/12 [================>.............] - ETA: 1s - loss: 1.6112 - accuracy: 0.9821 8/12 [===================>..........] - ETA: 1s - loss: 1.5988 - accuracy: 0.9844 9/12 [=====================>........] - ETA: 0s - loss: 1.5975 - accuracy: 0.982610/12 [========================>.....] - ETA: 0s - loss: 1.5940 - accuracy: 0.981211/12 [==========================>...] - ETA: 0s - loss: 1.5891 - accuracy: 0.980112/12 [==============================] - ETA: 0s - loss: 1.5876 - accuracy: 0.9806Epoch 4 took 3.41 seconds
12/12 [==============================] - 3s 289ms/step - loss: 1.5876 - accuracy: 0.9806 - val_loss: 4.3412 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 1.5400 - accuracy: 0.9688