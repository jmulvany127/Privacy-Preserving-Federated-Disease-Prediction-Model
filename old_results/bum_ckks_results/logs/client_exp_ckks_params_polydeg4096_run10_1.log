2025-04-15 08:37:48.137861: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:37:48.139616: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:37:48.178001: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:37:48.178375: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:37:48.837790: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 5.4681 - accuracy: 0.6250 2/12 [====>.........................] - ETA: 1s - loss: 5.5519 - accuracy: 0.7344  3/12 [======>.......................] - ETA: 1s - loss: 6.6214 - accuracy: 0.7604 4/12 [=========>....................] - ETA: 1s - loss: 6.5679 - accuracy: 0.7734 5/12 [===========>..................] - ETA: 1s - loss: 6.2315 - accuracy: 0.7937 6/12 [==============>...............] - ETA: 1s - loss: 6.0719 - accuracy: 0.7865 7/12 [================>.............] - ETA: 1s - loss: 5.9906 - accuracy: 0.7634 8/12 [===================>..........] - ETA: 0s - loss: 5.8536 - accuracy: 0.7734 9/12 [=====================>........] - ETA: 0s - loss: 5.7995 - accuracy: 0.777810/12 [========================>.....] - ETA: 0s - loss: 5.6732 - accuracy: 0.784411/12 [==========================>...] - ETA: 0s - loss: 5.6145 - accuracy: 0.772712/12 [==============================] - ETA: 0s - loss: 5.5798 - accuracy: 0.7750Epoch 1 took 3.85 seconds
12/12 [==============================] - 4s 217ms/step - loss: 5.5798 - accuracy: 0.7750 - val_loss: 4.4414 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 5.5757 - accuracy: 0.6875 2/12 [====>.........................] - ETA: 1s - loss: 5.1330 - accuracy: 0.7031 3/12 [======>.......................] - ETA: 1s - loss: 4.8683 - accuracy: 0.7396 4/12 [=========>....................] - ETA: 1s - loss: 4.6639 - accuracy: 0.7812 5/12 [===========>..................] - ETA: 1s - loss: 4.5952 - accuracy: 0.8125 6/12 [==============>...............] - ETA: 1s - loss: 4.5592 - accuracy: 0.8125 7/12 [================>.............] - ETA: 0s - loss: 4.6260 - accuracy: 0.8125 8/12 [===================>..........] - ETA: 0s - loss: 4.6399 - accuracy: 0.8086 9/12 [=====================>........] - ETA: 0s - loss: 4.5837 - accuracy: 0.819410/12 [========================>.....] - ETA: 0s - loss: 4.5755 - accuracy: 0.821911/12 [==========================>...] - ETA: 0s - loss: 4.5371 - accuracy: 0.8239Epoch 2 took 2.21 seconds
12/12 [==============================] - 2s 183ms/step - loss: 4.5474 - accuracy: 0.8222 - val_loss: 4.1411 - val_accuracy: 0.6250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1633 - accuracy: 0.7500 2/12 [====>.........................] - ETA: 1s - loss: 4.1404 - accuracy: 0.7812 3/12 [======>.......................] - ETA: 1s - loss: 4.1521 - accuracy: 0.7917 4/12 [=========>....................] - ETA: 1s - loss: 4.1366 - accuracy: 0.8047 5/12 [===========>..................] - ETA: 1s - loss: 4.0248 - accuracy: 0.8375 6/12 [==============>...............] - ETA: 1s - loss: 3.9693 - accuracy: 0.8594 7/12 [================>.............] - ETA: 0s - loss: 3.9577 - accuracy: 0.8571 8/12 [===================>..........] - ETA: 0s - loss: 3.9381 - accuracy: 0.8516 9/12 [=====================>........] - ETA: 0s - loss: 3.9533 - accuracy: 0.847210/12 [========================>.....] - ETA: 0s - loss: 3.9059 - accuracy: 0.850011/12 [==========================>...] - ETA: 0s - loss: 3.8736 - accuracy: 0.8466Epoch 3 took 2.10 seconds
12/12 [==============================] - 2s 175ms/step - loss: 3.8636 - accuracy: 0.8500 - val_loss: 3.7358 - val_accuracy: 0.7250
Epoch 4/5
 1/12 [=>............................] - ETA: 1s - loss: 3.5028 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 3.4563 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 3.3919 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 1s - loss: 3.3791 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.3749 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 3.3787 - accuracy: 0.9219 7/12 [================>.............] - ETA: 0s - loss: 3.3587 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 0s - loss: 3.3246 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.2992 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 3.2815 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 3.2881 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.2810 - accuracy: 0.9278Epoch 4 took 2.39 seconds
12/12 [==============================] - 2s 202ms/step - loss: 3.2810 - accuracy: 0.9278 - val_loss: 3.7135 - val_accuracy: 0.5750
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.1366 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.1016 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.0465 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 3.0101 - accuracy: 0.9609 5/12 [===========>..................] - ETA: 1s - loss: 2.9924 - accuracy: 0.9563 6/12 [==============>...............] - ETA: 1s - loss: 3.0227 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 3.0511 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 1s - loss: 3.0214 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.0171 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 2.9973 - accuracy: 0.934411/12 [==========================>...] - ETA: 0s - loss: 2.9844 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 2.9835 - accuracy: 0.9306Epoch 5 took 3.37 seconds
12/12 [==============================] - 3s 281ms/step - loss: 2.9835 - accuracy: 0.9306 - val_loss: 3.6476 - val_accuracy: 0.4500
Round Complete.
  CPU Usage - Avg: 27.45%, Peak: 48.20%, Min: 0.00%
  Memory Usage - Avg: 957.35 MB, Peak: 991.53 MB, Min: 661.72 MB
  Available Memory - Avg: 3107.88 MB, Peak: 3553.53 MB, Min: 2838.46 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
