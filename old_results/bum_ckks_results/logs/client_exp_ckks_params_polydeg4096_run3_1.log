2025-04-15 08:23:12.168007: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:23:12.169800: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:23:12.206371: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:23:12.206717: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:23:12.846498: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 6.9625 - accuracy: 0.3125 2/12 [====>.........................] - ETA: 1s - loss: 8.6675 - accuracy: 0.4844  3/12 [======>.......................] - ETA: 1s - loss: 8.0139 - accuracy: 0.6146 4/12 [=========>....................] - ETA: 1s - loss: 7.4605 - accuracy: 0.6406 5/12 [===========>..................] - ETA: 1s - loss: 7.1889 - accuracy: 0.6438 6/12 [==============>...............] - ETA: 1s - loss: 6.8329 - accuracy: 0.6510 7/12 [================>.............] - ETA: 1s - loss: 6.6580 - accuracy: 0.6518 8/12 [===================>..........] - ETA: 0s - loss: 6.3849 - accuracy: 0.6836 9/12 [=====================>........] - ETA: 0s - loss: 6.2698 - accuracy: 0.691010/12 [========================>.....] - ETA: 0s - loss: 6.1560 - accuracy: 0.706311/12 [==========================>...] - ETA: 0s - loss: 5.9891 - accuracy: 0.727312/12 [==============================] - ETA: 0s - loss: 5.9549 - accuracy: 0.7306Epoch 1 took 3.87 seconds
12/12 [==============================] - 4s 225ms/step - loss: 5.9549 - accuracy: 0.7306 - val_loss: 4.6611 - val_accuracy: 0.6750
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.3192 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 4.6847 - accuracy: 0.7812 3/12 [======>.......................] - ETA: 2s - loss: 4.5096 - accuracy: 0.8438 4/12 [=========>....................] - ETA: 1s - loss: 4.5302 - accuracy: 0.8281 5/12 [===========>..................] - ETA: 1s - loss: 4.5089 - accuracy: 0.8250 6/12 [==============>...............] - ETA: 1s - loss: 4.4409 - accuracy: 0.8385 7/12 [================>.............] - ETA: 1s - loss: 4.4197 - accuracy: 0.8348 8/12 [===================>..........] - ETA: 0s - loss: 4.3924 - accuracy: 0.8359 9/12 [=====================>........] - ETA: 0s - loss: 4.3448 - accuracy: 0.850710/12 [========================>.....] - ETA: 0s - loss: 4.3803 - accuracy: 0.850011/12 [==========================>...] - ETA: 0s - loss: 4.3512 - accuracy: 0.852312/12 [==============================] - ETA: 0s - loss: 4.3405 - accuracy: 0.8528Epoch 2 took 2.52 seconds
12/12 [==============================] - 3s 210ms/step - loss: 4.3405 - accuracy: 0.8528 - val_loss: 4.2393 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 1s - loss: 3.9349 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 3.8838 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.8502 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 3.8990 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 1s - loss: 3.8768 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.8390 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 3.8388 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 0s - loss: 3.8164 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 0s - loss: 3.8129 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.8243 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.8014 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.8065 - accuracy: 0.9167Epoch 3 took 2.64 seconds
12/12 [==============================] - 3s 225ms/step - loss: 3.8065 - accuracy: 0.9167 - val_loss: 3.9814 - val_accuracy: 0.7500
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6656 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 3.5609 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 3.5573 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 3.5413 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 2s - loss: 3.5185 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 3.4824 - accuracy: 0.9531 7/12 [================>.............] - ETA: 1s - loss: 3.4767 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 1s - loss: 3.5211 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.5163 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.5001 - accuracy: 0.940611/12 [==========================>...] - ETA: 0s - loss: 3.4867 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 3.4830 - accuracy: 0.9361Epoch 4 took 3.77 seconds
12/12 [==============================] - 4s 325ms/step - loss: 3.4830 - accuracy: 0.9361 - val_loss: 4.5042 - val_accuracy: 0.4500
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.1826 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 3s - loss: 3.1783 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 3s - loss: 3.2250 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 2s - loss: 3.2098 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 2s - loss: 3.2036 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.2320 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 3.2113 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 3.1963 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.1760 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.1556 - accuracy: 0.943811/12 [==========================>...] - ETA: 0s - loss: 3.1383 - accuracy: 0.946012/12 [==============================] - ETA: 0s - loss: 3.1347 - accuracy: 0.9472Epoch 5 took 4.36 seconds
12/12 [==============================] - 4s 375ms/step - loss: 3.1347 - accuracy: 0.9472 - val_loss: 6.0171 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 41.12%, Peak: 48.38%, Min: 5.75%
  Memory Usage - Avg: 955.91 MB, Peak: 999.68 MB, Min: 663.70 MB
  Available Memory - Avg: 2957.86 MB, Peak: 3521.30 MB, Min: 2872.38 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
