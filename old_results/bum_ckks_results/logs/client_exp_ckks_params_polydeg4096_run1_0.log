2025-04-15 08:18:59.634260: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:18:59.636109: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:18:59.704989: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:18:59.705388: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:19:00.341644: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 17s - loss: 5.7921 - accuracy: 0.6562 2/12 [====>.........................] - ETA: 2s - loss: 6.7597 - accuracy: 0.4531  3/12 [======>.......................] - ETA: 1s - loss: 6.1651 - accuracy: 0.5625 4/12 [=========>....................] - ETA: 1s - loss: 6.5175 - accuracy: 0.6250 5/12 [===========>..................] - ETA: 1s - loss: 6.6150 - accuracy: 0.6687 6/12 [==============>...............] - ETA: 1s - loss: 6.4293 - accuracy: 0.7135 7/12 [================>.............] - ETA: 0s - loss: 6.3209 - accuracy: 0.7321 8/12 [===================>..........] - ETA: 0s - loss: 6.2928 - accuracy: 0.7383 9/12 [=====================>........] - ETA: 0s - loss: 6.1125 - accuracy: 0.746510/12 [========================>.....] - ETA: 0s - loss: 6.0782 - accuracy: 0.743711/12 [==========================>...] - ETA: 0s - loss: 5.9531 - accuracy: 0.752812/12 [==============================] - ETA: 0s - loss: 5.9632 - accuracy: 0.7528Epoch 1 took 4.02 seconds
12/12 [==============================] - 4s 223ms/step - loss: 5.9632 - accuracy: 0.7528 - val_loss: 4.5485 - val_accuracy: 0.7500
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.8608 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 4.6128 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 4.5641 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 4.4609 - accuracy: 0.8672 5/12 [===========>..................] - ETA: 1s - loss: 4.4136 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 1s - loss: 4.3948 - accuracy: 0.8490 7/12 [================>.............] - ETA: 0s - loss: 4.3336 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 0s - loss: 4.2744 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 0s - loss: 4.2453 - accuracy: 0.864610/12 [========================>.....] - ETA: 0s - loss: 4.2657 - accuracy: 0.865611/12 [==========================>...] - ETA: 0s - loss: 4.2478 - accuracy: 0.869312/12 [==============================] - ETA: 0s - loss: 4.2336 - accuracy: 0.8722Epoch 2 took 2.32 seconds
12/12 [==============================] - 2s 193ms/step - loss: 4.2336 - accuracy: 0.8722 - val_loss: 4.0352 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.8042 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.7733 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.9202 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.8138 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 1s - loss: 3.7767 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.7206 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 3.7070 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 0s - loss: 3.6828 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.6850 - accuracy: 0.927110/12 [========================>.....] - ETA: 0s - loss: 3.6629 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 3.6558 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.6469 - accuracy: 0.9278Epoch 3 took 2.54 seconds
12/12 [==============================] - 3s 212ms/step - loss: 3.6469 - accuracy: 0.9278 - val_loss: 3.6793 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.2786 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 1s - loss: 3.3368 - accuracy: 0.9844 3/12 [======>.......................] - ETA: 1s - loss: 3.3433 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 1s - loss: 3.3304 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 3.3352 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.3212 - accuracy: 0.9531 7/12 [================>.............] - ETA: 1s - loss: 3.3300 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 1s - loss: 3.3013 - accuracy: 0.9492 9/12 [=====================>........] - ETA: 0s - loss: 3.3172 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.2932 - accuracy: 0.940611/12 [==========================>...] - ETA: 0s - loss: 3.2695 - accuracy: 0.943212/12 [==============================] - ETA: 0s - loss: 3.2632 - accuracy: 0.9444Epoch 4 took 3.23 seconds
12/12 [==============================] - 3s 275ms/step - loss: 3.2632 - accuracy: 0.9444 - val_loss: 3.3940 - val_accuracy: 0.8250
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.0054 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 3s - loss: 3.0474 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 3s - loss: 2.9969 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 2s - loss: 3.0051 - accuracy: 0.9609 5/12 [===========>..................] - ETA: 2s - loss: 3.0127 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 3.0132 - accuracy: 0.9635 7/12 [================>.............] - ETA: 1s - loss: 2.9933 - accuracy: 0.9554 8/12 [===================>..........] - ETA: 1s - loss: 3.0011 - accuracy: 0.9492 9/12 [=====================>........] - ETA: 0s - loss: 2.9847 - accuracy: 0.951410/12 [========================>.....] - ETA: 0s - loss: 2.9598 - accuracy: 0.956311/12 [==========================>...] - ETA: 0s - loss: 2.9468 - accuracy: 0.954512/12 [==============================] - ETA: 0s - loss: 2.9419 - accuracy: 0.9556Epoch 5 took 3.75 seconds
12/12 [==============================] - 4s 312ms/step - loss: 2.9419 - accuracy: 0.9556 - val_loss: 3.1250 - val_accuracy: 0.7750
Round Complete.
  CPU Usage - Avg: 42.90%, Peak: 48.70%, Min: 24.95%
  Memory Usage - Avg: 942.67 MB, Peak: 987.21 MB, Min: 661.12 MB
  Available Memory - Avg: 2978.62 MB, Peak: 3516.14 MB, Min: 2881.10 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
