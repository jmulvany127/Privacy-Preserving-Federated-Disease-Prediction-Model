2025-04-13 22:20:16.414787: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-13 22:20:16.416638: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-13 22:20:16.476226: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-13 22:20:16.477349: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-13 22:20:17.844893: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 30s - loss: 5.1520 - accuracy: 0.7188 2/12 [====>.........................] - ETA: 2s - loss: 6.9646 - accuracy: 0.7500  3/12 [======>.......................] - ETA: 2s - loss: 7.0301 - accuracy: 0.7812 4/12 [=========>....................] - ETA: 2s - loss: 6.5995 - accuracy: 0.7422 5/12 [===========>..................] - ETA: 1s - loss: 6.3261 - accuracy: 0.7125 6/12 [==============>...............] - ETA: 1s - loss: 6.1069 - accuracy: 0.7188 7/12 [================>.............] - ETA: 1s - loss: 5.9468 - accuracy: 0.7232 8/12 [===================>..........] - ETA: 1s - loss: 5.8269 - accuracy: 0.7305 9/12 [=====================>........] - ETA: 0s - loss: 5.7642 - accuracy: 0.739610/12 [========================>.....] - ETA: 0s - loss: 5.7148 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.6308 - accuracy: 0.744312/12 [==============================] - ETA: 0s - loss: 5.5954 - accuracy: 0.7472Epoch 1 took 6.89 seconds
12/12 [==============================] - 7s 373ms/step - loss: 5.5954 - accuracy: 0.7472 - val_loss: 4.4324 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.3501 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 2s - loss: 4.7558 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 2s - loss: 4.5439 - accuracy: 0.8438 4/12 [=========>....................] - ETA: 2s - loss: 4.6121 - accuracy: 0.8203 5/12 [===========>..................] - ETA: 1s - loss: 4.4713 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 1s - loss: 4.4543 - accuracy: 0.8385 7/12 [================>.............] - ETA: 1s - loss: 4.4362 - accuracy: 0.8438 8/12 [===================>..........] - ETA: 1s - loss: 4.3808 - accuracy: 0.8438 9/12 [=====================>........] - ETA: 0s - loss: 4.3878 - accuracy: 0.833310/12 [========================>.....] - ETA: 0s - loss: 4.3656 - accuracy: 0.834411/12 [==========================>...] - ETA: 0s - loss: 4.3079 - accuracy: 0.840912/12 [==============================] - ETA: 0s - loss: 4.3251 - accuracy: 0.8389Epoch 2 took 3.32 seconds
12/12 [==============================] - 3s 278ms/step - loss: 4.3251 - accuracy: 0.8389 - val_loss: 4.0049 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6986 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 3s - loss: 3.8446 - accuracy: 0.8438 3/12 [======>.......................] - ETA: 2s - loss: 3.7966 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 2s - loss: 3.7923 - accuracy: 0.8750 5/12 [===========>..................] - ETA: 2s - loss: 3.9054 - accuracy: 0.8438 6/12 [==============>...............] - ETA: 1s - loss: 3.9830 - accuracy: 0.8438 7/12 [================>.............] - ETA: 1s - loss: 3.9664 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 1s - loss: 3.9219 - accuracy: 0.8516 9/12 [=====================>........] - ETA: 0s - loss: 3.9061 - accuracy: 0.850710/12 [========================>.....] - ETA: 0s - loss: 3.9492 - accuracy: 0.840611/12 [==========================>...] - ETA: 0s - loss: 3.9365 - accuracy: 0.835212/12 [==============================] - ETA: 0s - loss: 3.9251 - accuracy: 0.8361Epoch 3 took 3.46 seconds
12/12 [==============================] - 3s 291ms/step - loss: 3.9251 - accuracy: 0.8361 - val_loss: 3.6802 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.5834 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 3.6521 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 2s - loss: 3.5580 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 2s - loss: 3.5543 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 2s - loss: 3.5376 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 2s - loss: 3.5069 - accuracy: 0.8594 7/12 [================>.............] - ETA: 1s - loss: 3.5008 - accuracy: 0.8616 8/12 [===================>..........] - ETA: 1s - loss: 3.4542 - accuracy: 0.8750 9/12 [=====================>........] - ETA: 1s - loss: 3.4329 - accuracy: 0.878510/12 [========================>.....] - ETA: 0s - loss: 3.4075 - accuracy: 0.878111/12 [==========================>...] - ETA: 0s - loss: 3.3863 - accuracy: 0.880712/12 [==============================] - ETA: 0s - loss: 3.3773 - accuracy: 0.8833Epoch 4 took 4.02 seconds
12/12 [==============================] - 4s 338ms/step - loss: 3.3773 - accuracy: 0.8833 - val_loss: 3.7227 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 2.9420 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 3.0160 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 3.0071 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 3.0025 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 2s - loss: 3.0193 - accuracy: 0.9375 6/12 [==============>...............] - ETA: 1s - loss: 2.9974 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 2.9781 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 2.9768 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 2.9651 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 2.9513 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 2.9461 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 2.9443 - accuracy: 0.9361Epoch 5 took 3.71 seconds
12/12 [==============================] - 4s 310ms/step - loss: 2.9443 - accuracy: 0.9361 - val_loss: 3.4200 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 41.25%, Peak: 49.23%, Min: 24.90%
  Memory Usage - Avg: 1025.42 MB, Peak: 1082.24 MB, Min: 742.79 MB
  Available Memory - Avg: 2650.98 MB, Peak: 3189.59 MB, Min: 2549.19 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
Epoch 1/5
 1/12 [=>............................] - ETA: 2s - loss: 3.0239 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 2.9556 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 2.9351 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 2.9663 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 2.9357 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 2.9154 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 2.8808 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 2.8774 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 2.8592 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 2.8528 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 2.8414 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 2.8375 - accuracy: 0.9361Epoch 1 took 3.15 seconds
12/12 [==============================] - 3s 267ms/step - loss: 2.8375 - accuracy: 0.9361 - val_loss: 3.3080 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 3s - loss: 2.6053 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 2.5602 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 2.5650 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 2s - loss: 2.5722 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 2.5551 - accuracy: 0.9563 6/12 [==============>...............] - ETA: 1s - loss: 2.5782 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 2.5518 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 1s - loss: 2.5418 - accuracy: 0.9492 9/12 [=====================>........] - ETA: 0s - loss: 2.5493 - accuracy: 0.947910/12 [========================>.....] - ETA: 0s - loss: 2.5828 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 2.5680 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 2.5659 - accuracy: 0.9361Epoch 2 took 4.13 seconds
12/12 [==============================] - 4s 350ms/step - loss: 2.5659 - accuracy: 0.9361 - val_loss: 3.0071 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 2.4613 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 2.4107 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 2.3935 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 2.3572 - accuracy: 0.9375 5/12 [===========>..................] - ETA: 1s - loss: 2.3421 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 2.3280 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 2.3070 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 1s - loss: 2.2893 - accuracy: 0.9570 9/12 [=====================>........] - ETA: 0s - loss: 2.2882 - accuracy: 0.954910/12 [========================>.....] - ETA: 0s - loss: 2.3037 - accuracy: 0.946911/12 [==========================>...] - ETA: 0s - loss: 2.2871 - accuracy: 0.951712/12 [==============================] - ETA: 0s - loss: 2.2829 - accuracy: 0.9528Epoch 3 took 3.37 seconds
12/12 [==============================] - 3s 282ms/step - loss: 2.2829 - accuracy: 0.9528 - val_loss: 2.7901 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 2.0850 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 2.0937 - accuracy: 0.9844 3/12 [======>.......................] - ETA: 2s - loss: 2.1620 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 2.1353 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 2s - loss: 2.1228 - accuracy: 0.9563 6/12 [==============>...............] - ETA: 1s - loss: 2.1382 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 2.1304 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 1s - loss: 2.1377 - accuracy: 0.9492 9/12 [=====================>........] - ETA: 0s - loss: 2.1473 - accuracy: 0.944410/12 [========================>.....] - ETA: 0s - loss: 2.1302 - accuracy: 0.950011/12 [==========================>...] - ETA: 0s - loss: 2.1207 - accuracy: 0.951712/12 [==============================] - ETA: 0s - loss: 2.1181 - accuracy: 0.9528Epoch 4 took 3.35 seconds
12/12 [==============================] - 3s 281ms/step - loss: 2.1181 - accuracy: 0.9528 - val_loss: 3.1477 - val_accuracy: 0.5250
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 2.1294 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 2.0267 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 2.0819 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 2.0511 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 1s - loss: 2.0221 - accuracy: 0.9563 6/12 [==============>...............] - ETA: 1s - loss: 2.0015 - accuracy: 0.9635 7/12 [================>.............] - ETA: 1s - loss: 1.9959 - accuracy: 0.9643 8/12 [===================>..........] - ETA: 1s - loss: 1.9919 - accuracy: 0.9648 9/12 [=====================>........] - ETA: 0s - loss: 1.9774 - accuracy: 0.965310/12 [========================>.....] - ETA: 0s - loss: 1.9755 - accuracy: 0.959411/12 [==========================>...] - ETA: 0s - loss: 1.9673 - accuracy: 0.960212/12 [==============================] - ETA: 0s - loss: 1.9840 - accuracy: 0.9556Epoch 5 took 3.46 seconds
12/12 [==============================] - 3s 288ms/step - loss: 1.9840 - accuracy: 0.9556 - val_loss: 2.3072 - val_accuracy: 0.8250
Round Complete.
  CPU Usage - Avg: 36.10%, Peak: 47.95%, Min: 0.00%
  Memory Usage - Avg: 1332.09 MB, Peak: 1333.81 MB, Min: 1303.03 MB
  Available Memory - Avg: 1533.74 MB, Peak: 1610.06 MB, Min: 1460.48 MB

=== DP Noise Injection (Round 2) ===
Epsilon: 3.0, Noise Type: gaussian
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
WARNING: The input does not fit in a single ciphertext, and some operations will be disabled.
The following operations are disabled in this setup: matmul, matmul_plain, enc_matmul_plain, conv2d_im2col.
If you need to use those operations, try increasing the poly_modulus parameter, to fit your input.
Epoch 1/5
 1/12 [=>............................] - ETA: 2s - loss: 1.9341 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 1.9700 - accuracy: 0.9688 3/12 [======>.......................] - ETA: 2s - loss: 1.9721 - accuracy: 0.9688 4/12 [=========>....................] - ETA: 2s - loss: 1.9912 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 1.9752 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 1.9877 - accuracy: 0.9531 7/12 [================>.............] - ETA: 1s - loss: 1.9769 - accuracy: 0.9554 8/12 [===================>..........] - ETA: 1s - loss: 1.9654 - accuracy: 0.9570 9/12 [=====================>........] - ETA: 0s - loss: 1.9688 - accuracy: 0.951410/12 [========================>.....] - ETA: 0s - loss: 1.9610 - accuracy: 0.953111/12 [==========================>...] - ETA: 0s - loss: 1.9586 - accuracy: 0.948912/12 [==============================] - ETA: 0s - loss: 1.9553 - accuracy: 0.9500Epoch 1 took 3.53 seconds
12/12 [==============================] - 4s 297ms/step - loss: 1.9553 - accuracy: 0.9500 - val_loss: 3.0096 - val_accuracy: 0.5500
Epoch 2/5
 1/12 [=>............................] - ETA: 3s - loss: 1.9427 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 3s - loss: 1.9719 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 3s - loss: 1.9437 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 2s - loss: 1.9217 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 2s - loss: 1.8962 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 2s - loss: 1.9035 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 1.8940 - accuracy: 0.9286 8/12 [===================>..........] - ETA: 1s - loss: 1.9020 - accuracy: 0.9258 9/12 [=====================>........] - ETA: 1s - loss: 1.8828 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 1.8707 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 1.8767 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 1.8730 - accuracy: 0.9361Epoch 2 took 4.26 seconds
12/12 [==============================] - 4s 362ms/step - loss: 1.8730 - accuracy: 0.9361 - val_loss: 2.9926 - val_accuracy: 0.5500
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 1.9569 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 3s - loss: 1.9074 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 1.8878 - accuracy: 0.9167 4/12 [=========>....................] - ETA: 2s - loss: 1.8524 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 1.8291 - accuracy: 0.9187 6/12 [==============>...............] - ETA: 1s - loss: 1.7999 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 1.7914 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 1.7765 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 1.7636 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 1.7676 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 1.7657 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 1.7614 - accuracy: 0.9389Epoch 3 took 3.55 seconds
12/12 [==============================] - 4s 292ms/step - loss: 1.7614 - accuracy: 0.9389 - val_loss: 3.6790 - val_accuracy: 0.5000
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 1.6048 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 3s - loss: 1.7082 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 1.6554 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 1.6596 - accuracy: 0.9609 5/12 [===========>..................] - ETA: 2s - loss: 1.6465 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 1.6512 - accuracy: 0.9583 7/12 [================>.............] - ETA: 1s - loss: 1.6336 - accuracy: 0.9643 8/12 [===================>..........] - ETA: 1s - loss: 1.6200 - accuracy: 0.9688 9/12 [=====================>........] - ETA: 0s - loss: 1.6110 - accuracy: 0.972210/12 [========================>.....] - ETA: 0s - loss: 1.6051 - accuracy: 0.971911/12 [==========================>...] - ETA: 0s - loss: 1.6015 - accuracy: 0.971612/12 [==============================] - ETA: 0s - loss: 1.5989 - accuracy: 0.9722Epoch 4 took 3.53 seconds
12/12 [==============================] - 4s 292ms/step - loss: 1.5989 - accuracy: 0.9722 - val_loss: 4.0905 - val_accuracy: 0.4000
Epoch 5/5
