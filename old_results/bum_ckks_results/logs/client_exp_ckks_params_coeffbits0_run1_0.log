2025-04-15 12:48:41.693288: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:48:41.695543: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:48:41.737926: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:48:41.738314: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:48:42.441452: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 19s - loss: 5.7801 - accuracy: 0.5938 2/12 [====>.........................] - ETA: 2s - loss: 5.9066 - accuracy: 0.7344  3/12 [======>.......................] - ETA: 2s - loss: 5.6969 - accuracy: 0.7812 4/12 [=========>....................] - ETA: 2s - loss: 5.4586 - accuracy: 0.7891 5/12 [===========>..................] - ETA: 1s - loss: 5.3782 - accuracy: 0.7875 6/12 [==============>...............] - ETA: 1s - loss: 5.3098 - accuracy: 0.7969 7/12 [================>.............] - ETA: 1s - loss: 5.2085 - accuracy: 0.8125 8/12 [===================>..........] - ETA: 0s - loss: 5.1714 - accuracy: 0.8203 9/12 [=====================>........] - ETA: 0s - loss: 5.1776 - accuracy: 0.819410/12 [========================>.....] - ETA: 0s - loss: 5.1230 - accuracy: 0.812511/12 [==========================>...] - ETA: 0s - loss: 5.1728 - accuracy: 0.792612/12 [==============================] - ETA: 0s - loss: 5.1483 - accuracy: 0.7944Epoch 1 took 4.50 seconds
12/12 [==============================] - 5s 244ms/step - loss: 5.1483 - accuracy: 0.7944 - val_loss: 4.4021 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1870 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 4.0562 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 2s - loss: 4.2117 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 4.1612 - accuracy: 0.8750 5/12 [===========>..................] - ETA: 1s - loss: 4.3177 - accuracy: 0.8625 6/12 [==============>...............] - ETA: 1s - loss: 4.2762 - accuracy: 0.8698 7/12 [================>.............] - ETA: 1s - loss: 4.2466 - accuracy: 0.8616 8/12 [===================>..........] - ETA: 0s - loss: 4.2331 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 0s - loss: 4.3142 - accuracy: 0.850710/12 [========================>.....] - ETA: 0s - loss: 4.2991 - accuracy: 0.853111/12 [==========================>...] - ETA: 0s - loss: 4.2605 - accuracy: 0.860812/12 [==============================] - ETA: 0s - loss: 4.2463 - accuracy: 0.8639Epoch 2 took 2.57 seconds
12/12 [==============================] - 3s 213ms/step - loss: 4.2463 - accuracy: 0.8639 - val_loss: 4.0623 - val_accuracy: 0.7250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.6097 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.8940 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 2s - loss: 3.8548 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 2s - loss: 3.7801 - accuracy: 0.8906 5/12 [===========>..................] - ETA: 1s - loss: 3.7191 - accuracy: 0.8938 6/12 [==============>...............] - ETA: 1s - loss: 3.7483 - accuracy: 0.8854 7/12 [================>.............] - ETA: 1s - loss: 3.7599 - accuracy: 0.8884 8/12 [===================>..........] - ETA: 1s - loss: 3.7632 - accuracy: 0.8867 9/12 [=====================>........] - ETA: 0s - loss: 3.7350 - accuracy: 0.888910/12 [========================>.....] - ETA: 0s - loss: 3.7318 - accuracy: 0.887511/12 [==========================>...] - ETA: 0s - loss: 3.7059 - accuracy: 0.892012/12 [==============================] - ETA: 0s - loss: 3.6992 - accuracy: 0.8917Epoch 3 took 3.61 seconds
12/12 [==============================] - 4s 306ms/step - loss: 3.6992 - accuracy: 0.8917 - val_loss: 4.2422 - val_accuracy: 0.6250
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2490 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 3.2634 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 3s - loss: 3.2589 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 3.2945 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 3.3213 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 2s - loss: 3.2879 - accuracy: 0.9167 7/12 [================>.............] - ETA: 1s - loss: 3.3012 - accuracy: 0.9107 8/12 [===================>..........] - ETA: 1s - loss: 3.2814 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 1s - loss: 3.2484 - accuracy: 0.923610/12 [========================>.....] - ETA: 0s - loss: 3.2315 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 3.2187 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.2122 - accuracy: 0.9278Epoch 4 took 4.05 seconds
12/12 [==============================] - 4s 338ms/step - loss: 3.2122 - accuracy: 0.9278 - val_loss: 4.3169 - val_accuracy: 0.6000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 2.8847 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 2.8843 - accuracy: 1.0000 3/12 [======>.......................] - ETA: 2s - loss: 2.8661 - accuracy: 1.0000 4/12 [=========>....................] - ETA: 2s - loss: 2.9034 - accuracy: 0.9688 5/12 [===========>..................] - ETA: 2s - loss: 2.8993 - accuracy: 0.9625 6/12 [==============>...............] - ETA: 1s - loss: 2.8879 - accuracy: 0.9635 7/12 [================>.............] - ETA: 1s - loss: 2.8939 - accuracy: 0.9598 8/12 [===================>..........] - ETA: 1s - loss: 2.8887 - accuracy: 0.9609 9/12 [=====================>........] - ETA: 0s - loss: 2.8719 - accuracy: 0.961810/12 [========================>.....] - ETA: 0s - loss: 2.8642 - accuracy: 0.959411/12 [==========================>...] - ETA: 0s - loss: 2.8504 - accuracy: 0.960212/12 [==============================] - ETA: 0s - loss: 2.8459 - accuracy: 0.9611Epoch 5 took 3.55 seconds
12/12 [==============================] - 4s 293ms/step - loss: 2.8459 - accuracy: 0.9611 - val_loss: 4.7526 - val_accuracy: 0.4500
Round Complete.
  CPU Usage - Avg: 42.30%, Peak: 47.95%, Min: 13.72%
  Memory Usage - Avg: 1002.59 MB, Peak: 1045.01 MB, Min: 685.86 MB
  Available Memory - Avg: 2929.81 MB, Peak: 3500.91 MB, Min: 2849.43 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
