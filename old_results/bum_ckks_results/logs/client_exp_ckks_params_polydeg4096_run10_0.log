2025-04-15 08:37:48.082213: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:37:48.084056: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:37:48.125969: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:37:48.126937: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:37:48.780206: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 5.5278 - accuracy: 0.5625 2/12 [====>.........................] - ETA: 1s - loss: 6.3106 - accuracy: 0.6875  3/12 [======>.......................] - ETA: 1s - loss: 7.7266 - accuracy: 0.6875 4/12 [=========>....................] - ETA: 1s - loss: 7.2981 - accuracy: 0.7266 5/12 [===========>..................] - ETA: 1s - loss: 6.8512 - accuracy: 0.7437 6/12 [==============>...............] - ETA: 1s - loss: 6.6935 - accuracy: 0.7031 7/12 [================>.............] - ETA: 1s - loss: 6.4916 - accuracy: 0.7009 8/12 [===================>..........] - ETA: 0s - loss: 6.3365 - accuracy: 0.7031 9/12 [=====================>........] - ETA: 0s - loss: 6.1559 - accuracy: 0.722210/12 [========================>.....] - ETA: 0s - loss: 6.0414 - accuracy: 0.728111/12 [==========================>...] - ETA: 0s - loss: 5.8928 - accuracy: 0.738612/12 [==============================] - ETA: 0s - loss: 5.8518 - accuracy: 0.7444Epoch 1 took 3.82 seconds
12/12 [==============================] - 4s 210ms/step - loss: 5.8518 - accuracy: 0.7444 - val_loss: 4.3987 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.8328 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 4.5704 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 1s - loss: 4.6670 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 4.5674 - accuracy: 0.8672 5/12 [===========>..................] - ETA: 1s - loss: 4.6068 - accuracy: 0.8438 6/12 [==============>...............] - ETA: 1s - loss: 4.5405 - accuracy: 0.8490 7/12 [================>.............] - ETA: 0s - loss: 4.5015 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 0s - loss: 4.4558 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 0s - loss: 4.4677 - accuracy: 0.843810/12 [========================>.....] - ETA: 0s - loss: 4.4343 - accuracy: 0.831311/12 [==========================>...] - ETA: 0s - loss: 4.3944 - accuracy: 0.832412/12 [==============================] - ETA: 0s - loss: 4.3788 - accuracy: 0.8361Epoch 2 took 2.22 seconds
12/12 [==============================] - 2s 184ms/step - loss: 4.3788 - accuracy: 0.8361 - val_loss: 4.1225 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.8874 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 3.7235 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 1s - loss: 3.7330 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.6721 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 1s - loss: 3.6855 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.6867 - accuracy: 0.9271 7/12 [================>.............] - ETA: 0s - loss: 3.6818 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 0s - loss: 3.6724 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 0s - loss: 3.6536 - accuracy: 0.923610/12 [========================>.....] - ETA: 0s - loss: 3.6611 - accuracy: 0.918711/12 [==========================>...] - ETA: 0s - loss: 3.6474 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.6426 - accuracy: 0.9194Epoch 3 took 2.24 seconds
12/12 [==============================] - 2s 186ms/step - loss: 3.6426 - accuracy: 0.9194 - val_loss: 4.3173 - val_accuracy: 0.5750
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.2934 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 1s - loss: 3.3585 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 1s - loss: 3.3679 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 1s - loss: 3.3853 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 1s - loss: 3.3585 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 1s - loss: 3.3458 - accuracy: 0.9219 7/12 [================>.............] - ETA: 0s - loss: 3.3321 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 0s - loss: 3.3225 - accuracy: 0.9180 9/12 [=====================>........] - ETA: 0s - loss: 3.3088 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.2983 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.2755 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.2701 - accuracy: 0.9222Epoch 4 took 2.36 seconds
12/12 [==============================] - 2s 197ms/step - loss: 3.2701 - accuracy: 0.9222 - val_loss: 4.5740 - val_accuracy: 0.6000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 2.9993 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 3.0797 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.0269 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 3.0185 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 2s - loss: 3.0230 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 2.9952 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 2.9929 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 3.0239 - accuracy: 0.9336 9/12 [=====================>........] - ETA: 0s - loss: 3.0144 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 3.0091 - accuracy: 0.934411/12 [==========================>...] - ETA: 0s - loss: 2.9890 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 2.9825 - accuracy: 0.9389Epoch 5 took 3.33 seconds
12/12 [==============================] - 3s 273ms/step - loss: 2.9825 - accuracy: 0.9389 - val_loss: 4.9505 - val_accuracy: 0.2500
Round Complete.
  CPU Usage - Avg: 40.80%, Peak: 48.20%, Min: 1.75%
  Memory Usage - Avg: 947.77 MB, Peak: 999.10 MB, Min: 660.41 MB
  Available Memory - Avg: 2950.37 MB, Peak: 3513.44 MB, Min: 2849.18 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
