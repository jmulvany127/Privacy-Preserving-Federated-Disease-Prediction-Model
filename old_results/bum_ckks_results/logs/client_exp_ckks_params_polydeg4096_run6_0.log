2025-04-15 08:29:24.799700: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:29:24.801519: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:29:24.842303: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:29:24.842718: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:29:25.436955: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 6.4666 - accuracy: 0.3750 2/12 [====>.........................] - ETA: 1s - loss: 7.4388 - accuracy: 0.5625  3/12 [======>.......................] - ETA: 1s - loss: 7.0140 - accuracy: 0.6146 4/12 [=========>....................] - ETA: 1s - loss: 6.7513 - accuracy: 0.6797 5/12 [===========>..................] - ETA: 1s - loss: 6.4845 - accuracy: 0.6875 6/12 [==============>...............] - ETA: 1s - loss: 6.1881 - accuracy: 0.7031 7/12 [================>.............] - ETA: 0s - loss: 6.0037 - accuracy: 0.7143 8/12 [===================>..........] - ETA: 0s - loss: 5.8316 - accuracy: 0.7266 9/12 [=====================>........] - ETA: 0s - loss: 5.6936 - accuracy: 0.736110/12 [========================>.....] - ETA: 0s - loss: 5.5742 - accuracy: 0.743711/12 [==========================>...] - ETA: 0s - loss: 5.4864 - accuracy: 0.750012/12 [==============================] - ETA: 0s - loss: 5.4579 - accuracy: 0.7528Epoch 1 took 3.79 seconds
12/12 [==============================] - 4s 213ms/step - loss: 5.4579 - accuracy: 0.7528 - val_loss: 4.6003 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.4064 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 1s - loss: 4.5258 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 1s - loss: 4.3615 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 1s - loss: 4.2893 - accuracy: 0.8906 5/12 [===========>..................] - ETA: 1s - loss: 4.2945 - accuracy: 0.8813 6/12 [==============>...............] - ETA: 1s - loss: 4.3558 - accuracy: 0.8594 7/12 [================>.............] - ETA: 0s - loss: 4.3258 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 0s - loss: 4.2901 - accuracy: 0.8594 9/12 [=====================>........] - ETA: 0s - loss: 4.2338 - accuracy: 0.871510/12 [========================>.....] - ETA: 0s - loss: 4.2291 - accuracy: 0.875011/12 [==========================>...] - ETA: 0s - loss: 4.2305 - accuracy: 0.880712/12 [==============================] - ETA: 0s - loss: 4.2180 - accuracy: 0.8833Epoch 2 took 2.27 seconds
12/12 [==============================] - 2s 191ms/step - loss: 4.2180 - accuracy: 0.8833 - val_loss: 4.7774 - val_accuracy: 0.6000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.8552 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 1s - loss: 4.3659 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 1s - loss: 4.1858 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 1s - loss: 4.1653 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 4.1174 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 4.0226 - accuracy: 0.9219 7/12 [================>.............] - ETA: 1s - loss: 3.9707 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 0s - loss: 3.9215 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 0s - loss: 3.9233 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 3.9073 - accuracy: 0.918711/12 [==========================>...] - ETA: 0s - loss: 3.9091 - accuracy: 0.911912/12 [==============================] - ETA: 0s - loss: 3.8992 - accuracy: 0.9111Epoch 3 took 2.33 seconds
12/12 [==============================] - 2s 194ms/step - loss: 3.8992 - accuracy: 0.9111 - val_loss: 5.4360 - val_accuracy: 0.2000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.3159 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 1s - loss: 3.3711 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 1s - loss: 3.3957 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 1s - loss: 3.4022 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 1s - loss: 3.4090 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 3.5128 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 3.4652 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 3.4319 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 0s - loss: 3.4265 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 3.3971 - accuracy: 0.943811/12 [==========================>...] - ETA: 0s - loss: 3.4269 - accuracy: 0.940312/12 [==============================] - ETA: 0s - loss: 3.4245 - accuracy: 0.9389Epoch 4 took 3.19 seconds
12/12 [==============================] - 3s 271ms/step - loss: 3.4245 - accuracy: 0.9389 - val_loss: 5.9054 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.1659 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 3.1845 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.1419 - accuracy: 0.9583 4/12 [=========>....................] - ETA: 2s - loss: 3.1593 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 2s - loss: 3.1296 - accuracy: 0.9500 6/12 [==============>...............] - ETA: 1s - loss: 3.1157 - accuracy: 0.9479 7/12 [================>.............] - ETA: 1s - loss: 3.0938 - accuracy: 0.9509 8/12 [===================>..........] - ETA: 1s - loss: 3.1182 - accuracy: 0.9453 9/12 [=====================>........] - ETA: 0s - loss: 3.1247 - accuracy: 0.944410/12 [========================>.....] - ETA: 0s - loss: 3.0973 - accuracy: 0.950011/12 [==========================>...] - ETA: 0s - loss: 3.1096 - accuracy: 0.943212/12 [==============================] - ETA: 0s - loss: 3.1027 - accuracy: 0.9444Epoch 5 took 3.53 seconds
12/12 [==============================] - 4s 295ms/step - loss: 3.1027 - accuracy: 0.9444 - val_loss: 6.3736 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 30.22%, Peak: 48.70%, Min: 0.00%
  Memory Usage - Avg: 955.65 MB, Peak: 988.71 MB, Min: 663.90 MB
  Available Memory - Avg: 3081.13 MB, Peak: 3559.40 MB, Min: 2850.35 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
