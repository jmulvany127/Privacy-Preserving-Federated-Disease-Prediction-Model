2025-04-14 21:42:06.775567: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-14 21:42:06.781655: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:42:06.915804: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:42:06.916704: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-14 21:42:08.430205: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 36s - loss: 5.6117 - accuracy: 0.6875 2/12 [====>.........................] - ETA: 4s - loss: 5.6213 - accuracy: 0.7500  3/12 [======>.......................] - ETA: 3s - loss: 6.1242 - accuracy: 0.7396 4/12 [=========>....................] - ETA: 3s - loss: 5.8971 - accuracy: 0.7656 5/12 [===========>..................] - ETA: 2s - loss: 5.7279 - accuracy: 0.7688 6/12 [==============>...............] - ETA: 2s - loss: 5.5056 - accuracy: 0.7917 7/12 [================>.............] - ETA: 1s - loss: 5.3307 - accuracy: 0.8125 8/12 [===================>..........] - ETA: 1s - loss: 5.3187 - accuracy: 0.8203 9/12 [=====================>........] - ETA: 1s - loss: 5.3094 - accuracy: 0.819410/12 [========================>.....] - ETA: 0s - loss: 5.3041 - accuracy: 0.815611/12 [==========================>...] - ETA: 0s - loss: 5.2775 - accuracy: 0.806812/12 [==============================] - ETA: 0s - loss: 5.2535 - accuracy: 0.8083Epoch 1 took 7.75 seconds
12/12 [==============================] - 8s 405ms/step - loss: 5.2535 - accuracy: 0.8083 - val_loss: 4.4696 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.9340 - accuracy: 0.7188 2/12 [====>.........................] - ETA: 2s - loss: 4.6654 - accuracy: 0.7656 3/12 [======>.......................] - ETA: 2s - loss: 4.6381 - accuracy: 0.7812 4/12 [=========>....................] - ETA: 1s - loss: 4.5607 - accuracy: 0.8047 5/12 [===========>..................] - ETA: 1s - loss: 4.5090 - accuracy: 0.8313 6/12 [==============>...............] - ETA: 1s - loss: 4.4929 - accuracy: 0.8385 7/12 [================>.............] - ETA: 1s - loss: 4.4337 - accuracy: 0.8527 8/12 [===================>..........] - ETA: 0s - loss: 4.3559 - accuracy: 0.8672 9/12 [=====================>........] - ETA: 0s - loss: 4.3599 - accuracy: 0.868110/12 [========================>.....] - ETA: 0s - loss: 4.3201 - accuracy: 0.868711/12 [==========================>...] - ETA: 0s - loss: 4.2551 - accuracy: 0.880712/12 [==============================] - ETA: 0s - loss: 4.2652 - accuracy: 0.8806Epoch 2 took 3.30 seconds
12/12 [==============================] - 3s 277ms/step - loss: 4.2652 - accuracy: 0.8806 - val_loss: 4.0244 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.8384 - accuracy: 0.7500 2/12 [====>.........................] - ETA: 3s - loss: 4.8107 - accuracy: 0.7031 3/12 [======>.......................] - ETA: 3s - loss: 4.4297 - accuracy: 0.7708 4/12 [=========>....................] - ETA: 3s - loss: 4.2860 - accuracy: 0.7891 5/12 [===========>..................] - ETA: 2s - loss: 4.1379 - accuracy: 0.8188 6/12 [==============>...............] - ETA: 2s - loss: 4.0456 - accuracy: 0.8281 7/12 [================>.............] - ETA: 4s - loss: 4.0430 - accuracy: 0.8393 8/12 [===================>..........] - ETA: 3s - loss: 4.0016 - accuracy: 0.8477 9/12 [=====================>........] - ETA: 2s - loss: 3.9809 - accuracy: 0.850710/12 [========================>.....] - ETA: 1s - loss: 3.9236 - accuracy: 0.856211/12 [==========================>...] - ETA: 0s - loss: 3.8722 - accuracy: 0.863612/12 [==============================] - ETA: 0s - loss: 3.8626 - accuracy: 0.8639Epoch 3 took 7.50 seconds
12/12 [==============================] - 8s 658ms/step - loss: 3.8626 - accuracy: 0.8639 - val_loss: 3.7838 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2390 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 3.3524 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 3.3690 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.4124 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 1s - loss: 3.3580 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.3325 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 3.3189 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 3.3093 - accuracy: 0.9336 9/12 [=====================>........] - ETA: 0s - loss: 3.3007 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 3.2968 - accuracy: 0.928111/12 [==========================>...] - ETA: 0s - loss: 3.2810 - accuracy: 0.929012/12 [==============================] - ETA: 0s - loss: 3.2990 - accuracy: 0.9250Epoch 4 took 3.15 seconds
12/12 [==============================] - 3s 256ms/step - loss: 3.2990 - accuracy: 0.9250 - val_loss: 3.6649 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.0023 - accuracy: 1.0000 2/12 [====>.........................] - ETA: 2s - loss: 3.1166 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 3.1019 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 2s - loss: 3.1883 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.2860 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 3.2652 - accuracy: 0.8906 7/12 [================>.............] - ETA: 1s - loss: 3.2080 - accuracy: 0.9062 8/12 [===================>..........] - ETA: 1s - loss: 3.1699 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.1329 - accuracy: 0.923610/12 [========================>.....] - ETA: 0s - loss: 3.1017 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.0783 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 3.0723 - accuracy: 0.9361Epoch 5 took 3.35 seconds
12/12 [==============================] - 3s 281ms/step - loss: 3.0723 - accuracy: 0.9361 - val_loss: 3.2582 - val_accuracy: 0.8250
Round Complete.
  CPU Usage - Avg: 42.31%, Peak: 50.23%, Min: 13.25%
  Memory Usage - Avg: 945.76 MB, Peak: 998.77 MB, Min: 659.44 MB
  Available Memory - Avg: 2670.23 MB, Peak: 3239.26 MB, Min: 2552.10 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
