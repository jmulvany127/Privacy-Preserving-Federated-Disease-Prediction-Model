2025-04-15 12:52:54.104491: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:52:54.106303: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:52:54.147564: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:52:54.148225: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:52:54.862688: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 19s - loss: 5.2165 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 6.7872 - accuracy: 0.5469  3/12 [======>.......................] - ETA: 1s - loss: 6.4734 - accuracy: 0.6458 4/12 [=========>....................] - ETA: 1s - loss: 6.5800 - accuracy: 0.7031 5/12 [===========>..................] - ETA: 1s - loss: 6.8765 - accuracy: 0.6875 6/12 [==============>...............] - ETA: 1s - loss: 6.7042 - accuracy: 0.6823 7/12 [================>.............] - ETA: 1s - loss: 6.4591 - accuracy: 0.6786 8/12 [===================>..........] - ETA: 0s - loss: 6.3966 - accuracy: 0.6484 9/12 [=====================>........] - ETA: 0s - loss: 6.2421 - accuracy: 0.649310/12 [========================>.....] - ETA: 0s - loss: 6.0660 - accuracy: 0.665611/12 [==========================>...] - ETA: 0s - loss: 5.9115 - accuracy: 0.681812/12 [==============================] - ETA: 0s - loss: 5.8964 - accuracy: 0.6861Epoch 1 took 4.57 seconds
12/12 [==============================] - 5s 251ms/step - loss: 5.8964 - accuracy: 0.6861 - val_loss: 4.5103 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.7573 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 4.6243 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 1s - loss: 4.4784 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 1s - loss: 4.4143 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.4394 - accuracy: 0.8625 6/12 [==============>...............] - ETA: 1s - loss: 4.4087 - accuracy: 0.8698 7/12 [================>.............] - ETA: 1s - loss: 4.3417 - accuracy: 0.8839 8/12 [===================>..........] - ETA: 0s - loss: 4.3342 - accuracy: 0.8867 9/12 [=====================>........] - ETA: 0s - loss: 4.3493 - accuracy: 0.871510/12 [========================>.....] - ETA: 0s - loss: 4.3458 - accuracy: 0.865611/12 [==========================>...] - ETA: 0s - loss: 4.3093 - accuracy: 0.869312/12 [==============================] - ETA: 0s - loss: 4.3111 - accuracy: 0.8694Epoch 2 took 2.64 seconds
12/12 [==============================] - 3s 221ms/step - loss: 4.3111 - accuracy: 0.8694 - val_loss: 4.2369 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 3s - loss: 3.8775 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 3.8736 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.8619 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 3.8762 - accuracy: 0.9297 5/12 [===========>..................] - ETA: 2s - loss: 3.8557 - accuracy: 0.9375 6/12 [==============>...............] - ETA: 2s - loss: 3.8315 - accuracy: 0.9427 7/12 [================>.............] - ETA: 1s - loss: 3.8391 - accuracy: 0.9330 8/12 [===================>..........] - ETA: 1s - loss: 3.8370 - accuracy: 0.9297 9/12 [=====================>........] - ETA: 1s - loss: 3.8507 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.8303 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.8129 - accuracy: 0.914812/12 [==============================] - ETA: 0s - loss: 3.8152 - accuracy: 0.9111Epoch 3 took 3.92 seconds
12/12 [==============================] - 4s 327ms/step - loss: 3.8152 - accuracy: 0.9111 - val_loss: 3.9388 - val_accuracy: 0.8750
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.5571 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 3.5805 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 2s - loss: 3.5346 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.5074 - accuracy: 0.9375 5/12 [===========>..................] - ETA: 2s - loss: 3.4965 - accuracy: 0.9438 6/12 [==============>...............] - ETA: 1s - loss: 3.4882 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 3.4861 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 3.4815 - accuracy: 0.9336 9/12 [=====================>........] - ETA: 0s - loss: 3.4772 - accuracy: 0.934010/12 [========================>.....] - ETA: 0s - loss: 3.4645 - accuracy: 0.934411/12 [==========================>...] - ETA: 0s - loss: 3.4505 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 3.4559 - accuracy: 0.9306Epoch 4 took 3.70 seconds
12/12 [==============================] - 4s 308ms/step - loss: 3.4559 - accuracy: 0.9306 - val_loss: 3.6955 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2121 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.2505 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 2s - loss: 3.2753 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 2s - loss: 3.2756 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 3.2513 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.2475 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 3.2216 - accuracy: 0.9464 8/12 [===================>..........] - ETA: 1s - loss: 3.2271 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.2212 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 3.2273 - accuracy: 0.934411/12 [==========================>...] - ETA: 0s - loss: 3.2105 - accuracy: 0.934712/12 [==============================] - ETA: 0s - loss: 3.2053 - accuracy: 0.9361Epoch 5 took 3.49 seconds
12/12 [==============================] - 3s 289ms/step - loss: 3.2053 - accuracy: 0.9361 - val_loss: 3.4400 - val_accuracy: 0.8250
Round Complete.
  CPU Usage - Avg: 42.29%, Peak: 48.17%, Min: 21.48%
  Memory Usage - Avg: 971.53 MB, Peak: 1007.79 MB, Min: 687.34 MB
  Available Memory - Avg: 2954.15 MB, Peak: 3495.80 MB, Min: 2870.58 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
