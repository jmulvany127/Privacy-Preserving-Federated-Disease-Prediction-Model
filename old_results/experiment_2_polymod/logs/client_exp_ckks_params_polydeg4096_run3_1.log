2025-04-14 21:47:59.427135: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-14 21:47:59.430777: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:47:59.489463: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-14 21:47:59.490763: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-14 21:48:00.337773: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 38s - loss: 5.8841 - accuracy: 0.3438 2/12 [====>.........................] - ETA: 3s - loss: 6.4120 - accuracy: 0.5000  3/12 [======>.......................] - ETA: 3s - loss: 5.9629 - accuracy: 0.6250 4/12 [=========>....................] - ETA: 2s - loss: 6.1152 - accuracy: 0.6641 5/12 [===========>..................] - ETA: 2s - loss: 6.2311 - accuracy: 0.6687 6/12 [==============>...............] - ETA: 2s - loss: 6.0507 - accuracy: 0.6823 7/12 [================>.............] - ETA: 1s - loss: 5.8863 - accuracy: 0.7009 8/12 [===================>..........] - ETA: 1s - loss: 5.8750 - accuracy: 0.6914 9/12 [=====================>........] - ETA: 1s - loss: 5.7637 - accuracy: 0.708310/12 [========================>.....] - ETA: 0s - loss: 5.7305 - accuracy: 0.718811/12 [==========================>...] - ETA: 0s - loss: 5.6414 - accuracy: 0.730112/12 [==============================] - ETA: 0s - loss: 5.6056 - accuracy: 0.7361Epoch 1 took 7.83 seconds
12/12 [==============================] - 8s 391ms/step - loss: 5.6056 - accuracy: 0.7361 - val_loss: 4.5806 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.6223 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 2s - loss: 4.6703 - accuracy: 0.7969 3/12 [======>.......................] - ETA: 2s - loss: 4.6009 - accuracy: 0.8125 4/12 [=========>....................] - ETA: 2s - loss: 4.6499 - accuracy: 0.7969 5/12 [===========>..................] - ETA: 1s - loss: 4.6341 - accuracy: 0.8000 6/12 [==============>...............] - ETA: 1s - loss: 4.5827 - accuracy: 0.8073 7/12 [================>.............] - ETA: 1s - loss: 4.5063 - accuracy: 0.8214 8/12 [===================>..........] - ETA: 1s - loss: 4.4632 - accuracy: 0.8281 9/12 [=====================>........] - ETA: 0s - loss: 4.5037 - accuracy: 0.829910/12 [========================>.....] - ETA: 0s - loss: 4.4989 - accuracy: 0.837511/12 [==========================>...] - ETA: 0s - loss: 4.4856 - accuracy: 0.840912/12 [==============================] - ETA: 0s - loss: 4.4806 - accuracy: 0.8417Epoch 2 took 3.11 seconds
12/12 [==============================] - 3s 264ms/step - loss: 4.4806 - accuracy: 0.8417 - val_loss: 4.1774 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1110 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.9777 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 16s - loss: 3.9553 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 10s - loss: 3.9111 - accuracy: 0.9062 5/12 [===========>..................] - ETA: 7s - loss: 3.9247 - accuracy: 0.8938  6/12 [==============>...............] - ETA: 5s - loss: 4.1245 - accuracy: 0.8750 7/12 [================>.............] - ETA: 4s - loss: 4.0773 - accuracy: 0.8705 8/12 [===================>..........] - ETA: 2s - loss: 4.0333 - accuracy: 0.8711 9/12 [=====================>........] - ETA: 2s - loss: 4.0324 - accuracy: 0.861110/12 [========================>.....] - ETA: 1s - loss: 3.9993 - accuracy: 0.862511/12 [==========================>...] - ETA: 0s - loss: 3.9628 - accuracy: 0.872212/12 [==============================] - ETA: 0s - loss: 3.9592 - accuracy: 0.8694Epoch 3 took 6.53 seconds
12/12 [==============================] - 7s 570ms/step - loss: 3.9592 - accuracy: 0.8694 - val_loss: 3.8697 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.5620 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 2s - loss: 3.5589 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.5237 - accuracy: 0.9479 4/12 [=========>....................] - ETA: 2s - loss: 3.5215 - accuracy: 0.9375 5/12 [===========>..................] - ETA: 2s - loss: 3.5604 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.6436 - accuracy: 0.9010 7/12 [================>.............] - ETA: 1s - loss: 3.6420 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 1s - loss: 3.6102 - accuracy: 0.9023 9/12 [=====================>........] - ETA: 0s - loss: 3.6113 - accuracy: 0.899310/12 [========================>.....] - ETA: 0s - loss: 3.6018 - accuracy: 0.890611/12 [==========================>...] - ETA: 0s - loss: 3.5787 - accuracy: 0.892012/12 [==============================] - ETA: 0s - loss: 3.5723 - accuracy: 0.8917Epoch 4 took 4.43 seconds
12/12 [==============================] - 4s 378ms/step - loss: 3.5723 - accuracy: 0.8917 - val_loss: 3.6248 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 5s - loss: 3.2487 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 5s - loss: 3.2384 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 5s - loss: 3.2443 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 4s - loss: 3.2541 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 3s - loss: 3.2164 - accuracy: 0.9375 6/12 [==============>...............] - ETA: 3s - loss: 3.2140 - accuracy: 0.9271 7/12 [================>.............] - ETA: 2s - loss: 3.2086 - accuracy: 0.9196 8/12 [===================>..........] - ETA: 2s - loss: 3.1856 - accuracy: 0.9258 9/12 [=====================>........] - ETA: 1s - loss: 3.1665 - accuracy: 0.934010/12 [========================>.....] - ETA: 1s - loss: 3.1719 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.1627 - accuracy: 0.929012/12 [==============================] - ETA: 0s - loss: 3.1601 - accuracy: 0.9306Epoch 5 took 6.49 seconds
12/12 [==============================] - 6s 544ms/step - loss: 3.1601 - accuracy: 0.9306 - val_loss: 3.6639 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 45.35%, Peak: 53.48%, Min: 19.73%
  Memory Usage - Avg: 943.80 MB, Peak: 1001.71 MB, Min: 644.59 MB
  Available Memory - Avg: 2786.79 MB, Peak: 3323.03 MB, Min: 2664.66 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
