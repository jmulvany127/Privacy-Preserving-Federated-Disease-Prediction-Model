2025-04-15 08:29:24.812717: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:29:24.814580: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:29:24.855482: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:29:24.856264: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:29:25.455674: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 15s - loss: 5.8950 - accuracy: 0.4375 2/12 [====>.........................] - ETA: 1s - loss: 8.7920 - accuracy: 0.5781  3/12 [======>.......................] - ETA: 1s - loss: 8.8527 - accuracy: 0.6458 4/12 [=========>....................] - ETA: 1s - loss: 8.1571 - accuracy: 0.7031 5/12 [===========>..................] - ETA: 1s - loss: 7.6694 - accuracy: 0.7312 6/12 [==============>...............] - ETA: 1s - loss: 7.2350 - accuracy: 0.7344 7/12 [================>.............] - ETA: 0s - loss: 6.9898 - accuracy: 0.7143 8/12 [===================>..........] - ETA: 0s - loss: 6.7565 - accuracy: 0.7031 9/12 [=====================>........] - ETA: 0s - loss: 6.5291 - accuracy: 0.701410/12 [========================>.....] - ETA: 0s - loss: 6.3400 - accuracy: 0.709411/12 [==========================>...] - ETA: 0s - loss: 6.1737 - accuracy: 0.721612/12 [==============================] - ETA: 0s - loss: 6.1290 - accuracy: 0.7250Epoch 1 took 3.83 seconds
12/12 [==============================] - 4s 219ms/step - loss: 6.1290 - accuracy: 0.7250 - val_loss: 4.4588 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 5.0250 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 2s - loss: 4.6805 - accuracy: 0.8438 3/12 [======>.......................] - ETA: 1s - loss: 4.7993 - accuracy: 0.8229 4/12 [=========>....................] - ETA: 1s - loss: 4.7007 - accuracy: 0.8359 5/12 [===========>..................] - ETA: 1s - loss: 4.6662 - accuracy: 0.8313 6/12 [==============>...............] - ETA: 1s - loss: 4.5670 - accuracy: 0.8438 7/12 [================>.............] - ETA: 0s - loss: 4.5480 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 0s - loss: 4.5144 - accuracy: 0.8438 9/12 [=====================>........] - ETA: 0s - loss: 4.4543 - accuracy: 0.843810/12 [========================>.....] - ETA: 0s - loss: 4.4390 - accuracy: 0.850011/12 [==========================>...] - ETA: 0s - loss: 4.4251 - accuracy: 0.843812/12 [==============================] - ETA: 0s - loss: 4.4270 - accuracy: 0.8417Epoch 2 took 2.22 seconds
12/12 [==============================] - 2s 184ms/step - loss: 4.4270 - accuracy: 0.8417 - val_loss: 4.3342 - val_accuracy: 0.6500
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.8658 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.9420 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 3.9190 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 3.8679 - accuracy: 0.8750 5/12 [===========>..................] - ETA: 1s - loss: 3.8687 - accuracy: 0.8562 6/12 [==============>...............] - ETA: 1s - loss: 3.8632 - accuracy: 0.8490 7/12 [================>.............] - ETA: 1s - loss: 3.8254 - accuracy: 0.8616 8/12 [===================>..........] - ETA: 0s - loss: 3.8281 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 0s - loss: 3.8248 - accuracy: 0.871510/12 [========================>.....] - ETA: 0s - loss: 3.8228 - accuracy: 0.878111/12 [==========================>...] - ETA: 0s - loss: 3.8147 - accuracy: 0.883512/12 [==============================] - ETA: 0s - loss: 3.8312 - accuracy: 0.8750Epoch 3 took 2.26 seconds
12/12 [==============================] - 2s 188ms/step - loss: 3.8312 - accuracy: 0.8750 - val_loss: 4.7128 - val_accuracy: 0.4500
Epoch 4/5
 1/12 [=>............................] - ETA: 1s - loss: 3.4846 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 3.4665 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 3.4217 - accuracy: 0.9271 4/12 [=========>....................] - ETA: 1s - loss: 3.3988 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.3727 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.4238 - accuracy: 0.9167 7/12 [================>.............] - ETA: 1s - loss: 3.3925 - accuracy: 0.9286 8/12 [===================>..........] - ETA: 1s - loss: 3.3802 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 0s - loss: 3.3679 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.3771 - accuracy: 0.909411/12 [==========================>...] - ETA: 0s - loss: 3.3587 - accuracy: 0.909112/12 [==============================] - ETA: 0s - loss: 3.3502 - accuracy: 0.9111Epoch 4 took 3.16 seconds
12/12 [==============================] - 3s 271ms/step - loss: 3.3502 - accuracy: 0.9111 - val_loss: 5.7528 - val_accuracy: 0.2000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.1047 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 3s - loss: 3.0684 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.1040 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 3.0880 - accuracy: 0.9375 5/12 [===========>..................] - ETA: 2s - loss: 3.0741 - accuracy: 0.9375 6/12 [==============>...............] - ETA: 1s - loss: 3.0709 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 3.0988 - accuracy: 0.9286 8/12 [===================>..........] - ETA: 1s - loss: 3.0926 - accuracy: 0.9219 9/12 [=====================>........] - ETA: 0s - loss: 3.0620 - accuracy: 0.930610/12 [========================>.....] - ETA: 0s - loss: 3.0333 - accuracy: 0.937511/12 [==========================>...] - ETA: 0s - loss: 3.0509 - accuracy: 0.931812/12 [==============================] - ETA: 0s - loss: 3.0442 - accuracy: 0.9333Epoch 5 took 3.53 seconds
12/12 [==============================] - 4s 296ms/step - loss: 3.0442 - accuracy: 0.9333 - val_loss: 8.5147 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 41.18%, Peak: 48.70%, Min: 2.25%
  Memory Usage - Avg: 948.45 MB, Peak: 995.65 MB, Min: 660.60 MB
  Available Memory - Avg: 2947.13 MB, Peak: 3497.39 MB, Min: 2851.33 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
