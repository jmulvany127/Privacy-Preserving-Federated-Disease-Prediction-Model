2025-04-15 08:21:09.142508: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:21:09.144319: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:21:09.180270: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:21:09.180663: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:21:09.788694: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 6.1287 - accuracy: 0.4375 2/12 [====>.........................] - ETA: 1s - loss: 7.0067 - accuracy: 0.6250  3/12 [======>.......................] - ETA: 1s - loss: 6.7150 - accuracy: 0.6979 4/12 [=========>....................] - ETA: 1s - loss: 7.1828 - accuracy: 0.6875 5/12 [===========>..................] - ETA: 1s - loss: 7.0707 - accuracy: 0.6938 6/12 [==============>...............] - ETA: 1s - loss: 6.8455 - accuracy: 0.6979 7/12 [================>.............] - ETA: 0s - loss: 6.6096 - accuracy: 0.6920 8/12 [===================>..........] - ETA: 0s - loss: 6.4084 - accuracy: 0.6875 9/12 [=====================>........] - ETA: 0s - loss: 6.2684 - accuracy: 0.680610/12 [========================>.....] - ETA: 0s - loss: 6.0821 - accuracy: 0.693811/12 [==========================>...] - ETA: 0s - loss: 5.9111 - accuracy: 0.713112/12 [==============================] - ETA: 0s - loss: 5.8672 - accuracy: 0.7194Epoch 1 took 3.77 seconds
12/12 [==============================] - 4s 204ms/step - loss: 5.8672 - accuracy: 0.7194 - val_loss: 4.3680 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 1s - loss: 4.6494 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 1s - loss: 4.4510 - accuracy: 0.8906 3/12 [======>.......................] - ETA: 1s - loss: 4.5479 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 1s - loss: 4.6202 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 4.5063 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 1s - loss: 4.4173 - accuracy: 0.8750 7/12 [================>.............] - ETA: 0s - loss: 4.3455 - accuracy: 0.8795 8/12 [===================>..........] - ETA: 0s - loss: 4.3280 - accuracy: 0.8594 9/12 [=====================>........] - ETA: 0s - loss: 4.2848 - accuracy: 0.861110/12 [========================>.....] - ETA: 0s - loss: 4.3038 - accuracy: 0.840611/12 [==========================>...] - ETA: 0s - loss: 4.2458 - accuracy: 0.849412/12 [==============================] - ETA: 0s - loss: 4.2492 - accuracy: 0.8500Epoch 2 took 2.30 seconds
12/12 [==============================] - 2s 194ms/step - loss: 4.2492 - accuracy: 0.8500 - val_loss: 4.0242 - val_accuracy: 0.7250
Epoch 3/5
 1/12 [=>............................] - ETA: 1s - loss: 3.7574 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 3.8768 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 3.7406 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 3.7420 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 1s - loss: 3.9092 - accuracy: 0.8750 6/12 [==============>...............] - ETA: 1s - loss: 3.9097 - accuracy: 0.8594 7/12 [================>.............] - ETA: 0s - loss: 3.8805 - accuracy: 0.8571 8/12 [===================>..........] - ETA: 0s - loss: 3.8424 - accuracy: 0.8594 9/12 [=====================>........] - ETA: 0s - loss: 3.8244 - accuracy: 0.861110/12 [========================>.....] - ETA: 0s - loss: 3.8042 - accuracy: 0.868711/12 [==========================>...] - ETA: 0s - loss: 3.7685 - accuracy: 0.8750Epoch 3 took 2.26 seconds
12/12 [==============================] - 2s 189ms/step - loss: 3.7564 - accuracy: 0.8778 - val_loss: 4.3103 - val_accuracy: 0.6250
Epoch 4/5
 1/12 [=>............................] - ETA: 1s - loss: 3.6542 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 2s - loss: 3.4458 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 1s - loss: 3.3800 - accuracy: 0.8958 4/12 [=========>....................] - ETA: 1s - loss: 3.3190 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.3415 - accuracy: 0.9000 6/12 [==============>...............] - ETA: 1s - loss: 3.3014 - accuracy: 0.9115 7/12 [================>.............] - ETA: 0s - loss: 3.2857 - accuracy: 0.9152 8/12 [===================>..........] - ETA: 0s - loss: 3.2761 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 0s - loss: 3.2459 - accuracy: 0.920110/12 [========================>.....] - ETA: 0s - loss: 3.2498 - accuracy: 0.915611/12 [==========================>...] - ETA: 0s - loss: 3.2463 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.2444 - accuracy: 0.9167Epoch 4 took 2.39 seconds
12/12 [==============================] - 2s 201ms/step - loss: 3.2444 - accuracy: 0.9167 - val_loss: 5.1220 - val_accuracy: 0.2750
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 2.9506 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 2s - loss: 3.0751 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 2s - loss: 3.0731 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 3.0324 - accuracy: 0.9453 5/12 [===========>..................] - ETA: 1s - loss: 3.0039 - accuracy: 0.9375 6/12 [==============>...............] - ETA: 1s - loss: 2.9818 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 2.9759 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 2.9656 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 0s - loss: 2.9505 - accuracy: 0.937510/12 [========================>.....] - ETA: 0s - loss: 2.9422 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 2.9237 - accuracy: 0.931812/12 [==============================] - ETA: 0s - loss: 2.9210 - accuracy: 0.9333Epoch 5 took 3.33 seconds
12/12 [==============================] - 3s 285ms/step - loss: 2.9210 - accuracy: 0.9333 - val_loss: 8.0656 - val_accuracy: 0.2000
Round Complete.
  CPU Usage - Avg: 40.98%, Peak: 46.95%, Min: 4.50%
  Memory Usage - Avg: 946.51 MB, Peak: 996.36 MB, Min: 663.09 MB
  Available Memory - Avg: 2979.96 MB, Peak: 3501.35 MB, Min: 2884.83 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
