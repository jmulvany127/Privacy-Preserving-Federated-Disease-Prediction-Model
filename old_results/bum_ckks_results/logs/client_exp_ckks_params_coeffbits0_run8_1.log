2025-04-15 13:03:22.288014: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 13:03:22.290361: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:03:22.327978: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:03:22.328387: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 13:03:23.036797: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 1 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 1 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 19s - loss: 5.9296 - accuracy: 0.5000 2/12 [====>.........................] - ETA: 2s - loss: 6.4756 - accuracy: 0.5625  3/12 [======>.......................] - ETA: 2s - loss: 6.7728 - accuracy: 0.5521 4/12 [=========>....................] - ETA: 2s - loss: 6.4920 - accuracy: 0.5938 5/12 [===========>..................] - ETA: 1s - loss: 6.0966 - accuracy: 0.6500 6/12 [==============>...............] - ETA: 1s - loss: 5.9985 - accuracy: 0.6823 7/12 [================>.............] - ETA: 1s - loss: 5.8891 - accuracy: 0.7098 8/12 [===================>..........] - ETA: 1s - loss: 5.9515 - accuracy: 0.7227 9/12 [=====================>........] - ETA: 0s - loss: 5.8035 - accuracy: 0.739610/12 [========================>.....] - ETA: 0s - loss: 5.7975 - accuracy: 0.737511/12 [==========================>...] - ETA: 0s - loss: 5.7218 - accuracy: 0.741512/12 [==============================] - ETA: 0s - loss: 5.7102 - accuracy: 0.7389Epoch 1 took 5.82 seconds
12/12 [==============================] - 6s 371ms/step - loss: 5.7102 - accuracy: 0.7389 - val_loss: 4.6695 - val_accuracy: 0.7000
Epoch 2/5
 1/12 [=>............................] - ETA: 3s - loss: 4.3752 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 3s - loss: 4.5005 - accuracy: 0.7969 3/12 [======>.......................] - ETA: 3s - loss: 4.4004 - accuracy: 0.8438 4/12 [=========>....................] - ETA: 2s - loss: 4.6006 - accuracy: 0.8438 5/12 [===========>..................] - ETA: 2s - loss: 4.5834 - accuracy: 0.8500 6/12 [==============>...............] - ETA: 2s - loss: 4.6007 - accuracy: 0.8542 7/12 [================>.............] - ETA: 1s - loss: 4.5383 - accuracy: 0.8616 8/12 [===================>..........] - ETA: 1s - loss: 4.4687 - accuracy: 0.8750 9/12 [=====================>........] - ETA: 1s - loss: 4.5498 - accuracy: 0.857610/12 [========================>.....] - ETA: 0s - loss: 4.5146 - accuracy: 0.859411/12 [==========================>...] - ETA: 0s - loss: 4.5052 - accuracy: 0.863612/12 [==============================] - ETA: 0s - loss: 4.5067 - accuracy: 0.8639Epoch 2 took 4.21 seconds
12/12 [==============================] - 4s 354ms/step - loss: 4.5067 - accuracy: 0.8639 - val_loss: 4.2207 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 4s - loss: 4.2861 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 3s - loss: 4.4884 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 3s - loss: 4.4776 - accuracy: 0.8021 4/12 [=========>....................] - ETA: 2s - loss: 4.2939 - accuracy: 0.8516 5/12 [===========>..................] - ETA: 2s - loss: 4.2798 - accuracy: 0.8687 6/12 [==============>...............] - ETA: 2s - loss: 4.2762 - accuracy: 0.8698 7/12 [================>.............] - ETA: 1s - loss: 4.2198 - accuracy: 0.8795 8/12 [===================>..........] - ETA: 1s - loss: 4.1986 - accuracy: 0.8789 9/12 [=====================>........] - ETA: 1s - loss: 4.1952 - accuracy: 0.878510/12 [========================>.....] - ETA: 0s - loss: 4.1418 - accuracy: 0.887511/12 [==========================>...] - ETA: 0s - loss: 4.1003 - accuracy: 0.889212/12 [==============================] - ETA: 0s - loss: 4.0965 - accuracy: 0.8889Epoch 3 took 4.23 seconds
12/12 [==============================] - 4s 348ms/step - loss: 4.0965 - accuracy: 0.8889 - val_loss: 3.9276 - val_accuracy: 0.8500
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 4.1393 - accuracy: 0.8750 2/12 [====>.........................] - ETA: 3s - loss: 4.0077 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 3s - loss: 3.8829 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 2s - loss: 3.8200 - accuracy: 0.9141 5/12 [===========>..................] - ETA: 2s - loss: 3.7743 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 2s - loss: 3.7362 - accuracy: 0.9167 7/12 [================>.............] - ETA: 1s - loss: 3.7436 - accuracy: 0.9107 8/12 [===================>..........] - ETA: 1s - loss: 3.7093 - accuracy: 0.9141 9/12 [=====================>........] - ETA: 1s - loss: 3.6757 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.6646 - accuracy: 0.918711/12 [==========================>...] - ETA: 0s - loss: 3.6534 - accuracy: 0.917612/12 [==============================] - ETA: 0s - loss: 3.6497 - accuracy: 0.9167Epoch 4 took 4.05 seconds
12/12 [==============================] - 4s 336ms/step - loss: 3.6497 - accuracy: 0.9167 - val_loss: 3.9877 - val_accuracy: 0.4000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.3614 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 3s - loss: 3.3296 - accuracy: 0.9531 3/12 [======>.......................] - ETA: 3s - loss: 3.3367 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 2s - loss: 3.3185 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 2s - loss: 3.3070 - accuracy: 0.9563 6/12 [==============>...............] - ETA: 2s - loss: 3.2918 - accuracy: 0.9583 7/12 [================>.............] - ETA: 1s - loss: 3.2706 - accuracy: 0.9643 8/12 [===================>..........] - ETA: 1s - loss: 3.2644 - accuracy: 0.9609 9/12 [=====================>........] - ETA: 1s - loss: 3.2440 - accuracy: 0.965310/12 [========================>.....] - ETA: 0s - loss: 3.2346 - accuracy: 0.962511/12 [==========================>...] - ETA: 0s - loss: 3.2223 - accuracy: 0.963112/12 [==============================] - ETA: 0s - loss: 3.2198 - accuracy: 0.9639Epoch 5 took 3.99 seconds
12/12 [==============================] - 4s 332ms/step - loss: 3.2198 - accuracy: 0.9639 - val_loss: 3.9883 - val_accuracy: 0.2500
Round Complete.
  CPU Usage - Avg: 43.31%, Peak: 50.95%, Min: 15.47%
  Memory Usage - Avg: 999.97 MB, Peak: 1035.26 MB, Min: 689.39 MB
  Available Memory - Avg: 2920.12 MB, Peak: 3496.23 MB, Min: 2848.23 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
