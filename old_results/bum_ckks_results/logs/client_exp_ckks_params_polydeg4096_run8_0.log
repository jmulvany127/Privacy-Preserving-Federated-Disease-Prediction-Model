2025-04-15 08:33:35.950057: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 08:33:35.951829: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:33:35.991094: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 08:33:35.991487: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 08:33:36.598039: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 17s - loss: 5.3704 - accuracy: 0.6875 2/12 [====>.........................] - ETA: 1s - loss: 5.8925 - accuracy: 0.7812  3/12 [======>.......................] - ETA: 1s - loss: 5.4558 - accuracy: 0.8125 4/12 [=========>....................] - ETA: 1s - loss: 5.3242 - accuracy: 0.7969 5/12 [===========>..................] - ETA: 1s - loss: 5.4697 - accuracy: 0.7312 6/12 [==============>...............] - ETA: 1s - loss: 5.3926 - accuracy: 0.7604 7/12 [================>.............] - ETA: 0s - loss: 5.3718 - accuracy: 0.7634 8/12 [===================>..........] - ETA: 0s - loss: 5.3824 - accuracy: 0.7656 9/12 [=====================>........] - ETA: 0s - loss: 5.2597 - accuracy: 0.781210/12 [========================>.....] - ETA: 0s - loss: 5.2729 - accuracy: 0.768811/12 [==========================>...] - ETA: 0s - loss: 5.2559 - accuracy: 0.778412/12 [==============================] - ETA: 0s - loss: 5.2629 - accuracy: 0.7778Epoch 1 took 3.82 seconds
12/12 [==============================] - 4s 205ms/step - loss: 5.2629 - accuracy: 0.7778 - val_loss: 4.5248 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.4815 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 4.8109 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 1s - loss: 4.8319 - accuracy: 0.8125 4/12 [=========>....................] - ETA: 1s - loss: 4.8028 - accuracy: 0.8047 5/12 [===========>..................] - ETA: 1s - loss: 4.6555 - accuracy: 0.8250 6/12 [==============>...............] - ETA: 1s - loss: 4.7700 - accuracy: 0.8125 7/12 [================>.............] - ETA: 0s - loss: 4.7363 - accuracy: 0.8080 8/12 [===================>..........] - ETA: 0s - loss: 4.7553 - accuracy: 0.8008 9/12 [=====================>........] - ETA: 0s - loss: 4.7078 - accuracy: 0.805610/12 [========================>.....] - ETA: 0s - loss: 4.6494 - accuracy: 0.812511/12 [==========================>...] - ETA: 0s - loss: 4.5997 - accuracy: 0.818212/12 [==============================] - ETA: 0s - loss: 4.5794 - accuracy: 0.8222Epoch 2 took 2.31 seconds
12/12 [==============================] - 2s 192ms/step - loss: 4.5794 - accuracy: 0.8222 - val_loss: 4.1546 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.9753 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 1s - loss: 4.1658 - accuracy: 0.8438 3/12 [======>.......................] - ETA: 1s - loss: 4.0549 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 4.0127 - accuracy: 0.8750 5/12 [===========>..................] - ETA: 1s - loss: 3.9576 - accuracy: 0.8875 6/12 [==============>...............] - ETA: 1s - loss: 3.9479 - accuracy: 0.8906 7/12 [================>.............] - ETA: 0s - loss: 3.8919 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 0s - loss: 3.8678 - accuracy: 0.9102 9/12 [=====================>........] - ETA: 0s - loss: 3.8872 - accuracy: 0.909710/12 [========================>.....] - ETA: 0s - loss: 3.8822 - accuracy: 0.900011/12 [==========================>...] - ETA: 0s - loss: 3.8436 - accuracy: 0.906212/12 [==============================] - ETA: 0s - loss: 3.8369 - accuracy: 0.9083Epoch 3 took 2.20 seconds
12/12 [==============================] - 2s 184ms/step - loss: 3.8369 - accuracy: 0.9083 - val_loss: 3.7685 - val_accuracy: 0.8500
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 4.1278 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 1s - loss: 3.9104 - accuracy: 0.8281 3/12 [======>.......................] - ETA: 1s - loss: 3.9202 - accuracy: 0.8125 4/12 [=========>....................] - ETA: 1s - loss: 3.7731 - accuracy: 0.8594 5/12 [===========>..................] - ETA: 1s - loss: 3.6795 - accuracy: 0.8875 6/12 [==============>...............] - ETA: 1s - loss: 3.6396 - accuracy: 0.8958 7/12 [================>.............] - ETA: 0s - loss: 3.5987 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 0s - loss: 3.5775 - accuracy: 0.8984 9/12 [=====================>........] - ETA: 0s - loss: 3.5390 - accuracy: 0.902810/12 [========================>.....] - ETA: 0s - loss: 3.5193 - accuracy: 0.903111/12 [==========================>...] - ETA: 0s - loss: 3.4990 - accuracy: 0.909112/12 [==============================] - ETA: 0s - loss: 3.4931 - accuracy: 0.9111Epoch 4 took 2.27 seconds
12/12 [==============================] - 2s 188ms/step - loss: 3.4931 - accuracy: 0.9111 - val_loss: 3.5285 - val_accuracy: 0.8250
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.5288 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 2s - loss: 3.4254 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 2s - loss: 3.3928 - accuracy: 0.8750 4/12 [=========>....................] - ETA: 2s - loss: 3.3229 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 1s - loss: 3.2890 - accuracy: 0.9125 6/12 [==============>...............] - ETA: 1s - loss: 3.2430 - accuracy: 0.9271 7/12 [================>.............] - ETA: 1s - loss: 3.2225 - accuracy: 0.9241 8/12 [===================>..........] - ETA: 1s - loss: 3.1993 - accuracy: 0.9258 9/12 [=====================>........] - ETA: 0s - loss: 3.1782 - accuracy: 0.927110/12 [========================>.....] - ETA: 0s - loss: 3.1559 - accuracy: 0.931211/12 [==========================>...] - ETA: 0s - loss: 3.1351 - accuracy: 0.937512/12 [==============================] - ETA: 0s - loss: 3.1290 - accuracy: 0.9389Epoch 5 took 3.25 seconds
12/12 [==============================] - 3s 272ms/step - loss: 3.1290 - accuracy: 0.9389 - val_loss: 3.3146 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 27.52%, Peak: 49.48%, Min: 0.00%
  Memory Usage - Avg: 957.54 MB, Peak: 991.40 MB, Min: 659.48 MB
  Available Memory - Avg: 3137.12 MB, Peak: 3550.33 MB, Min: 2842.84 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
