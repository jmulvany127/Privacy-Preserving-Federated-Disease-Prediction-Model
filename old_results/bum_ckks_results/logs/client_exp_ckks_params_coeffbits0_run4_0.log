2025-04-15 12:55:02.099985: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 12:55:02.103050: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:55:02.165787: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 12:55:02.166139: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 12:55:02.802093: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 16s - loss: 5.4970 - accuracy: 0.6875 2/12 [====>.........................] - ETA: 2s - loss: 6.3627 - accuracy: 0.6719  3/12 [======>.......................] - ETA: 1s - loss: 6.1293 - accuracy: 0.6771 4/12 [=========>....................] - ETA: 1s - loss: 5.9444 - accuracy: 0.7109 5/12 [===========>..................] - ETA: 1s - loss: 5.6741 - accuracy: 0.7437 6/12 [==============>...............] - ETA: 1s - loss: 5.6517 - accuracy: 0.7448 7/12 [================>.............] - ETA: 1s - loss: 5.5211 - accuracy: 0.7634 8/12 [===================>..........] - ETA: 0s - loss: 5.5243 - accuracy: 0.7578 9/12 [=====================>........] - ETA: 0s - loss: 5.5460 - accuracy: 0.753510/12 [========================>.....] - ETA: 0s - loss: 5.4562 - accuracy: 0.765611/12 [==========================>...] - ETA: 0s - loss: 5.4006 - accuracy: 0.769912/12 [==============================] - ETA: 0s - loss: 5.3896 - accuracy: 0.7722Epoch 1 took 4.03 seconds
12/12 [==============================] - 4s 232ms/step - loss: 5.3896 - accuracy: 0.7722 - val_loss: 4.4787 - val_accuracy: 0.8000
Epoch 2/5
 1/12 [=>............................] - ETA: 2s - loss: 4.8445 - accuracy: 0.8438 2/12 [====>.........................] - ETA: 1s - loss: 4.4794 - accuracy: 0.9062 3/12 [======>.......................] - ETA: 1s - loss: 4.4348 - accuracy: 0.8646 4/12 [=========>....................] - ETA: 1s - loss: 4.4029 - accuracy: 0.8438 5/12 [===========>..................] - ETA: 1s - loss: 4.5030 - accuracy: 0.8375 6/12 [==============>...............] - ETA: 1s - loss: 4.4034 - accuracy: 0.8594 7/12 [================>.............] - ETA: 1s - loss: 4.3239 - accuracy: 0.8750 8/12 [===================>..........] - ETA: 0s - loss: 4.3955 - accuracy: 0.8555 9/12 [=====================>........] - ETA: 0s - loss: 4.3808 - accuracy: 0.857610/12 [========================>.....] - ETA: 0s - loss: 4.3807 - accuracy: 0.859411/12 [==========================>...] - ETA: 0s - loss: 4.3403 - accuracy: 0.863612/12 [==============================] - ETA: 0s - loss: 4.3555 - accuracy: 0.8611Epoch 2 took 2.43 seconds
12/12 [==============================] - 2s 203ms/step - loss: 4.3555 - accuracy: 0.8611 - val_loss: 4.0978 - val_accuracy: 0.8000
Epoch 3/5
 1/12 [=>............................] - ETA: 2s - loss: 3.8499 - accuracy: 0.9375 2/12 [====>.........................] - ETA: 1s - loss: 3.7972 - accuracy: 0.9375 3/12 [======>.......................] - ETA: 1s - loss: 3.8712 - accuracy: 0.9375 4/12 [=========>....................] - ETA: 1s - loss: 3.9164 - accuracy: 0.8984 5/12 [===========>..................] - ETA: 1s - loss: 3.9952 - accuracy: 0.9062 6/12 [==============>...............] - ETA: 1s - loss: 4.0216 - accuracy: 0.9010 7/12 [================>.............] - ETA: 0s - loss: 3.9854 - accuracy: 0.9018 8/12 [===================>..........] - ETA: 0s - loss: 3.9950 - accuracy: 0.8984 9/12 [=====================>........] - ETA: 0s - loss: 3.9624 - accuracy: 0.902810/12 [========================>.....] - ETA: 0s - loss: 3.9438 - accuracy: 0.903111/12 [==========================>...] - ETA: 0s - loss: 3.9512 - accuracy: 0.900612/12 [==============================] - ETA: 0s - loss: 3.9564 - accuracy: 0.8972Epoch 3 took 2.44 seconds
12/12 [==============================] - 2s 203ms/step - loss: 3.9564 - accuracy: 0.8972 - val_loss: 4.0244 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 2s - loss: 3.7225 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.6902 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 1s - loss: 3.7407 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 1s - loss: 3.7583 - accuracy: 0.8750 5/12 [===========>..................] - ETA: 1s - loss: 3.6794 - accuracy: 0.9000 6/12 [==============>...............] - ETA: 1s - loss: 3.6452 - accuracy: 0.8958 7/12 [================>.............] - ETA: 1s - loss: 3.6113 - accuracy: 0.8973 8/12 [===================>..........] - ETA: 0s - loss: 3.5748 - accuracy: 0.9062 9/12 [=====================>........] - ETA: 0s - loss: 3.5401 - accuracy: 0.916710/12 [========================>.....] - ETA: 0s - loss: 3.5387 - accuracy: 0.918711/12 [==========================>...] - ETA: 0s - loss: 3.5087 - accuracy: 0.926112/12 [==============================] - ETA: 0s - loss: 3.5016 - accuracy: 0.9278Epoch 4 took 2.45 seconds
12/12 [==============================] - 2s 203ms/step - loss: 3.5016 - accuracy: 0.9278 - val_loss: 3.7328 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 2s - loss: 3.5948 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 2s - loss: 3.4974 - accuracy: 0.9219 3/12 [======>.......................] - ETA: 2s - loss: 3.5485 - accuracy: 0.9062 4/12 [=========>....................] - ETA: 2s - loss: 3.4778 - accuracy: 0.9219 5/12 [===========>..................] - ETA: 1s - loss: 3.4191 - accuracy: 0.9312 6/12 [==============>...............] - ETA: 1s - loss: 3.3691 - accuracy: 0.9375 7/12 [================>.............] - ETA: 1s - loss: 3.3369 - accuracy: 0.9420 8/12 [===================>..........] - ETA: 1s - loss: 3.3565 - accuracy: 0.9414 9/12 [=====================>........] - ETA: 0s - loss: 3.3719 - accuracy: 0.920110/12 [========================>.....] - ETA: 0s - loss: 3.3669 - accuracy: 0.918711/12 [==========================>...] - ETA: 0s - loss: 3.3420 - accuracy: 0.920512/12 [==============================] - ETA: 0s - loss: 3.3344 - accuracy: 0.9222Epoch 5 took 3.23 seconds
12/12 [==============================] - 3s 275ms/step - loss: 3.3344 - accuracy: 0.9222 - val_loss: 3.4623 - val_accuracy: 0.6500
Round Complete.
  CPU Usage - Avg: 42.12%, Peak: 46.95%, Min: 24.73%
  Memory Usage - Avg: 969.80 MB, Peak: 1028.30 MB, Min: 662.47 MB
  Available Memory - Avg: 2972.30 MB, Peak: 3526.25 MB, Min: 2860.14 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
