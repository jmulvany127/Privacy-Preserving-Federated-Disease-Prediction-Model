2025-04-15 13:03:22.313863: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-04-15 13:03:22.315626: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:03:22.362544: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2025-04-15 13:03:22.362910: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-04-15 13:03:23.065228: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT

 Client 0 Data Summary
  Total samples: 400
  COVID samples: 320
  Non-COVID samples: 80
  Training samples: 360
    ↳ COVID: 288, Non-COVID: 72
  Validation samples: 40
    ↳ COVID: 32, Non-COVID: 8
Client 0 connected to server.
Epoch 1/5
 1/12 [=>............................] - ETA: 18s - loss: 6.0128 - accuracy: 0.4062 2/12 [====>.........................] - ETA: 2s - loss: 6.0872 - accuracy: 0.6094  3/12 [======>.......................] - ETA: 2s - loss: 6.3944 - accuracy: 0.6771 4/12 [=========>....................] - ETA: 2s - loss: 6.3312 - accuracy: 0.7188 5/12 [===========>..................] - ETA: 1s - loss: 6.2842 - accuracy: 0.7000 6/12 [==============>...............] - ETA: 1s - loss: 6.0778 - accuracy: 0.7031 7/12 [================>.............] - ETA: 1s - loss: 5.9939 - accuracy: 0.7009 8/12 [===================>..........] - ETA: 1s - loss: 5.9136 - accuracy: 0.7070 9/12 [=====================>........] - ETA: 0s - loss: 5.8452 - accuracy: 0.722210/12 [========================>.....] - ETA: 0s - loss: 5.7297 - accuracy: 0.734411/12 [==========================>...] - ETA: 0s - loss: 5.6138 - accuracy: 0.750012/12 [==============================] - ETA: 0s - loss: 5.6368 - accuracy: 0.7472Epoch 1 took 5.80 seconds
12/12 [==============================] - 6s 373ms/step - loss: 5.6368 - accuracy: 0.7472 - val_loss: 4.5141 - val_accuracy: 0.8250
Epoch 2/5
 1/12 [=>............................] - ETA: 3s - loss: 5.1852 - accuracy: 0.8125 2/12 [====>.........................] - ETA: 3s - loss: 4.7065 - accuracy: 0.8750 3/12 [======>.......................] - ETA: 3s - loss: 4.6046 - accuracy: 0.8542 4/12 [=========>....................] - ETA: 2s - loss: 4.5111 - accuracy: 0.8438 5/12 [===========>..................] - ETA: 2s - loss: 4.4440 - accuracy: 0.8625 6/12 [==============>...............] - ETA: 2s - loss: 4.4950 - accuracy: 0.8542 7/12 [================>.............] - ETA: 1s - loss: 4.5322 - accuracy: 0.8482 8/12 [===================>..........] - ETA: 1s - loss: 4.4630 - accuracy: 0.8633 9/12 [=====================>........] - ETA: 1s - loss: 4.4627 - accuracy: 0.861110/12 [========================>.....] - ETA: 0s - loss: 4.4283 - accuracy: 0.865611/12 [==========================>...] - ETA: 0s - loss: 4.4656 - accuracy: 0.858012/12 [==============================] - ETA: 0s - loss: 4.4563 - accuracy: 0.8528Epoch 2 took 4.21 seconds
12/12 [==============================] - 4s 353ms/step - loss: 4.4563 - accuracy: 0.8528 - val_loss: 4.1985 - val_accuracy: 0.8250
Epoch 3/5
 1/12 [=>............................] - ETA: 4s - loss: 4.7076 - accuracy: 0.7812 2/12 [====>.........................] - ETA: 3s - loss: 4.7907 - accuracy: 0.7031 3/12 [======>.......................] - ETA: 3s - loss: 4.4989 - accuracy: 0.7604 4/12 [=========>....................] - ETA: 2s - loss: 4.3272 - accuracy: 0.7891 5/12 [===========>..................] - ETA: 2s - loss: 4.2555 - accuracy: 0.8125 6/12 [==============>...............] - ETA: 2s - loss: 4.1685 - accuracy: 0.8333 7/12 [================>.............] - ETA: 1s - loss: 4.1940 - accuracy: 0.8304 8/12 [===================>..........] - ETA: 1s - loss: 4.2105 - accuracy: 0.8320 9/12 [=====================>........] - ETA: 1s - loss: 4.1994 - accuracy: 0.840310/12 [========================>.....] - ETA: 0s - loss: 4.1403 - accuracy: 0.846911/12 [==========================>...] - ETA: 0s - loss: 4.1085 - accuracy: 0.846612/12 [==============================] - ETA: 0s - loss: 4.0986 - accuracy: 0.8472Epoch 3 took 4.25 seconds
12/12 [==============================] - 4s 352ms/step - loss: 4.0986 - accuracy: 0.8472 - val_loss: 3.8155 - val_accuracy: 0.8000
Epoch 4/5
 1/12 [=>............................] - ETA: 3s - loss: 3.5380 - accuracy: 0.9062 2/12 [====>.........................] - ETA: 3s - loss: 3.6353 - accuracy: 0.8594 3/12 [======>.......................] - ETA: 2s - loss: 3.5702 - accuracy: 0.8854 4/12 [=========>....................] - ETA: 2s - loss: 3.5541 - accuracy: 0.8906 5/12 [===========>..................] - ETA: 2s - loss: 3.5408 - accuracy: 0.9000 6/12 [==============>...............] - ETA: 2s - loss: 3.5624 - accuracy: 0.8958 7/12 [================>.............] - ETA: 1s - loss: 3.5434 - accuracy: 0.8973 8/12 [===================>..........] - ETA: 1s - loss: 3.5126 - accuracy: 0.9062 9/12 [=====================>........] - ETA: 1s - loss: 3.5049 - accuracy: 0.902810/12 [========================>.....] - ETA: 0s - loss: 3.4916 - accuracy: 0.900011/12 [==========================>...] - ETA: 0s - loss: 3.4735 - accuracy: 0.903412/12 [==============================] - ETA: 0s - loss: 3.4663 - accuracy: 0.9056Epoch 4 took 4.04 seconds
12/12 [==============================] - 4s 337ms/step - loss: 3.4663 - accuracy: 0.9056 - val_loss: 3.5937 - val_accuracy: 0.8000
Epoch 5/5
 1/12 [=>............................] - ETA: 3s - loss: 3.2469 - accuracy: 0.9688 2/12 [====>.........................] - ETA: 3s - loss: 3.1850 - accuracy: 0.9844 3/12 [======>.......................] - ETA: 3s - loss: 3.1774 - accuracy: 0.9792 4/12 [=========>....................] - ETA: 2s - loss: 3.1988 - accuracy: 0.9531 5/12 [===========>..................] - ETA: 2s - loss: 3.2616 - accuracy: 0.9250 6/12 [==============>...............] - ETA: 2s - loss: 3.2241 - accuracy: 0.9323 7/12 [================>.............] - ETA: 1s - loss: 3.2133 - accuracy: 0.9375 8/12 [===================>..........] - ETA: 1s - loss: 3.1965 - accuracy: 0.9375 9/12 [=====================>........] - ETA: 1s - loss: 3.1750 - accuracy: 0.941010/12 [========================>.....] - ETA: 0s - loss: 3.1602 - accuracy: 0.943811/12 [==========================>...] - ETA: 0s - loss: 3.1426 - accuracy: 0.946012/12 [==============================] - ETA: 0s - loss: 3.1425 - accuracy: 0.9444Epoch 5 took 3.95 seconds
12/12 [==============================] - 4s 328ms/step - loss: 3.1425 - accuracy: 0.9444 - val_loss: 3.3384 - val_accuracy: 0.8000
Round Complete.
  CPU Usage - Avg: 22.79%, Peak: 47.70%, Min: 0.00%
  Memory Usage - Avg: 986.56 MB, Peak: 1004.88 MB, Min: 686.69 MB
  Available Memory - Avg: 3217.47 MB, Peak: 3600.07 MB, Min: 2838.26 MB

=== DP Noise Injection (Round 1) ===
Epsilon: 3.0, Noise Type: gaussian
Traceback (most recent call last):
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 513, in <module>
    updated_weights = client.update(global_weights)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 279, in update
    encrypted_weights = encrypt_weights(noisy_weights, self.tenseal_context)
  File "/home/jmulvany/Thesis_BU/iv_VM/client_LDP.py", line 82, in encrypt_weights
    enc_weight = ts.ckks_vector(ts_context, flat_weight)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/__init__.py", line 102, in ckks_vector
    return CKKSVector(*args, **kwargs)
  File "/home/jmulvany/Thesis_BU/venv/lib/python3.10/site-packages/tenseal/tensors/ckksvector.py", line 42, in __init__
    self.data = ts._ts_cpp.CKKSVector(context.data, vector)
ValueError: encoded values are too large
